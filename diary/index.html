<?xml version="1.0" encoding="UTF-8" ?> <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> <html xmlns="http://www.w3.org/1999/xhtml"> <title>diary.html</title> <meta http-equiv=Content-Type  content="application/xhtml+xml;charset=utf-8"/> <link rel=stylesheet  type="text/css" media=all  href="https://cdn.jsdelivr.net/npm/github-markdown-css/github-markdown.min.css" /> <link rel=stylesheet  type="text/css" media=all  href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/styles/github.min.css" /><meta name='viewport' content='width=device-width, initial-scale=1, shrink-to-fit=no'><style> body { box-sizing: border-box; max-width: 740px; width: 100%; margin: 40px auto; padding: 0 10px; } </style><script id='MathJax-script' async src='https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'></script><script src='https://cdn.jsdelivr.net/gh/highlightjs/cdn-release/build/highlight.min.js'></script><script>document.addEventListener('DOMContentLoaded', () => { document.body.classList.add('markdown-body'); document.querySelectorAll('pre[lang] > code').forEach((code) => { code.classList.add(code.parentElement.lang); }); document.querySelectorAll('pre > code').forEach((code) => { hljs.highlightBlock(code); }); });</script> <p><span class=citation  data-cites=def >@def</span> title = ‚ÄúThe Grind‚Äù <span class=citation  data-cites=def >@def</span> hascode = true</p> <p><span class=citation  data-cites=def >@def</span> tags = [‚Äúdiary‚Äù, ‚Äúcode‚Äù]</p> <h1 id=virtual-diary-for-progress-on-all-fronts >Virtual diary for progress on all fronts</h1> <h3 id=section >16/08/2021</h3> <ol start=366  type=1 > <li>Linux <a href="https://twitter.com/derKha/status/1426195407395299329">perf guide</a>. <li><a href="https://discourse.julialang.org/t/22-seconds-to-3-and-now-more-lets-fix-all-of-the-differentialequations-jl-universe-compile-times/66313">Go fix some DiffEq compile times yo</a> <li><a href="https://github.com/rust-lang/rust-semverver">Semver autodetection in Rust</a> <li><a href="https://compiler-research.org/assets/presentations/K_Fischer_Cxx_jl.pdf">Plz someone help out Keno with Cxx.jl</a> <li><a href="https://fasterthanli.me/articles/understanding-rust-futures-by-going-way-too-deep">Amos Rust futures post</a> <li> </ol> <h3 id=section-1 >11/08/2021</h3> <ol start=363  type=1 > <li>Jon Sterling writes about a metalanguage for <code>multi phase modularity</code> <a href="https://twitter.com/jonmsterling/status/1423655072303489024">here</a>. <li>Consider using <code>TimeWarrior</code><a href="https://timewarrior.net/docs/what/">linked here</a>. <li>Dr.¬†Devon Price <a href="https://devonprice.medium.com/no-mental-illness-isnt-caused-by-chemicals-in-the-brain-1b01d6808871">has an amazing article criticizing the biological understanding of mental health:</a>. </ol> <h3 id=section-2 >04/08/2021</h3> <ol start=360  type=1 > <li>Parallel Julia priorites from the State of Julia 2021 talk: </ol> <table> <thead> <tr class=header > <th>Features/Correctness <th>Performance <tr class=odd > <td>Thread safety: Distributed <td>Optimize scheduler <tr class=even > <td>thread safety: package loading <td>Parallel mark/sweep <tr class=odd > <td>Memory model <td>Type inference of <code>fetch(::Task)</code> <tr class=even > <td>Finalizer thread <td>Better for loop and reduce <tr class=odd > <td>Interactive threads <td>BLAS integration <tr class=even > <td>GC state transitions in codegen <td>TAPIR Integration </table> <ol start=361  type=1 > <li>Compiler priorities from State of Julia 2021: </ol> <p>Latency related:</p> <ul> <li>Staged JIT, faster interpreter <li>Caching code <li>Subtyping an dmethod-lookup optimizations </ul> <p>System images and other build artifacts:</p> <ul> <li>Faster and easier sysimg builds <li>separate LLVM/codegen from runtime <li>strip debug info, IR <li>Tree shaking <li>Language support for separate compilation </ul> <p>Array optimizations</p> <p>GC performance work</p> <p>Compiler extensibility</p> <ol start=362  type=1 > <li><code>ghostscript</code> can be used for batch pdf processing. </ol> <h3 id=section-3 >03/08/2021</h3> <ol start=359  type=1 > <li>All the JuliaCon posters are uploaded! üéâ I heard a lot of interesting proposals from people from NZ, photolithography people and many others‚Ä¶ posters are fun! Life‚Äôs lookin‚Äô good! </ol> <h3 id=section-4 >02/08/2021</h3> <ol start=343  type=1 > <li>Extract 20 seconds without re-encoding: </ol> <div class=sourceCode  id=cb1 ><pre class="sourceCode bash"><code class="sourceCode bash"><span id=cb1-1 ><a href="#cb1-1" aria-hidden=true  tabindex=-1 ></a><span class=ex >ffmpeg</span> <span class=at >-ss</span> 00:01:30.000 <span class=at >-i</span> YOUR_VIDEO.mp4 <span class=at >-t</span> 00:00:20.000 <span class=at >-c</span> copy YOUR_EXTRACTED_VIDEO.mp4</span></code></pre></div>
<ol start=344  type=1 >
<li>Tuning options in ffmpeg:
</ol>
<pre><code>film ‚Äì use for high quality movie content;
animation ‚Äì good for cartoons;
grain ‚Äì preserves the grain structure in old, grainy film material;stillimage ‚Äì good for slideshow-like content;
fastdecode ‚Äì allows faster decoding by disabling certain filters;
zerolatency ‚Äì good for fast encoding and low-latency streaming;
psnr ‚Äì only used for codec development;
ssim ‚Äì only used for codec development;
Example: 
ffmpeg -i your_video.mov -c:v h264 -crf 23 -tune film your_output.mp4</code></pre>
<ol start=345  type=1 >
<li>You can use 2 pass encoding for targeting a specific output file size, but not care so much about output quality from frame to frame.
<li><code>For an output that is roughly 'visually lossless' but not technically and waaaay less file size, just use -crf 17 or 18</code>.
<li>You can also constrain the maximum bitrate (useful for streaming!)
</ol>
<pre><code>ffmpet -i input.mp4 -c:v h264 -crf 23 -maxrate 1M -bufsize 2M output.mp4</code></pre>
<ol start=348  type=1 >
<li>Recommend adding a <code>faststart</code> flag to your video so that it begins playing faster (recommended by YouTube).
</ol>
<pre><code>ffmpeg -i input.mp4 -c:v h264 -crf 23 -maxrate 1M -bufsize 2M -movflags +faststart output.mp4</code></pre>
<ol start=349  type=1 >
<li>If you want to produce 1080p and above, h265 offers great savings in bitrates/file size (ntoe: needs to be built with <code>--enable-gpl --enable-libx265</code>).
</ol>
<pre><code>ffmpeg -i input -c:v libx265 -crf 28 -c:a aac -b:a 128k output.mp4</code></pre>
<ol start=350  type=1 >
<li>h266 video codec:
</ol>
<ul>
<li>with h265, to transmite a 90min UHD file, it needs about 10 gigabytes of data
<li>with h266, you need only about 5 gigabytes. Can deal with 4k/8k and 360 degree video!
</ul>
<ol start=351  type=1 >
<li>VP8 videos: Supposed to be web standard.
<li>OF COURSE Google made vp9 in direct competition of h265, you need <code>libvpx-vp9</code>.
<li>OH LORD Youtube recommends it‚Äôs own <a href="https://developers.google.com/media/vp9/settings/vod">ffmpeg settings!!!</a>
<li>AV1 video - SD and HD under bandwidth constrained networks.
<li>Netflix codedc is SVT-AV1 and they <a href="https://netflixtechblog.com/svt-av1-an-open-source-av1-encoder-and-decoder-ad295d9b5ca2">have blog posts explaining it</a>, as well as github repos!
<li>AV1AN exists becuase AV1/VP9/VP8 are not easily multithreaded ‚Ä¶ üòï
<li>RTMP is for ‚ÄúReal time Messaging Protocol‚Äù and is the de facto standard for all live videos in FB, Insta, YT, Twitch, Twitter, Periscope etc. Streaming pre recorded video to live can be done in at least 2 ways:
</ol>
<ul>
<li>take input file ‚Äúas is‚Äù and convert in real time to FLV (and stream it live via:)
</ul>
<pre><code>-f flv rtmp://a.rtmp.youtube.com/live2/[YOUR_STREAM_KEY]
#: this will instruct FFMPEG to output everything into the required FLV format to the YouTube RTMP server</code></pre>
<ol start=358  type=1 >
<li>PRE PROCESS FILES IN BATCH: pg 113/122
</ol>
<pre><code>for i in *.mov; do ffmpeg -i &quot;$i&quot; -c:v libx264 -profile:v high -level:v 4.1 -preset veryfast -b:v 3000k -maxrate 3000k -bufsize 6000k -pix_fmt yuv420p -r 25 -g 50 -keyint_min 50 -sc_threshold 0 -c:a aac -b:a 128k -ac 2 -ar 44100 &quot;${i%.*}.mp4&quot;; done</code></pre>
<p>‚ÄúThe above example script will pre-process every .movfile contained in the directory, in line with the YouTube‚Äôs requirements for streaming a Full-HD 1080p at 25FPS.‚Äù</p>
<h3 id=section-5 >31/07/2021</h3>
<ol start=340  type=1 >
<li><code>tmux</code> can be used to keep persistent sessions on <code>ssh</code>, so <code>mosh</code> is not necessarily needed. The way to do this (Credit to Danny Sharp) is do the ssh inside a tmux session and then <code>tmux ls</code> to see which sessions you have made and then <code>tmux attach-session -t 3</code> to connect to session 3. This is a smart way of checking in on long running compute jobs.
<li>From <code>FFMPEG Zero to Hero</code>:
</ol>
<pre><code>BITRATE: Bitrate or data rate is the amount of data per
second in the encoded video file, usually expressed in kilobits per second (kbps)
or megabits per second (Mbps).  The bitrate measurement is also applied to audio files.
An Mp3 file, for example, can reach a maximum bitrate of 320 kilobit per second,
while a standard CD (non-compressed) audio track can have up to 1.411 kilobit per 
second. A typical compressed h264 video in Full-HD has a bitrate 
in the range of 3.000 - 6.000 kbps, while a 4k video can reach
a bitrate value up to 51.000 kbps.  A non-compressed video format,
such as the Apple ProRes format in 4K resolution, can reach a bitrate of 253.900 kbps and higher. </code></pre>
<ol start=342  type=1 >
<li>FFMPEG can read and write to basically any format under the sun, and has been designed by the MPEG: <code>Moving Pictures Expert Group</code>.
</ol>
<h3 id=section-6 >29/07/2021</h3>
<ol start=334  type=1 >
<li>To run code with the interpreter, use <code>julia --compile=no</code>.
<li><a href="https://github.com/openjournals/buffy">Buffy</a> for JOSS submissions.
<li><a href="https://craftinginterpreters.com/">Crafting Interpreters</a> for speeding up the Debugger and such.
<li><a href="https://tldp.org/LDP/abs/html/">Advance bash scripting guide</a>
<li><a href="https://discourse.julialang.org/t/juliacon-2021-proceedings/55354">Proceedings Bot</a>
<li><a href="https://tobydriscoll.net/fnc-julia/linsys/efficiency.html">Toby Driscoll online book</a>
</ol>
<h3 id=section-7 >28/07/2021</h3>
<ol start=333  type=1 >
<li>Link dump: https://lazy.codes/posts/awesome-unstable-rust-features/ https://github.com/koalaman/shellcheck https://github.com/Apress/beginning-cpp20/blob/main/Exercises/Modules/Chapter%2002/Soln2_01A.cpp https://rustc-dev-guide.rust-lang.org/
</ol>
<h3 id=section-8 >21/07/2021</h3>
<ol start=331  type=1 >
<li>To clean up a video with ffmpeg, do:
</ol>
<pre><code>ffmpeg -i elrodtest.mov -af &quot;highpass=f=300, lowpass=f=3000, afftdn&quot; -c:v copy passeselrod.mov</code></pre>
<p>This applies a FFT filter, with a highpass and lowpass of 300Hz and 3000Hz 332. This is an awesome thread on <a href="https://twitter.com/matt_dz/status/1417857422559952897">LLVM resources</a> And WOW is <a href="https://gist.github.com/MattPD/00573ee14bf85ccac6bed3c0678ddbef#introduction">this super list thorough LLVM Program Analysis resources</a></p>
<h3 id=section-9 >20/07/2021</h3>
<ol start=327  type=1 >
<li><a href="https://github.com/JuliaLang/julia/issues/939">sortperm is sorta slow</a> - up for grabs!
<li><a href="https://twitter.com/Anno0770/status/1414009622583783432">Setup donation links to JuliaCon</a>
<li><a href="https://proceedings.juliacon.org">Submit to the procceedings‚Ä¶</a>
<li>FFMPEG is HUGE ! Here‚Äôs what I needed to concat 2 videos together:
</ol>
<div class=sourceCode  id=cb10 ><pre class="sourceCode bash"><code class="sourceCode bash"><span id=cb10-1 ><a href="#cb10-1" aria-hidden=true  tabindex=-1 ></a><span class=ex >ffmpeg</span> <span class=at >-i</span> <span class=st >&quot;concat:input1.ts|input2.ts&quot;</span> <span class=at >-c</span> copy output.ts</span></code></pre></div>
<p>Now I need to apply that to every <code>*.mov/mp4/mkv</code> video in the folder and then I have a lot of processed videos. Perhaps I should also dump that info into a CSV file‚Ä¶</p>
<h3 id=section-10 >14/07/2021</h3>
<ol start=325  type=1 >
<li>Federico Simonetta <a href="https://julialang.slack.com/archives/C67910KEH/p1626281444356200">asks</a>:
</ol>
<pre><code>Dummy question: if I have T=Vector{Int32}, I can get the inner type using eltype. How can I get the outer type? (i.e. Vector so that I can create a new Vector but using a different inner type?)</code></pre>
<p>Which I think Erik Schnetter wanted since a [long time ago.] There‚Äôs now a Base method <a href="">for this</a>:</p>
<div class=sourceCode  id=cb12 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb12-1 ><a href="#cb12-1" aria-hidden=true  tabindex=-1 ></a><span class=bu >Base</span>.typename(T).wrapper <span class=co ># credit to Jakob Nissen</span></span></code></pre></div>
<p>But name is being bikeshed currently.</p>
<p>If you want to use <code>CustomType{Matrix{Float32}}</code>, Rackauckas says that</p>
<div class=sourceCode  id=cb13 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb13-1 ><a href="#cb13-1" aria-hidden=true  tabindex=-1 ></a><span class=bu >Base</span>.<span class=pp >@pure</span> __parameterless_type(T) <span class=op >=</span> <span class=bu >Base</span>.typename(T).wrapper</span></code></pre></div>
<p>can be used, instead of <code>SciMLBase.parameterless_type(T)</code>.</p>
<p>Matt Bauman is convinced it‚Äôs a footgun, and we should just stick to using <code>similar(x, AnotherType)</code> instead.</p>
<ol start=326  type=1 >
<li>Conor Hoekstra nerdsniped me into learning some APL - here‚Äôs my attempt for printing ‚ÄòEven‚Äô or ‚ÄòOdd‚Äô depending on a summation
</ol>
<pre><code>      EvenOrOdd‚Üê{(1+2|(+/‚çµ))‚å∑ &#39;Even&#39; &#39;Odd&#39;}
      EvenOrOdd 1
‚îå‚îÄ‚îÄ‚îÄ‚îê
‚îÇOdd‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îò
      EvenOrOdd 1 1
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇEven‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îò</code></pre>
<p>There‚Äôs oodles more to learn <a href="https://problems.tryapl.org/">here</a> and <a href="https://tryapl.org/#">here</a>.</p>
<ol start=326  type=1 >
<li>Right, the <a href="https://www.math.uci.edu/~chenlong/lectures.html">Chen Long</a> courses exist. And the Barba CFD Python course. And the Leveque book‚Ä¶ sigh.
</ol>
<h3 id=section-11 >09/07/2021</h3>
<ul>
<li><a href="https://github.com/gwisk/gradguide">Should read George‚Äôs appying to a PhD guidea</a> at some point‚Ä¶
</ul>
<h3 id=section-12 >06/07/2021</h3>
<ul>
<li><a href="https://brendangregg.com/blog/2021-07-05/computing-performance-on-the-horizon.html">Brendan Greg on performance</a> on the horizon.
<li><a href="https://twitter.com/TartanLlama/status/1409834646087606276">How a computer should talk to people by M. Dean</a> and posted by Sy Brand.
<li>Move recs by the amazing <code>@JoyOfPhysics:</code>
</ul>
<pre><code>Depends on what subgenres you like! Besides the Jordan Peele horror you mentioned, 
 I always recommend 
 A Girl Walks Home Alone At Night,
 Creep and Creep 2, 
 Blackcoat‚Äôs Daughter, 
 It Comes At Night, 
 REC (the Spanish original)...
 
  The Ritual and Midsomma</code></pre>
<ul>
<li><a href="https://www.learningj.com/book.htm#toc">Learning J book</a>
<li><a href="https://github.com/EmbarkStudios/puffin">Ran into the Puffin profiler written in Rust</a> looks cool!
</ul>
<h3 id=section-13 >29/06/2021</h3>
<ul>
<li>There‚Äôs a Rust based client for neovim: <code>neovide</code>. Looks cool.
</ul>
<h3 id=section-14 >28/06/2021</h3>
<ul>
<li>Found the Bret Contreras <a href="https://bretcontreras.com/wp-content/uploads/PDF_DOWNLOAD_BcPyramid.pdf">Triangle approach</a> useful. Should set that up for 6 muscle groups, 2 times a year.
<li>‚Ä¶ I need to start a workout diary.
</ul>
<h3 id=section-15 >27/06/2021</h3>
<ol start=323  type=1 >
<li><a href="https://www.cs.toronto.edu/~ylzhang/csc236/files/lec08-loop-invariant.pdf">Loop invariants</a> have 3 steps:
</ol>
<ul>
<li>you have a loop with <code>E</code> a loop guard and body <code>S</code>
</ul>
<pre><code>while E:
    S</code></pre>
<ul>
<li>You then initialize the loop, see that the LI condition holds with the guard <code>E</code> and the precondition.
<li>You then prove that if the Loop Invariant condition holds before the i-th iteration of the loop, it holds in the i+1-th iteration of the loop
<li>At the end, you use the negation of <code>E</code> and the LI to affirm something useful about the program (most likely, the post condition).
<ul>
<li>Merge Sort example:
<ul>
<li>Hardest part is thinking of the LI in the first place.
<li>‚ÄúFor arrays L and I, L[i] and R[j] hold the smallest elements not in S (target vector)‚Äù
</ul>
</ul>
</ul>
<h3 id=section-16 >26/06/2021</h3>
<ol start=322  type=1 >
<li>TLA+ Loop invariants here we go‚Ä¶
</ol>
<h3 id=section-17 >25/06/2021</h3>
<ol start=317  type=1 >
<li><a href="">Leiserson course</a> is level 1, <a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-046j-design-and-analysis-of-algorithms-spring-2015/index.html">Design and analysis of algorithms is level 2</a>, Jelani course is level 3.
<li><a href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-852j-distributed-algorithms-fall-2009/index.htm">Nancy Lynch distributed algorithms course</a>
<li>Ooooh <a href="https://dl.acm.org/doi/10.1145/3828.3835">Self adjusting binary search trees</a>
<li><a href="https://ocw.mit.edu/courses/mathematics/18-065-matrix-methods-in-data-analysis-signal-processing-and-machine-learning-spring-2018/index.htm">MITOCW: Matrix Methods in Data Analysis, Signal Processing and Machine Learning</a>
<li><a href="https://www.reddit.com/r/DoomEmacs/comments/o0gqoi/any_julia_users_here_to_help_a_n00b/">Doom config by Fausto Marques</a> for julia‚Ä¶ should read it sometime‚Ä¶
</ol>
<h3 id=section-18 >24/06/2021</h3>
<ol start=314  type=1 >
<li>Asesorias online de la fac‚Ä¶
<li>LLVM has options to investigate base language code coverage with <code>llvm-profdata</code> and <code>llvm-cov</code> tooling.
<li>Reading atomic habits - this blog works well as a braindump, but it would be a good idea to include reflections and reviews on proposed monthly and weekly goals on maths, physics, computing projects, physical activity and life.
</ol>
<h3 id=section-19 >23/06/2021</h3>
<ol start=311  type=1 >
<li>God I want <a href="https://people.csail.mit.edu/jshun/6886-s21/">to tkae the Algorithm Engineering 2021</a> course so bad‚Ä¶ or at least translate it.
<li>Mos√® posted about <a href="https://reproducible-builds.org/docs/">Reproducible build academic guidelines</a>.
<li><a href="https://training.linuxfoundation.org/training/introduction-to-riscv-lfd110x">RISC V course!</a>
</ol>
<h3 id=section-20 >22/06/2021</h3>
<ol start=306  type=1 >
<li>Viendo el tutorial de Ploomber de Eduardo Blancas - Deber√≠as cachear el pipeline de datos de tal manera que si afectas un nodo del DAG computacional, el resto no necesiten recalcularse. Technically same mechanism as cached parallel tests.
<li>Julia 1.7 has implicit multiplication of radicals! <code>xSQ3y</code> works! Also <code>(; a, b) = x</code> can destructure <code>x</code>.
<li><a href="http://formalverification.cs.utah.edu/mpitla/MPI_semantics_v0.8.2.pdf">MPI Formal TLA+ spec!</a> + <a href="http://formalverification.cs.utah.edu/mpitla/">formal lab link</a>
<li><a href="https://web.cecs.pdx.edu/~apt/cs510spec/">Practical Specification course!</a>.
<li>Safety - something bad never happens. Liveness - something initiated/enabled eventually terminates.
</ol>
<h3 id=section-21 >21/06/2021</h3>
<ol start=302  type=1 >
<li><a href="https://jkrumbiegel.com/pages/2021-06-07-macros-for-beginners/">Julia macros for beginners</a>: <code>esc</code> means ‚Äútreat this variable like a variable the user has written themselves.‚Äù AKA interpolating within the macro only gives you variables local to the macro‚Äôs module, escaping treats it as a user variable.
</ol>
<ul>
<li>Before writing a macro for an expression, try to understand it first with <code>Meta.@dump</code>.
<li>A good check for correct escaping is passing in local variables.
</ul>
<div class=sourceCode  id=cb17 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb17-1 ><a href="#cb17-1" aria-hidden=true  tabindex=-1 ></a>julia<span class=op >&gt;</span> <span class=kw >module</span> m</span>
<span id=cb17-2 ><a href="#cb17-2" aria-hidden=true  tabindex=-1 ></a>           <span class=kw >export</span> fill</span>
<span id=cb17-3 ><a href="#cb17-3" aria-hidden=true  tabindex=-1 ></a>           <span class=kw >macro</span> fill(exp<span class=op >,</span> sizes<span class=op >...</span>)</span>
<span id=cb17-4 ><a href="#cb17-4" aria-hidden=true  tabindex=-1 ></a>               iterator_expressions <span class=op >=</span> map(sizes) <span class=kw >do</span> s</span>
<span id=cb17-5 ><a href="#cb17-5" aria-hidden=true  tabindex=-1 ></a>                   <span class=dt >Expr</span>(</span>
<span id=cb17-6 ><a href="#cb17-6" aria-hidden=true  tabindex=-1 ></a>                       <span class=op >:</span>(<span class=op >=</span>)<span class=op >,</span></span>
<span id=cb17-7 ><a href="#cb17-7" aria-hidden=true  tabindex=-1 ></a>                       <span class=op >:</span>_<span class=op >,</span></span>
<span id=cb17-8 ><a href="#cb17-8" aria-hidden=true  tabindex=-1 ></a>                       <span class=kw >quote</span> <span class=fl >1</span><span class=op >:$</span>(esc(s)) <span class=kw >end</span></span>
<span id=cb17-9 ><a href="#cb17-9" aria-hidden=true  tabindex=-1 ></a>                       )</span>
<span id=cb17-10 ><a href="#cb17-10" aria-hidden=true  tabindex=-1 ></a>               <span class=kw >end</span></span>
<span id=cb17-11 ><a href="#cb17-11" aria-hidden=true  tabindex=-1 ></a>               <span class=dt >Expr</span>(<span class=op >:</span>comprehension<span class=op >,</span></span>
<span id=cb17-12 ><a href="#cb17-12" aria-hidden=true  tabindex=-1 ></a>                   esc(exp)<span class=op >,</span></span>
<span id=cb17-13 ><a href="#cb17-13" aria-hidden=true  tabindex=-1 ></a>                   iterator_expressions<span class=op >...</span></span>
<span id=cb17-14 ><a href="#cb17-14" aria-hidden=true  tabindex=-1 ></a>                   )</span>
<span id=cb17-15 ><a href="#cb17-15" aria-hidden=true  tabindex=-1 ></a>           <span class=kw >end</span></span>
<span id=cb17-16 ><a href="#cb17-16" aria-hidden=true  tabindex=-1 ></a>       <span class=kw >end</span></span>
<span id=cb17-17 ><a href="#cb17-17" aria-hidden=true  tabindex=-1 ></a><span class=bu >Main</span>.m</span>
<span id=cb17-18 ><a href="#cb17-18" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb17-19 ><a href="#cb17-19" aria-hidden=true  tabindex=-1 ></a>julia<span class=op >&gt;</span> <span class=bu >Main</span>.m.<span class=pp >@fill</span>(rand(<span class=fl >3</span>)<span class=op >,</span> <span class=fl >5</span>)</span>
<span id=cb17-20 ><a href="#cb17-20" aria-hidden=true  tabindex=-1 ></a><span class=fl >5</span><span class=op >-</span>element <span class=dt >Vector</span>{<span class=dt >Vector</span>{<span class=dt >Float64</span>}}<span class=op >:</span></span>
<span id=cb17-21 ><a href="#cb17-21" aria-hidden=true  tabindex=-1 ></a> [<span class=fl >0.7935931741613422</span><span class=op >,</span> <span class=fl >0.009320195062872738</span><span class=op >,</span> <span class=fl >0.586287521697819</span>]</span>
<span id=cb17-22 ><a href="#cb17-22" aria-hidden=true  tabindex=-1 ></a> [<span class=fl >0.5090383286377023</span><span class=op >,</span> <span class=fl >0.8500671589320301</span><span class=op >,</span> <span class=fl >0.023782332100151793</span>]</span>
<span id=cb17-23 ><a href="#cb17-23" aria-hidden=true  tabindex=-1 ></a> [<span class=fl >0.31575252460961667</span><span class=op >,</span> <span class=fl >0.30058298960206287</span><span class=op >,</span> <span class=fl >0.2873940760156002</span>]</span>
<span id=cb17-24 ><a href="#cb17-24" aria-hidden=true  tabindex=-1 ></a> [<span class=fl >0.07225330666900165</span><span class=op >,</span> <span class=fl >0.22506420288160234</span><span class=op >,</span> <span class=fl >0.225626098738561</span>]</span>
<span id=cb17-25 ><a href="#cb17-25" aria-hidden=true  tabindex=-1 ></a> [<span class=fl >0.5753508713492259</span><span class=op >,</span> <span class=fl >0.37821541454348995</span><span class=op >,</span> <span class=fl >0.3146472409806831</span>]</span></code></pre></div>
<ol start=303  type=1 >
<li><code>Dr. Takafumi Arakaki</code> has some good recommendations on globals - mark them inside functions!
</ol>
<div class=sourceCode  id=cb18 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb18-1 ><a href="#cb18-1" aria-hidden=true  tabindex=-1 ></a>julia<span class=op >&gt;</span> <span class=kw >global</span> a <span class=op >=</span> <span class=fl >1</span><span class=op >;</span></span>
<span id=cb18-2 ><a href="#cb18-2" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb18-3 ><a href="#cb18-3" aria-hidden=true  tabindex=-1 ></a>julia<span class=op >&gt;</span> good() <span class=op >=</span> <span class=kw >global</span> a <span class=op >+=</span> <span class=fl >1</span><span class=op >;</span></span>
<span id=cb18-4 ><a href="#cb18-4" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb18-5 ><a href="#cb18-5" aria-hidden=true  tabindex=-1 ></a>julia<span class=op >&gt;</span> bad() <span class=op >=</span> a <span class=op >+=</span> <span class=fl >1</span><span class=op >;</span></span>
<span id=cb18-6 ><a href="#cb18-6" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb18-7 ><a href="#cb18-7" aria-hidden=true  tabindex=-1 ></a>julia<span class=op >&gt;</span> good()</span>
<span id=cb18-8 ><a href="#cb18-8" aria-hidden=true  tabindex=-1 ></a><span class=fl >2</span></span>
<span id=cb18-9 ><a href="#cb18-9" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb18-10 ><a href="#cb18-10" aria-hidden=true  tabindex=-1 ></a>julia<span class=op >&gt;</span> bad()</span>
<span id=cb18-11 ><a href="#cb18-11" aria-hidden=true  tabindex=-1 ></a>ERROR<span class=op >:</span> <span class=dt >UndefVarError</span><span class=op >:</span> a not defined</span></code></pre></div>
<ol start=304  type=1 >
<li>Try to also avoid this idiom:
</ol>
<div class=sourceCode  id=cb19 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb19-1 ><a href="#cb19-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >function</span> consumer()</span>
<span id=cb19-2 ><a href="#cb19-2" aria-hidden=true  tabindex=-1 ></a>    id <span class=op >=</span> threadid()</span>
<span id=cb19-3 ><a href="#cb19-3" aria-hidden=true  tabindex=-1 ></a>    report <span class=op >=</span> <span class=fl >0</span></span>
<span id=cb19-4 ><a href="#cb19-4" aria-hidden=true  tabindex=-1 ></a>    println(<span class=st >&quot;I&#39;m consumer $(threadid())&quot;</span>)</span>
<span id=cb19-5 ><a href="#cb19-5" aria-hidden=true  tabindex=-1 ></a>    <span class=op >...</span></span></code></pre></div>
<p>Instead try doing</p>
<div class=sourceCode  id=cb20 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb20-1 ><a href="#cb20-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >for</span> id <span class=kw >in</span> <span class=fl >1</span><span class=op >:</span>numProducers</span>
<span id=cb20-2 ><a href="#cb20-2" aria-hidden=true  tabindex=-1 ></a>    <span class=pp >@spawn</span> producer(id)</span>
<span id=cb20-3 ><a href="#cb20-3" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<p>He also recommends that ‚Äúwhile debugging, you‚Äôd probably wan tto show the error from producers and consumers like this‚Äù</p>
<div class=sourceCode  id=cb21 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb21-1 ><a href="#cb21-1" aria-hidden=true  tabindex=-1 ></a><span class=pp >@spawn</span> <span class=kw >try</span></span>
<span id=cb21-2 ><a href="#cb21-2" aria-hidden=true  tabindex=-1 ></a>    producer()</span>
<span id=cb21-3 ><a href="#cb21-3" aria-hidden=true  tabindex=-1 ></a><span class=kw >catch</span> err</span>
<span id=cb21-4 ><a href="#cb21-4" aria-hidden=true  tabindex=-1 ></a>    <span class=pp >@error</span> <span class=st >&quot;Unexpected error from a producer&quot;</span> exception <span class=op >=</span> (err<span class=op >,</span> catch_backtrace())</span>
<span id=cb21-5 ><a href="#cb21-5" aria-hidden=true  tabindex=-1 ></a>    rethrow()</span>
<span id=cb21-6 ><a href="#cb21-6" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<ol start=305  type=1 >
<li>Neat trick - don‚Äôt use <code>while true</code> loops in the beginning üòÖ . Use <code>for _ in 1:10_000</code> to check if the threads are even alive.
</ol>
<h3 id=section-22 >20/06/2021</h3>
<ol start=281  type=1 >
<li>I read <a href="https://lamport.azurewebsites.net/pubs/time-clocks.pdf">Lamports Logical Clocks</a> paper today. I learned a couple of things.
</ol>
<ul>
<li>To totally order all events in a distributed system, you only need each process to keep a counter of its own events, and send events with its own timestamp. If you get a timestamp equal or higher than your own, then you bump your up to that amount.
<li>However, these total orderings can be ‚Äúunsynched‚Äù from the real world - if you include some small perturbations in your timestamps, you can, within bounded time (and quite fast) always synchronize your system.
</ul>
<ol start=282  type=1 >
<li>Now reading <a href="https://lamport.azurewebsites.net/pubs/paxos-simple.pdf">Paxos Paper</a>.
</ol>
<ul>
<li>To coordinate proposals of a value, it‚Äôs good to keep a threshold counter and reject proposals which are inferior to that.
<li><a href="">Fischer, Lynch, and Patterson</a> implies that " a reliable algoritm for eledcting a proposer must use either randomness or real time ‚Äì for example, by using timeouts."
</ul>
<ol start=283  type=1 >
<li><code>CHOOSE</code> is nondeterministic - if it chose 38 today, it will choose that again next week. You never need to write <code>x' = CHOOSE i \in 1..9 : TRUE</code>, just use <code>x' \in 1..99</code>. Use <code>CHOOSE</code> only when there‚Äôs exactly 1 <code>v</code> in <code>S</code> satisfying formula <code>P</code>, like in the definition of <code>Maximum(s)</code>
</ol>
<pre class=tla ><code>Maximum(S) == IF S = {} THEN -1
              ELSE CHOOSE x \in S : \A m \in S : x \geq m</code></pre>
<ol start=284  type=1 >
<li>The <code>ASSUME</code> statement is made for assumptions about the constants
<li><code>SUBSET Acceptor</code> == <code>PowerSetOf(Acceptor)</code>.
<li><code>EXCEPT</code> can be chained!
</ol>
<pre class=tla ><code>       /\ aState&#39; = [aState EXCEPT ![m.ins][acc].mbal = m.bal,
                                   ![m.ins][acc].bal  = m.bal,
                                   ![m.ins][acc].val  = m.val]</code></pre>
<ol start=287  type=1 >
<li>This is also legit:
</ol>
<pre class=tla ><code>Phase1b(acc) ==  
  \E m \in msgs : 
    /\ m.type = &quot;phase1a&quot;
    /\ aState[m.ins][acc].mbal &lt; m.bal
    /\ aState&#39; = [aState EXCEPT ![m.ins][acc].mbal = m.bal]
    /\ Send([type |-&gt; &quot;phase1b&quot;, 
             ins  |-&gt; m.ins, 
             mbal |-&gt; m.bal, 
             bal  |-&gt; aState[m.ins][acc].bal, 
             val  |-&gt; aState[m.ins][acc].val,
             acc  |-&gt; acc])
    /\ UNCHANGED rmState
</code></pre>
<ol start=288  type=1 >
<li>Elements of a <code>Symmetry Set</code> may not appear in a <code>CHOOSE</code>.
<li><code>ASSUME</code> must be a constant formula.
<li>Specs hold as undefined all values of all variables not used at all times. It‚Äôs best not to think of specs as programs which describe the correct behaviour of the system. The describe a universe in which the system and its environment are behaving correctly.<br />

<li>Steps that leave are variable values unchanged are called <code>stuttering steps</code>. Including stuttering steps helps us say what a system <em>may</em> do, but now we want to specify what a system <em>must</em> do.
<li>A finite sequence is another name for <code>tuple</code>.
<li><a href="https://lamport.azurewebsites.net/video/ABSpec.tla">Alternating Bit</a> protocol: Let‚Äôs say you have users A and B. If A sends to B 4 strings, how can B detect if A sent repeated strings multiple times? There is no way to tell apart <code>Fred, Mary, Mary, Ted, Ted, Ted, Ann</code> from <code>Fred, Mary, Ted, Ann</code>. You could timestamp it, but let‚Äôs not. It‚Äôs easiest to just append a bit that flips after every message. Appending a bit can be done with
</ol>
<pre class=tla ><code>TypeOK == /\ Data \X {0, 1} \* where \X is the cartesian product</code></pre>
<ol start=293  type=1 >
<li>To talk about <code>may/must</code>, we will talk about liveness and Safety properties.
</ol>
<ul>
<li><code>Safety Formula</code>: Asserts what may happen. Any behavior that violates it does so at some point. Nothing past that point makes nay difference.
<li><code>üî∑ Liveness / eventually Formula</code>: Asserts only what must happen. A behavior can <em>not</em> violate it at any point. Only liveness property sequential programs must satisfy is <code>üî∑Terminated</code>
<li>Weak fairness of Action A: if A ever remains continuously enabled, then A step must eventually occur. Equivalent - A cannot remain enabled forever without another A step occurring. It‚Äôs written as <code>WF_vars(A)</code>
<ul>
<li>A spec with liveness is writeen as <code>Init [][Next]_vars /\ Fairness</code>
<li>Have TLC check the liveness property by clicking on the <code>Properties</code> part of the toolbox and then <code>\A v \in Data \X {0,1} : (AVar = v) ~&gt; (BVar = v)</code>.
</ul>
</ul>
<ol start=294  type=1 >
<li>Now on to the full <a href="https://lamport.azurewebsites.net/video/AB.tla">AB Protocol</a>
<li><code>Strong Fairness</code> of action A asserts of a behavior: - If A is ever <code>repeatedly enabled</code>, then an A step must eventually occur. - Equivalently: A cannot be repeatedly enabled forever without another A step occurring. - Weak fairness gives you the possibility of your enabling condition being flip-flopped forever. Strong fairness guarantees if you are enabled repeatedly, A must occurr.
<li>What good is liveness? What is the good in knowing that something eventually happens in 10^6 years? This is good if there‚Äôs no hard real time requirements.
<li>Recursive declarations must be prepended with <code>RECURSIVE</code>
</ol>
<pre class=tla ><code>RECURSIVE RemoveX(_)
RemoveX(seq) == IF seq = &lt;&lt; &gt;&gt;
                THEN &lt;&lt; &gt;&gt;
                ELSE IF Head(seq) = &quot;X&quot;
                     THEN RemoveX(Tail(seq))
                     ELSE &lt;&lt;Head(seq)&gt;&gt; \o RemoveX(Tail(seq))</code></pre>
<ol start=298  type=1 >
<li>The Temporal Substitution law: can‚Äôt do the basic maths trick have to had the üî≤
</ol>
<pre class=tla ><code>THEOREM üî≤ (v = e) =&gt; (f = (f WITH v &lt;- e))</code></pre>
<ol start=299  type=1 >
<li>When in AB2, we add the possibility for messages to be corrupted. If that happens, we will need to compare messages to a potential ‚ÄúBad‚Äù string, and TLC will yell at formulas like <code>"Bad" = 0</code>. Instead, we can call the constant <code>Bad</code> a model value.
<li>When trying to specify the liveness of the spec, it‚Äôs good to try and attach metadata for what actually happened, but don‚Äôt append <code>TRUE/FALSE</code> to your messages - separate another Sequence as <code>&lt;&lt;TRUE,FALSE,TRUE...&gt;&gt;</code> to keep track of the <em>real</em> and <em>imaginary</em> parts of the spec.
<li>Refinement mappings help make implementations easier.
</ol>
<h3 id=section-23 >19/06/2021</h3>
<ol start=267  type=1 >
<li>In TLA+, every value is a set: 42 is a set, ‚Äúabc‚Äù is a set.
<li>This represents
</ol>
<pre class=tla ><code>TCTypeOK ==
    rmState \in [RM -&gt; {&quot;working&quot;, &quot;prepared&quot;, &quot;committeed&quot;, &quot;aborted&quot;}]
TCInit == rmState = [r \in RM |-&gt; &quot;working&quot;] (* this means the array with index set RM such that every element rm of RM is mapped to &quot;working&quot;*)</code></pre>
<ol start=269  type=1 >
<li>Terminology | Programming | Math| |‚Äî|‚Äî| | array | function | |index set | domain | |f[e] | f(e) |
<li>Remember notation for updating a record:
</ol>
<pre class=tla ><code>Prepare(r) == /\ rmState[r] = &quot;working&quot;
              /\ rmState&#39; = [rmState EXCEPT ![r] = &quot;prepared&quot;]

Decide(r)  == \/ /\ rmState[r] = &quot;prepared&quot;
                 /\ canCommit
                 /\ rmState&#39; = [rmState EXCEPT ![r] = &quot;committed&quot;]
              \/ /\ rmState[r] \in {&quot;working&quot;, &quot;prepared&quot;}
                 /\ notCommitted
                 /\ rmState&#39; = [rmState EXCEPT ![r] = &quot;aborted&quot;]</code></pre>
<ol start=271  type=1 >
<li>Ah! Draw the state machine and then figure out the actions that transition to each state!
<li>If you see the Coverage of actions and some of the actions were never taken <code>Count == 0</code>, it usually means there‚Äôs an error in the spec.
<li>End of line <code>\* comment syntax</code>
<li>This record is actually a function, whose domain is <code>{"prof", "name"} such that f["prof"] = "Fred" and f["num"] = 42</code>. <code>f.prof === f["prof"]</code>
</ol>
<pre class=tla ><code>[prof |-&gt; &quot;Fred&quot;, num |-&gt; 42]</code></pre>
<ol start=275  type=1 >
<li>Abbreviate <code>[f EXCEPT !["prof"] = "Red"</code> as <code>[f EXCEPT !.prof = "Red"}]</code>
<li><code>UNCHANGED &lt;&lt;rmState, tmSTate, msgs&gt;&gt;</code> is an ordered triple. It‚Äôs equivalent to
</ol>
<pre class=tla ><code>... /\ rmState&#39; = rmState
    /\ tmState&#39; = tmState
    /\ msgs&#39; = msgs</code></pre>
<ol start=277  type=1 >
<li>Conditions which have no primes‚Äô are calle <em>enabling conditions</em>, and in an Action Formula should go at the beginning, like so.
</ol>
<pre class=tla ><code>TMRcvPrepared(r) == /\ tmState = &quot;init&quot;
                    /\ [type |-&gt; &quot;Prepared&quot;, rm |-&gt; r] \in msgs</code></pre>
<ol start=278  type=1 >
<li>Update the CommunityModules.jar‚Ä¶ or else get hit by a bug..
<li><code>Symmetry sets</code>: if ‚Äúr1‚Äù‚ÜîÔ∏é ‚Äúr3‚Äù in all states of behavior <code>b</code> allowed by <code>TwoPhase</code> produces a behaviour <code>b\_{1,3}</code> allowed by <code>TwoPhase</code>, TLC does not have to check <code>b\_{1,3}</code> if it has checked <code>b</code>. Becuase <code>RM = {"r1", "r2", "r3"}</code>, We say that RM is a <code>symmetry set</code> of <code>TwoPhase</code>. To exploit this, replace
</ol>
<pre class=tla ><code>RM &lt;- {&quot;r1&quot;, &quot;r2&quot;, &quot;r3&quot;}</code></pre>
<p>with</p>
<pre class=tla ><code>RM &lt;- {r1, r2, r3}</code></pre>
<p>select <code>Set of model values/Symmetry Set</code> just below it. 280. So it turns out that TwoPhase Commit can break if the TM fails. If you try to ‚Äújust‚Äù engineer it with a second TM, they can cannibalize messages if TM1 pauses and TM2 takes over and sends an abort signal.</p>
<h3 id=section-24 >18/06/2021</h3>
<ol start=256  type=1 >
<li>A <code>behaviour</code> of a system is a sequence of states. A <code>state machine</code> is described by all its possible initial states and a next state relation. A <code>state</code> is an assignment of values to variables. The part of the program that controls what action is executed next is called the <code>control state</code>.
<li>A new TLA+ spec‚Ä¶
</ol>
<pre class=tla ><code>------------------------------- MODULE simple -------------------------------
EXTENDS Integers
VARIABLES pc, i


Init == i = 0 /\ pc = &quot;start&quot;

Pick == \/ /\ pc = &quot;start&quot;
           /\ i&#39; \in 0..1000
           /\ pc&#39; = &quot;middle&quot;
         
Add1 == \/ /\ pc = &quot;middle&quot;
           /\ i&#39; = i + 1
           /\ pc&#39; = &quot;done&quot;

Next == Pick \/ Add1

=============================================================================
\* Modification History
\* Last modified Fri Jun 18 20:58:16 CDT 2021 by mrg
\* Created Fri Jun 18 20:50:35 CDT 2021 by mrg
</code></pre>
<ol start=258  type=1 >
<li>To produce the PDF, type <code>Ctrl + Alt + P</code>.
<li>DON‚ÄôT use Tabs (config in Preferences), F3/F4 to jump back and forth, F5 to see all defs, F6 for all uses of word under cursor, F10 is jump to PlusCal unfolded def, Oooh boxed comments are neat with <code>Ctrl+O + Ctrl+B</code> and friends, don‚Äôt shade PlusCal code, regen pdf on save, <code>Ctrl+TAB</code> to swap between tabs, <code>Ctrl+Alt</code> to swap between subtabs
<li><a href="https://twitter.com/hillelogram/status/1406081888498892807">Hillel‚Äôs super cool tricks for TLA+</a>
<li>This formula <code>FillSmall == small' = 3</code> is WRONG. It‚Äôs true for some steps and false for others. It is NOT an assignment. The <code>big</code> must remain unchanged! If you don‚Äôt you are coding, if you do keep it same, you are doing math. eg:
</ol>
<pre class=tla ><code>FillSmall == /\ small&#39; = 3
             /\ big&#39; = big</code></pre>
<ol start=262  type=1 >
<li>Remember you can add <code>TypeOK</code> as an invariant and <code>big # 4</code> too!
<li><code>big + small =&lt; 5</code> , not <code>big + small &lt;= 5</code> üôÅ
<li>Equality is commutative! <code>0 = small === small' = 0</code>
<li>Use a ‚Äô expression only in <code>v' = ...</code> and <code>v' \in ...</code>
</ol>
<h3 id=section-25 >17/06/2021</h3>
<ol start=247  type=1 >
<li><a href="https://unixism.net/loti/async_intro.html">io_uring tutorial here</a>, with a <a href="https://github.com/robn/yoctochat">chatbot example here</a>
<li><a href="https://carllerche.com/2021/06/17/six-ways-to-make-async-rust-easier/">6 ways to make async Rust easier</a>
<li>Triage: <code>filter(func)</code> makes <code>func</code> a <code>Fix1</code>.
<li>Lazy iterators have uppercase names!
<li>GC is broken in multithreading - if thread 1 is allocating a bunch of garbage, and thread 2 isn‚Äôt, then thread 1 can trigger a dozen collections, making thread 2 think its few objects are very old, and thus don‚Äôt need to be collected.
<li>Lean4: <code>return</code> at the end will hurt type inference.
<li><code>fpcontract</code> is a type of <code>fastmath flag</code>. If you use LLVMCall, you can use specific ones. Here‚Äôs a specific issue for <a href="https://github.com/JuliaLang/julia/issues/40139">automatic FMA</a>.
<li>Turns out <a href="https://www.cs.nott.ac.uk/~pszgmh/fold.pdf">folds are universal</a> -
<li>PROJECT IDEA: <a href="https://www-zeuthen.desy.de/theory/capp2005/Course/czakon/capp05.pdf">Feynman Diagrams???</a>
</ol>
<h3 id=section-26 >16/06/2021</h3>
<ol start=230  type=1 >
<li><a href="https://stackoverflow.com/tags/x86/info">Travis Downs recommends this x86 link dump</a> - it‚Äôs great! OMG it‚Äôs way too much‚Ä¶
<li><code>git format-patch -1 --pretty=fuller 3a38e874d70b</code> to format patches for the linux kernel.
<li><code>git send-email mypatch.patch</code> to send patches, <code>git format-patch</code> to make it.
<li><code>cregit, bison, flex, cscope</code> are useful tools for navigating kernel source code.
<li><code>git log -2 Makefile</code> shows the last 2 commits that went into <code>Makefile</code>.
<li><code>git log -2 --author=Linus</code> checks for the last 2 commits by Linus o.0
<li>You can comput in subtype expressions! Thanks to <code>Dr. Bauman</code> for this gem.
</ol>
<div class=sourceCode  id=cb37 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb37-1 ><a href="#cb37-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >struct</span> MyArrayWrapper{A} <span class=op >&lt;:</span> supertype(A)</span>
<span id=cb37-2 ><a href="#cb37-2" aria-hidden=true  tabindex=-1 ></a>    data<span class=op >::</span>A</span>
<span id=cb37-3 ><a href="#cb37-3" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<ol start=237  type=1 >
<li><code>make core</code> will maek the core tests in Julia.
<li><code>JULIA_LLVM_ARGS=-timepasses ./julia</code> To time all passes! Cool Stuff I learned from <code>Jameson Nash</code>.
<li><code>cat Make.user</code> to get
<li><code>cp -a v1.7/ v1.8/</code> to copy over all files
<li>Disabling DWARF with <code>./julia -g0</code> will make your code go <em>slightly faster</em> because you don‚Äôt emit as much DWARF stuff - Probs worth looking into disabling it more.
<li>User vs System time: User land vs Kernel land timings<br />

<li>Profiler tricks:
</ol>
<div class=sourceCode  id=cb38 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb38-1 ><a href="#cb38-1" aria-hidden=true  tabindex=-1 ></a>Profile.print(C <span class=op >=</span> <span class=ex >true</span><span class=op >,</span> nosiefloor <span class=op >=</span> <span class=fl >1</span><span class=op >,</span> mincount <span class=op >=</span> <span class=fl >10</span>)</span></code></pre></div>
<ol start=244  type=1 >
<li><code>e-&gt;Lunions = oldLunions;</code> is copying by value (which means a stack of 100 int32s is being copied on all that)
<li>Charpov sent me <code>homework1</code> and friends - MPI assignment is Homework 5.
<li>TLA+ Link dump
</ol>
<ul>
<li><a href="https://www.youtube.com/watch?v=wjsI0lTSjIo">mpmc.c Lemmy tutorial</a> <a href="https://github.com/lemmy/BlockingQueue/blob/master/impl/producer_consumer.c">with C code</a>, <a href="https://www.cs.unh.edu/~charpov/programming-tlabuffer.html">java example</a>
<li><a href="https://weblog.cs.uiowa.edu/cs5620f15/Homework">PlusCal course</a>
<li><a href="https://d3s.mff.cuni.cz/f/teaching/nswi101/pluscal.pdf">cheat sheet</a>
<li>PROJECT IDEA: <a href="https://lpsa.swarthmore.edu/NumInt/NumIntFourth.html">Lean 4 Runge Kutta</a>, <a href="https://www.johndcook.com/blog/2016/06/02/ode-solver-as-a-functional-fold/">Functional Fold!</a>
<li><a href="https://cse.buffalo.edu/~demirbas/CSE586/book.pdf">Intro to Distributed Systems book - Murat Demirbas recc</a>
<li><a href="https://muratbuffalo.blogspot.com/2018/01/modeling-doa-attack-in-pluscal.html">Dao attack in PlusCal</a>, <a href="https://github.com/muratdem/PlusCal-examples/tree/master/DAO">code is here</a>
<li><a href="https://github.com/tlaplus/Examples/issues/15">beginner friendly examples</a>
<li><a href="https://github.com/arnaudbos/aoc2020-tla-plus/blob/master/day1/DayOne.tla">advent of code 2020</a>
<li><a href="https://github.com/lorin/tla-tortoise-hare/blob/master/CycleDetection.tla">tortoise and hare cycle detection algo</a>
<li><a href="https://github.com/spacejam/tla-rust#here-we-go-jumping-into-pluscal">Rust and TLA+</a>,
</ul>
<h3 id=section-27 >15/06/2021</h3>
<ol start=206  type=1 >
<li>Discovered <a href="https://github.com/Genivia/ugrep">upgrep</a>, which is a very optimized grep built in Cpp. Of note are the lockless work stealing scheduler and SIMD debranchification approach. It has a very, very pretty interactive <code>ugrep -Q 'foo'</code> mode. The debranching algo is <a href="https://www.youtube.com/watch?v=kA7qZgmfwD8">exposed in this talk</a>.
<li>Rediscovered <a href="https://calculusmadeeasy.org/">Calculus made easy</a> and <a href="https://artofproblemsolving.com/school">AoPS boards</a>.
<li>Never a bad time to remember the <a href="https://github.com/miguelraz/CFDPython">CFDPython</a> exists.
<li>Found the books <code>More/Surprises in Theoretical Physics by Rudolf Peierls</code>.
<li>Also found <a href="https://github.com/tobydriscoll/fnc-extras">Fundamentals of Numerical Computing</a> by Toby Driscoll and <a href="http://people.maths.ox.ac.uk/trefethen/Exploring.pdf">Exploring ODEs</a>
<li>PROJECT IDEA: Scrape <a href="https://uops.info/xml.html">uops.info</a> with <code>TableScraper.jl</code>.
<li>PROJECT IDEA: CourseTemplates.jl based on <a href="https://github.com/mitmath/18S191">Computational Thinking from MIT</a> which is <a href="https://computationalthinking.mit.edu/Spring21/semesters/">very pretty</a>.
<li>Remember the Intel OPtimization manuals come with <a href="https://github.com/intel/optimization-manual/tree/2a7418eb5b6d750437c51542aec276a4d688fcba/common">attached example codes</a>
<li>PROJECT IDEA: Port <a href="https://gw-odw.thinkific.com/courses/take/gw-open-data-workshop-4/texts/24465187-welcome">GW Open Data Workshop</a> too.
<li><a href="https://github.com/gwisk/gradguide">Read George‚Äôs grad guide</a>.
<li>Julius‚Äô post on <a href="https://jkrumbiegel.com/pages/2021-06-07-macros-for-beginners/">Julia macros for beginners</a> is great.
<li>PROJECT IDEA: REPL Based PlutoUI.jl. WITH VIM BINDINGS + TextUserInterfaces.jl maybe?. YES. YES!
<li>PROJECT IDEA: Open Data structures in Julia with the MIT course template.
<li>Look into <a href="https://www-zeuthen.desy.de/theory/capp2005/Course/czakon/capp05.pdf">DIANA</a> and Julian ports of it (<a href="https://core.ac.uk/download/pdf/25359736.pdf">paper is here</a>, <a href="https://github.com/apik/diana">code is here</a>). - <a href="https://github.com/FeynCalc/feyncalc">FeynCalc</a> in Mathematica is an interesting contender: <a href="https://feyncalc.github.io/FeynCalcExamplesMD/EW/Tree/H-FFbar">3.4 seconds</a> to calculate the Higgs decaying into a fermion-antifermion pair.
<li>Learned how to fix a sink today: Need a stillson wrench, a bucket and a metal coat hanger. Put the bucket under the sink‚Äôs elbow. Twist off the bottom of the elbow. If there‚Äôs no much when you take off the cap, it‚Äôs likely there‚Äôs no blockage at the elbow. Next, scrape the circumferences of the sink‚Äôs drain with the wire hanger, letting off a bit of water to rinse the muck. Repeat until clean, don‚Äôt forget to wrench up the bottom of the elbow again.
<li>PROJECT IDEA: LLVMPassAnalyzer.jl with <a href="https://github.com/ronisbr/TextUserInterfaces.jl">Text User Interfaces.jl</a> as the backend. Or maybe <a href="https://github.com/kdheepak/TerminalUserInterfaces.jl">TerminalUserInterfaces.jl</a>
<li>Lean: <code>import Leanpkg; #eval Leanpkg.leanVersionString</code>, commetns are with <code>--</code>, arrays <code>#[1,2,3][1] == 1</code>, functions don‚Äôt need spaces so <code>gcd 1 10 == 1</code>, Lists are <code>[1,2,3]</code>,
</ol>
<pre class=lean ><code>structure Array (a : Type u) where
    data : List a</code></pre>
<ol start=223  type=1 >
<li><code>eval List.map (fun x =&gt; x + 1) [1, 2, 3]</code> and <code>#eval List.map (fun (x,y) =&gt; x + y) [(1,2), (3,4)] == [3,7]</code>
<li>There‚Äôs <a href="https://agentultra.github.io/lean-for-hackers/">Lean for hackers</a>, and you can run your file with <code>lean --run leanpkg.lean</code>.
<li><a href="https://functional-algorithms-verified.org/functional_algorithms_verified.pdf">Functional Algorithms Verified!</a> sounds awesome, but not in Lean4
<li><a href="https://lean-forward.github.io/logical-verification/2020/index.html">Logical Verification in Lean</a>
<li><a href="https://www.dc.fi.udc.es/~cabalar/vv/index.html">Temporal Logic slides and exams</a>
<li><a href="https://www.youtube.com/watch?v=qDyJ9H6r0YA">LTL Model checking course</a> and book <code>Principles of MOdel Checking - J P Katoen</code>
<li><a href="https://github.com/IPDSnelting/tba-2021">Lean 4 course by Seb. Ullrich</a> is THE source and <a href="https://github.com/agentultra/lean-for-hackers/blob/master/index.md">Lean for hackers</a> looks like a good hello world post.
</ol>
<ul>
<li>Bonus <a href="https://github.com/rwbarton/advent-of-lean-4">advent of lean4</a>
<li>PROJECT IDEA: <a href="https://github.com/GaloisInc/lean-protocol-support/blob/cabfa3abedbdd6fdca6e2da6fbbf91a13ed48dda/galois/temporal/temporal.lean">Linear Temporal Logic in Lean4</a>
<li><a href="https://twitter.com/visakanv/status/1405252979301634049">All the adhd feels today</a>
</ul>
<h3 id=section-28 >11/06/2021</h3>
<ol start=196  type=1 >
<li><code>MXCSR</code>: Multimedia eXtension Control and Store Registers - can be accessed with <code>vldmxcsr, vstmxcsr</code>
<li>The amazing <code>Jubilee</code> shares another nugget: &gt; So like‚Ä¶ the problem with those is that access to the MXCSR bit field actually can break LLVM compilation assumptions. &gt; it‚Äôs literally UB. &gt; To touch it. At all. &gt; Now, it so happens that LLVM may not break your code if you actually do it, and LLVM is slowly growing the capability to handle altering MXCSR in a principled manner, but anyone touching it is doing so at their own risk, aware that it‚Äôs UB.
<li>When going form AVX to SSE instructions, there may be a performacne penalty due to keeping the upper 128 bits of YMM registers intact - use <code>vzeroupper</code> before that to avoid all perf penalties. Also, AVX allows unaligned accesses with a perf cost, but keeping alignment will increase perf.
<li>MASM calling convention: pass first 4 float args in xmm0:3.
<li>Leaf functions in assembly don‚Äôt need a prolog or epilog, non-leaf functions <em>must</em>: save and restore volatile registers, initialize stack frame pointer, allocate local storage space on the stack, call other functions.
<li>In C++, you can align xmm values with
</ol>
<div class=sourceCode  id=cb40 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb40-1 ><a href="#cb40-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >struct</span> XmmVal <span class=op >{</span></span>
<span id=cb40-2 ><a href="#cb40-2" aria-hidden=true  tabindex=-1 ></a><span class=kw >public</span><span class=op >:</span></span>
<span id=cb40-3 ><a href="#cb40-3" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >union</span> <span class=op >{</span></span>
<span id=cb40-4 ><a href="#cb40-4" aria-hidden=true  tabindex=-1 ></a>        <span class=dt >int8_t</span> <span class=va >m_I8</span><span class=op >[</span><span class=dv >16</span><span class=op >];</span></span>
<span id=cb40-5 ><a href="#cb40-5" aria-hidden=true  tabindex=-1 ></a>        <span class=dt >int16_t</span> <span class=va >m_I16</span><span class=op >[</span><span class=dv >8</span><span class=op >];</span></span>
<span id=cb40-6 ><a href="#cb40-6" aria-hidden=true  tabindex=-1 ></a>        <span class=co >//...</span></span>
<span id=cb40-7 ><a href="#cb40-7" aria-hidden=true  tabindex=-1 ></a>        <span class=dt >float</span> <span class=va >m_F32</span><span class=op >[</span><span class=dv >4</span><span class=op >];</span></span>
<span id=cb40-8 ><a href="#cb40-8" aria-hidden=true  tabindex=-1 ></a>        <span class=dt >double</span> <span class=va >m_F64</span><span class=op >[</span><span class=dv >2</span><span class=op >];</span></span>
<span id=cb40-9 ><a href="#cb40-9" aria-hidden=true  tabindex=-1 ></a>    <span class=op >}</span></span>
<span id=cb40-10 ><a href="#cb40-10" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span>
<span id=cb40-11 ><a href="#cb40-11" aria-hidden=true  tabindex=-1 ></a><span class=dt >void</span> AvxPackedMathF64 <span class=op >{</span></span>
<span id=cb40-12 ><a href="#cb40-12" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >alignas</span><span class=op >(</span><span class=dv >16</span><span class=op >)</span> XmmVal a<span class=op >;</span></span>
<span id=cb40-13 ><a href="#cb40-13" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >alignas</span><span class=op >(</span><span class=dv >16</span><span class=op >)</span> XmmVal b<span class=op >;</span></span>
<span id=cb40-14 ><a href="#cb40-14" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >alignas</span><span class=op >(</span><span class=dv >16</span><span class=op >)</span> XmmVal c<span class=op >[</span><span class=dv >8</span><span class=op >];</span></span>
<span id=cb40-15 ><a href="#cb40-15" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<ol start=202  type=1 >
<li>To get those xmm‚Äôs into vector registers:
</ol>
<div class=sourceCode  id=cb41 ><pre class="sourceCode asm"><code class="sourceCode fasm"><span id=cb41-1 ><a href="#cb41-1" aria-hidden=true  tabindex=-1 ></a><span class=co >; Load packed SPFP values</span></span>
<span id=cb41-2 ><a href="#cb41-2" aria-hidden=true  tabindex=-1 ></a>    <span class=bu >vmovaps</span> <span class=kw >xmm0</span><span class=op >,</span> xmmword <span class=dt >ptr</span> <span class=op >[</span><span class=kw >rcx</span><span class=op >]</span> <span class=co >;xmm0 = a</span></span>
<span id=cb41-3 ><a href="#cb41-3" aria-hidden=true  tabindex=-1 ></a>    <span class=bu >vmovaps</span> <span class=kw >xmm1</span><span class=op >,</span> xmmword <span class=dt >ptr</span> <span class=op >[</span><span class=kw >rdx</span><span class=op >]</span> <span class=co >;xmm1 = b</span></span></code></pre></div>
<p>So, note you load the entire <code>xmm</code> register with <code>xmmword ptr [foo]</code>. 203. Super cool trick to check 16 byte alignment (no perf penalty)</p>
<div class=sourceCode  id=cb42 ><pre class="sourceCode asm"><code class="sourceCode fasm"><span id=cb42-1 ><a href="#cb42-1" aria-hidden=true  tabindex=-1 ></a><span class=bu >test</span> <span class=kw >rcx</span><span class=op >,</span> ofh <span class=co >; jump if x not aligned to 16 byte boundary</span></span>
<span id=cb42-2 ><a href="#cb42-2" aria-hidden=true  tabindex=-1 ></a><span class=cf >jnz</span> Done</span></code></pre></div>
<ol start=204  type=1 >
<li>Macros avoid overehad of a function call.
<li>Want to transpose a matrix? Use a bunch of <code>vunpcklps</code>, <code>vunpckhps</code>, <code>vmovlhps</code>, <code>vmovhlps</code>.
</ol>
<h3 id=section-29 >10/06/2021</h3>
<ol start=175  type=1 >
<li>Assembly!
</ol>
<ul>
<li>rax - temporary register; when we call a syscal, rax must contain syscall number
<li>rdi - used to pass 1st argument to functions
<li>rsi - ptr to pass 2nd argument to functions
<li>rdx - used to pass 3rd argument to functions This mirrors this syscall in C:
</ul>
<div class=sourceCode  id=cb43 ><pre class="sourceCode c"><code class="sourceCode c"><span id=cb43-1 ><a href="#cb43-1" aria-hidden=true  tabindex=-1 ></a><span class=dt >size_t</span> sys_write<span class=op >(</span><span class=dt >unsigned</span> <span class=dt >int</span> fd<span class=op >,</span> <span class=dt >const</span> <span class=dt >char</span><span class=op >*</span> buf<span class=op >,</span> <span class=dt >size_t</span> count<span class=op >);</span></span></code></pre></div>
<ul>
<li><code>fd</code> - file descriptor, 0,1,2 for stin, stdout, and stderr respectviely
<li><code>buf</code> - points to char array, can store content from file pointed at by fd
<li><code>count</code> - specifies number of bytes to be written from the file into the char array
</ul>
<ol start=176  type=1 >
<li>Little-endian - smallest byte as smallest address. Derp.
<li><code>data, bss, text</code> - initialized consts/dadta, non initialized vars, code section in asm.
<li>registers: rax:rdx, bp sp si di, r8:r15
<li>There‚Äôs several types of initialzied data <code>db</code> (declare bytes), <code>dw</code> (declare words), etc. There‚Äôs also <code>RESB, RESW</code> as reserved bytes, reserved words, etc. <code>INCBIN</code> is for external binary files, <code>EQU</code> for defining constants:
</ol>
<div class=sourceCode  id=cb44 ><pre class="sourceCode asm"><code class="sourceCode fasm"><span id=cb44-1 ><a href="#cb44-1" aria-hidden=true  tabindex=-1 ></a>one equ <span class=dv >1</span></span></code></pre></div>
<p>Exercise: try to translate the following C code into asm:</p>
<div class=sourceCode  id=cb45 ><pre class="sourceCode c"><code class="sourceCode c"><span id=cb45-1 ><a href="#cb45-1" aria-hidden=true  tabindex=-1 ></a><span class=cf >if</span> <span class=op >(</span>rax <span class=op >!=</span> <span class=dv >50</span><span class=op >)</span> <span class=op >{</span></span>
<span id=cb45-2 ><a href="#cb45-2" aria-hidden=true  tabindex=-1 ></a>    exit<span class=op >();</span></span>
<span id=cb45-3 ><a href="#cb45-3" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span> <span class=cf >else</span> <span class=op >{</span></span>
<span id=cb45-4 ><a href="#cb45-4" aria-hidden=true  tabindex=-1 ></a>    right<span class=op >();</span></span>
<span id=cb45-5 ><a href="#cb45-5" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<p>Attempt:</p>
<div class=sourceCode  id=cb46 ><pre class="sourceCode asm"><code class="sourceCode fasm"><span id=cb46-1 ><a href="#cb46-1" aria-hidden=true  tabindex=-1 ></a>    <span class=bu >cmp</span> <span class=kw >rax</span><span class=op >,</span> <span class=dv >50</span></span>
<span id=cb46-2 ><a href="#cb46-2" aria-hidden=true  tabindex=-1 ></a>    <span class=cf >jne</span> <span class=op >.</span>exit</span>
<span id=cb46-3 ><a href="#cb46-3" aria-hidden=true  tabindex=-1 ></a>    <span class=cf >jmp</span> <span class=op >.</span>right <span class=co >; HOT DAMN FIRST TRY YO</span></span></code></pre></div>
<ol start=180  type=1 >
<li>Only 6 args can be pass via registers, the rest are passed on the stack:
</ol>
<ul>
<li>rdi - first argument
<li>rsi - second argument
<li>rdx - third argument
<li>rcx - fourth argument
<li>r8 - fifth argument
<li>r9 - sixth So if you have
</ul>
<div class=sourceCode  id=cb47 ><pre class="sourceCode c"><code class="sourceCode c"><span id=cb47-1 ><a href="#cb47-1" aria-hidden=true  tabindex=-1 ></a><span class=dt >int</span> foo<span class=op >(</span><span class=dt >int</span> a1<span class=op >,</span> <span class=dt >int</span> a2<span class=op >,</span> <span class=dt >int</span> a3<span class=op >,</span> <span class=dt >int</span> a4<span class=op >,</span> <span class=dt >int</span> a5<span class=op >,</span> <span class=dt >int</span> a6<span class=op >,</span> <span class=dt >int</span> a7<span class=op >)</span></span>
<span id=cb47-2 ><a href="#cb47-2" aria-hidden=true  tabindex=-1 ></a><span class=op >{</span></span>
<span id=cb47-3 ><a href="#cb47-3" aria-hidden=true  tabindex=-1 ></a>    <span class=cf >return</span> <span class=op >(</span>a1 <span class=op >+</span> a2 <span class=op >-</span> a3 <span class=op >-</span> a4 <span class=op >+</span> a5 <span class=op >-</span> a6<span class=op >)</span> <span class=op >*</span> a7<span class=op >;</span></span>
<span id=cb47-4 ><a href="#cb47-4" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<p>The first six are pass in the registers, and the 7th arg you have to pop from the stack: <code>push arg/ pop arg</code>. In MASM, you get 4 registers for calling convention and the rest are in 8 byte incremetns from the RSP. ALSO: After you are finished being called, you have to restor registers <code>rbp, rbx, r12:r15</code></p>
<ol start=181  type=1 >
<li>You can write nicer headers
</ol>
<div class=sourceCode  id=cb48 ><pre class="sourceCode asm"><code class="sourceCode fasm"><span id=cb48-1 ><a href="#cb48-1" aria-hidden=true  tabindex=-1 ></a><span class=bu >section</span> <span class=op >.</span>data</span>
<span id=cb48-2 ><a href="#cb48-2" aria-hidden=true  tabindex=-1 ></a>        SYS_WRITE equ <span class=dv >1</span></span>
<span id=cb48-3 ><a href="#cb48-3" aria-hidden=true  tabindex=-1 ></a>        STD_IN    equ <span class=dv >1</span></span>
<span id=cb48-4 ><a href="#cb48-4" aria-hidden=true  tabindex=-1 ></a>        SYS_EXIT  equ <span class=dv >60</span></span>
<span id=cb48-5 ><a href="#cb48-5" aria-hidden=true  tabindex=-1 ></a>        EXIT_CODE equ <span class=dv >0</span></span>
<span id=cb48-6 ><a href="#cb48-6" aria-hidden=true  tabindex=-1 ></a>    </span>
<span id=cb48-7 ><a href="#cb48-7" aria-hidden=true  tabindex=-1 ></a>        NEW_LINE   <span class=dt >db</span> <span class=bn >0xa</span></span>
<span id=cb48-8 ><a href="#cb48-8" aria-hidden=true  tabindex=-1 ></a>        WRONG_ARGC <span class=dt >db</span> <span class=st >&quot;Must be two command line argument&quot;</span><span class=op >,</span> <span class=bn >0xa</span></span></code></pre></div>
<ol start=182  type=1 >
<li><code>$, $$</code> return the position in memory of string where <code>$</code> is defined, and position in memory of current section start, resp.
<li>Why the instruction <code>mov rdi, $ + 15</code>? You need to use the <code>objdump</code> util, and look at the line after <code>calculateStrLength</code>
</ol>
<pre><code>objdump -D reverse

reverse:     file format elf64-x86-64

Disassembly of section .text:

00000000004000b0 &lt;_start&gt;:
  4000b0:   48 be 41 01 60 00 00    movabs $0x600141,%rsi
  4000b7:   00 00 00
  4000ba:   48 31 c9                xor    %rcx,%rcx
  4000bd:   fc                      cld
  4000be:   48 bf cd 00 40 00 00    movabs $0x4000cd,%rdi
  4000c5:   00 00 00
  4000c8:   e8 08 00 00 00          callq  4000d5 &lt;calculateStrLength&gt;
  4000cd:   48 31 c0                xor    %rax,%rax
  4000d0:   48 31 ff                xor    %rdi,%rdi
  4000d3:   eb 0e                   jmp    4000e3 &lt;reverseStr&gt;</code></pre>
<ol start=184  type=1 >
<li>To checkif a string is set:
</ol>
<div class=sourceCode  id=cb50 ><pre class="sourceCode asm"><code class="sourceCode fasm"><span id=cb50-1 ><a href="#cb50-1" aria-hidden=true  tabindex=-1 ></a>    <span class=bu >test</span> <span class=kw >rax</span><span class=op >,</span> <span class=kw >rax</span>               <span class=co >; check if name is provided </span></span>
<span id=cb50-2 ><a href="#cb50-2" aria-hidden=true  tabindex=-1 ></a>    <span class=cf >jne</span> <span class=op >.</span>copy_name</span></code></pre></div>
<ol start=185  type=1 >
<li>Assembly has macros! These are single line
</ol>
<div class=sourceCode  id=cb51 ><pre class="sourceCode asm"><code class="sourceCode fasm"><span id=cb51-1 ><a href="#cb51-1" aria-hidden=true  tabindex=-1 ></a>%define argc <span class=kw >rsp</span> <span class=op >+</span> <span class=dv >8</span></span>
<span id=cb51-2 ><a href="#cb51-2" aria-hidden=true  tabindex=-1 ></a>%define cliArg1 <span class=kw >rsp</span> <span class=op >+</span> <span class=dv >24</span></span></code></pre></div>
<p>These are multi line</p>
<div class=sourceCode  id=cb52 ><pre class="sourceCode asm"><code class="sourceCode fasm"><span id=cb52-1 ><a href="#cb52-1" aria-hidden=true  tabindex=-1 ></a>%<span class=pp >macro</span> bootstrap <span class=dv >1</span>          <span class=co >; %macro name number_of_params</span></span>
<span id=cb52-2 ><a href="#cb52-2" aria-hidden=true  tabindex=-1 ></a>          <span class=bu >push</span> <span class=kw >ebp</span></span>
<span id=cb52-3 ><a href="#cb52-3" aria-hidden=true  tabindex=-1 ></a>          <span class=bu >mov</span> <span class=kw >ebp</span><span class=op >,</span><span class=kw >esp</span></span>
<span id=cb52-4 ><a href="#cb52-4" aria-hidden=true  tabindex=-1 ></a>%endmacro</span></code></pre></div>
<ol start=186  type=1 >
<li>Don‚Äôt forget the <code>.period</code> when you <code>call .function</code>, AND in the function section titles:
</ol>
<div class=sourceCode  id=cb53 ><pre class="sourceCode asm"><code class="sourceCode fasm"><span id=cb53-1 ><a href="#cb53-1" aria-hidden=true  tabindex=-1 ></a>.returnTrue</span>
<span id=cb53-2 ><a href="#cb53-2" aria-hidden=true  tabindex=-1 ></a>    <span class=bu >mov</span> <span class=kw >eax</span><span class=op >,</span> <span class=dv >1</span></span>
<span id=cb53-3 ><a href="#cb53-3" aria-hidden=true  tabindex=-1 ></a>    <span class=cf >ret</span></span></code></pre></div>
<ol start=187  type=1 >
<li>THERE‚ÄôS STRUCTS in ASSEMBLY?
</ol>
<div class=sourceCode  id=cb54 ><pre class="sourceCode asm"><code class="sourceCode fasm"><span id=cb54-1 ><a href="#cb54-1" aria-hidden=true  tabindex=-1 ></a><span class=pp >struc</span> person</span>
<span id=cb54-2 ><a href="#cb54-2" aria-hidden=true  tabindex=-1 ></a>   <span class=fu >name:</span> resb <span class=dv >10</span></span>
<span id=cb54-3 ><a href="#cb54-3" aria-hidden=true  tabindex=-1 ></a>   <span class=fu >age:</span>  resb <span class=dv >1</span></span>
<span id=cb54-4 ><a href="#cb54-4" aria-hidden=true  tabindex=-1 ></a>endstruc</span>
<span id=cb54-5 ><a href="#cb54-5" aria-hidden=true  tabindex=-1 ></a><span class=co >; and then</span></span>
<span id=cb54-6 ><a href="#cb54-6" aria-hidden=true  tabindex=-1 ></a><span class=bu >section</span> <span class=op >.</span>data</span>
<span id=cb54-7 ><a href="#cb54-7" aria-hidden=true  tabindex=-1 ></a>    <span class=fu >p:</span> istruc person</span>
<span id=cb54-8 ><a href="#cb54-8" aria-hidden=true  tabindex=-1 ></a>      <span class=pp >at</span> name <span class=dt >db</span> <span class=st >&quot;name&quot;</span></span>
<span id=cb54-9 ><a href="#cb54-9" aria-hidden=true  tabindex=-1 ></a>      <span class=pp >at</span> age  <span class=dt >db</span> <span class=dv >25</span></span>
<span id=cb54-10 ><a href="#cb54-10" aria-hidden=true  tabindex=-1 ></a>    iend</span>
<span id=cb54-11 ><a href="#cb54-11" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb54-12 ><a href="#cb54-12" aria-hidden=true  tabindex=-1 ></a><span class=bu >section</span> <span class=op >.</span>text</span>
<span id=cb54-13 ><a href="#cb54-13" aria-hidden=true  tabindex=-1 ></a><span class=fu >_start:</span></span>
<span id=cb54-14 ><a href="#cb54-14" aria-hidden=true  tabindex=-1 ></a>    <span class=bu >mov</span> <span class=kw >rax</span><span class=op >,</span> <span class=op >[</span>p <span class=op >+</span> person<span class=op >.</span>name<span class=op >]</span></span></code></pre></div>
<ol start=187  type=1 >
<li><a href="https://0xax.github.io/asm_7/">Call C from assembly, assembly from C</a>
<li>x86 has 8 registers for floats, they are 10 bytes each, labeled from ST0:ST7
</ol>
<ul>
<li><code>fld dword [x]</code> pushes x to this stack.
<li><code>fldpi</code> loads pi, lol.
</ul>
<div class=sourceCode  id=cb55 ><pre class="sourceCode asm"><code class="sourceCode fasm"><span id=cb55-1 ><a href="#cb55-1" aria-hidden=true  tabindex=-1 ></a>extern printResult</span>
<span id=cb55-2 ><a href="#cb55-2" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb55-3 ><a href="#cb55-3" aria-hidden=true  tabindex=-1 ></a><span class=bu >section</span> <span class=op >.</span>data</span>
<span id=cb55-4 ><a href="#cb55-4" aria-hidden=true  tabindex=-1 ></a>        radius    <span class=dt >dq</span>  <span class=fl >1.7</span></span>
<span id=cb55-5 ><a href="#cb55-5" aria-hidden=true  tabindex=-1 ></a>        result    <span class=dt >dq</span>  <span class=dv >0</span></span>
<span id=cb55-6 ><a href="#cb55-6" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb55-7 ><a href="#cb55-7" aria-hidden=true  tabindex=-1 ></a>        SYS_EXIT  equ <span class=dv >60</span></span>
<span id=cb55-8 ><a href="#cb55-8" aria-hidden=true  tabindex=-1 ></a>        EXIT_CODE equ <span class=dv >0</span></span>
<span id=cb55-9 ><a href="#cb55-9" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb55-10 ><a href="#cb55-10" aria-hidden=true  tabindex=-1 ></a>global _start</span>
<span id=cb55-11 ><a href="#cb55-11" aria-hidden=true  tabindex=-1 ></a><span class=bu >section</span> <span class=op >.</span>text</span>
<span id=cb55-12 ><a href="#cb55-12" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb55-13 ><a href="#cb55-13" aria-hidden=true  tabindex=-1 ></a><span class=fu >_start:</span></span>
<span id=cb55-14 ><a href="#cb55-14" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >fld</span> <span class=dt >qword</span> <span class=op >[</span>radius<span class=op >]</span></span>
<span id=cb55-15 ><a href="#cb55-15" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >fld</span> <span class=dt >qword</span> <span class=op >[</span>radius<span class=op >]</span></span>
<span id=cb55-16 ><a href="#cb55-16" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >fmul</span></span>
<span id=cb55-17 ><a href="#cb55-17" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb55-18 ><a href="#cb55-18" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >fldpi</span></span>
<span id=cb55-19 ><a href="#cb55-19" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >fmul</span></span>
<span id=cb55-20 ><a href="#cb55-20" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >fstp</span> <span class=dt >qword</span> <span class=op >[</span>result<span class=op >]</span></span>
<span id=cb55-21 ><a href="#cb55-21" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb55-22 ><a href="#cb55-22" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >mov</span> <span class=kw >rax</span><span class=op >,</span> <span class=dv >0</span></span>
<span id=cb55-23 ><a href="#cb55-23" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >movq</span> <span class=kw >xmm0</span><span class=op >,</span> <span class=op >[</span>result<span class=op >]</span></span>
<span id=cb55-24 ><a href="#cb55-24" aria-hidden=true  tabindex=-1 ></a>        <span class=cf >call</span> printResult</span>
<span id=cb55-25 ><a href="#cb55-25" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb55-26 ><a href="#cb55-26" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >mov</span> <span class=kw >rax</span><span class=op >,</span> SYS_EXIT</span>
<span id=cb55-27 ><a href="#cb55-27" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >mov</span> <span class=kw >rdi</span><span class=op >,</span> EXIT_CODE</span>
<span id=cb55-28 ><a href="#cb55-28" aria-hidden=true  tabindex=-1 ></a>        <span class=cf >syscall</span></span></code></pre></div>
<p>You have data in <code>radius</code> and <code>result</code>. <code>fld qword [radius]</code> stores radius in ST0, and again in ST1. <code>fmul</code> then multiplies both and puts it in ST0. Load pi with <code>fldpi</code>, multiply, and store that result with <code>fstp qword [result]</code>. C calling convention: pass floats to system through <code>xmm</code> registers, so you have to declare how many you are using - do that with <code>mov rax, 0</code>, <code>movq xmm0, [result]</code>, <code>call printResult</code>, then exit. 189. <a href="https://cs.lmu.edu/~ray/notes/nasmtutorial/">GREAT ASSEMBLY TUTORIAL</a> 190. <code>shl</code> must use register <code>cl</code> to make the shifts. 191. <code>sar</code> shift arithmetic right because it carries over the bit, like in arithmetic, ha. 192. <code>cdq</code> -&gt; ‚Äúconvert dobule word to quadword‚Äù: Dividend in EAX must be sign extended to 64bits. 193. Do integer conversions with <code>movsx</code>, ‚Äúmove integer with sign extension‚Äù and <code>movzxd</code> ‚Äúmove unsigned integer with sign extension double word‚Äù 194. <code>@F</code> is a forward jump, <code>@B</code> backwards jump</p>
<h3 id=section-30 >09/06/2021</h3>
<ol start=166  type=1 >
<li><a href="https://wgtm21.netlify.app/parallel_julia/">Parallel Computing course</a> by WestGrid Canada + HPC.
<li><a href="https://vcpkg.io/en/getting-started.html">vcpkg</a> sounds like a decent package manager for Cpp.
<li>LLVM Tips and tricks: - Use Ninja and tons of flags to speedup compilation: don‚Äôt build all backends, use the new pass manager, only target host architecture, optimized tablegen, release with debug info, - 170.<a href="https://ohshitgit.com/">oh shit git</a> seems neat!
<li>To see what is actually printed after macro replacements, use <code>clang -E foo.c</code>.
<li><code>LLVM Bugpoint</code> does case test reduction
<li>You can unit test the optimizer o.0
</ol>
<div class=sourceCode  id=cb56 ><pre class="sourceCode llvm"><code class="sourceCode llvm"><span id=cb56-1 ><a href="#cb56-1" aria-hidden=true  tabindex=-1 ></a><span class=co >; RUN: opt &lt; %s -constprop -S | FileCheck %s</span></span>
<span id=cb56-2 ><a href="#cb56-2" aria-hidden=true  tabindex=-1 ></a><span class=kw >define</span> <span class=dt >i32</span> <span class=fu >@test</span>() {</span>
<span id=cb56-3 ><a href="#cb56-3" aria-hidden=true  tabindex=-1 ></a>  <span class=fu >%A</span> = <span class=kw >add</span> <span class=dt >i32</span> <span class=dv >4</span>, <span class=dv >5</span></span>
<span id=cb56-4 ><a href="#cb56-4" aria-hidden=true  tabindex=-1 ></a>  <span class=kw >ret</span> <span class=dt >i32</span> <span class=fu >%A</span></span>
<span id=cb56-5 ><a href="#cb56-5" aria-hidden=true  tabindex=-1 ></a>  <span class=co >; CHECK: @test()</span></span>
<span id=cb56-6 ><a href="#cb56-6" aria-hidden=true  tabindex=-1 ></a>  <span class=co >; CHECK: ret i32 9</span></span>
<span id=cb56-7 ><a href="#cb56-7" aria-hidden=true  tabindex=-1 ></a>}</span></code></pre></div>
<ol start=174  type=1 >
<li><a href="https://github.com/0xAX/asm">Best Tutorial for x86</a> I could find, and free! Now I gotta write syscalls snippets for the bloat‚Ä¶
</ol>
<h3 id=section-31 >08/06/2021</h3>
<ol start=164  type=1 >
<li>Lord help me my <code>Learn LLVM 12</code> book is here and I‚Äôm learning C++ to be an uber Julia hacker. Taking the <code>C++ Beyond the Basics</code> course by Kate Gregory I learned
</ol>
<ul>
<li><code>inst const zero = 0</code> tells the comp <code>zero</code> can‚Äôt change.
<li><code>int taxes(int const total)</code> tells the copmiler <code>total</code> can‚Äôt change within the lifetime of this function
<li><code>int GetName() const;</code> const modify the class its in.
<li><code>inst const ci = 3</code> and <code>const int ci = 3</code> are both valid, but prefer <code>const</code> after the thing that can‚Äôt change.
<li><code>[=](){}</code> is a lambda func that copys everything by value, <code>[&amp;]</code> by ref, but copies smartly only the things you used.
</ul>
<div class=sourceCode  id=cb57 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb57-1 ><a href="#cb57-1" aria-hidden=true  tabindex=-1 ></a>vector nums <span class=op >{</span><span class=dv >1</span><span class=op >,</span><span class=dv >2</span><span class=op >,</span><span class=dv >3</span><span class=op >,</span><span class=dv >45</span><span class=op >};</span></span>
<span id=cb57-2 ><a href="#cb57-2" aria-hidden=true  tabindex=-1 ></a><span class=kw >auto</span> isOdd <span class=op >=</span> <span class=op >[](</span><span class=dt >int</span> candidates<span class=op >){</span>candidates <span class=op >%</span> <span class=dv >2</span> <span class=op >!=</span> <span class=dv >0</span><span class=op >;};</span></span>
<span id=cb57-3 ><a href="#cb57-3" aria-hidden=true  tabindex=-1 ></a><span class=dt >int</span> odds <span class=op >=</span> <span class=bu >std::</span>count_if<span class=op >(</span>begin<span class=op >(</span>nums<span class=op >),</span> end<span class=op >(</span>nums<span class=op >),</span> isOdd<span class=op >);</span></span>
<span id=cb57-4 ><a href="#cb57-4" aria-hidden=true  tabindex=-1 ></a><span class=co >// std algorithms have all the goodies that apply to iterators like</span></span>
<span id=cb57-5 ><a href="#cb57-5" aria-hidden=true  tabindex=-1 ></a><span class=co >//any_of, all_of, etc</span></span></code></pre></div>
<ul>
<li>to generate collections, instead of a for loop, try
</ul>
<div class=sourceCode  id=cb58 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb58-1 ><a href="#cb58-1" aria-hidden=true  tabindex=-1 ></a><span class=dt >int</span> i <span class=op >=</span> <span class=dv >0</span><span class=op >;</span></span>
<span id=cb58-2 ><a href="#cb58-2" aria-hidden=true  tabindex=-1 ></a><span class=bu >std::</span>generate_n<span class=op >(</span><span class=bu >std::</span>back_inserter<span class=op >(</span>v<span class=op >),</span> <span class=dv >5</span><span class=op >,</span> <span class=op >[&amp;]()</span> <span class=op >{</span> <span class=cf >return</span> i<span class=op >++;</span> <span class=op >});</span></span></code></pre></div>
<ul>
<li>to accumulate the elements,
</ul>
<div class=sourceCode  id=cb59 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb59-1 ><a href="#cb59-1" aria-hidden=true  tabindex=-1 ></a><span class=dt >int</span> total <span class=op >=</span> <span class=dv >0</span></span>
<span id=cb59-2 ><a href="#cb59-2" aria-hidden=true  tabindex=-1 ></a>total <span class=op >=</span> <span class=bu >std::</span>accumulate<span class=op >(</span>begin<span class=op >(</span>v<span class=op >),</span> end<span class=op >(</span>v<span class=op >),</span> <span class=dv >0</span><span class=op >);</span></span></code></pre></div>
<ul>
<li>to count elements
</ul>
<div class=sourceCode  id=cb60 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb60-1 ><a href="#cb60-1" aria-hidden=true  tabindex=-1 ></a><span class=dt >int</span> count3 <span class=op >=</span> <span class=bu >std::</span>count<span class=op >(</span>begin<span class=op >(</span>v<span class=op >),</span> end<span class=op >(</span>v<span class=op >),</span> <span class=dv >3</span><span class=op >);</span></span></code></pre></div>
<ul>
<li>to remove elements == 3,
</ul>
<div class=sourceCode  id=cb61 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb61-1 ><a href="#cb61-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >auto</span> v4 <span class=op >=</span> v<span class=op >;</span></span>
<span id=cb61-2 ><a href="#cb61-2" aria-hidden=true  tabindex=-1 ></a><span class=kw >auto</span> endv4 <span class=op >=</span> <span class=bu >std::</span>remove_if<span class=op >(</span>begin<span class=op >(</span>v4<span class=op >),</span> end<span class=op >(</span>v4<span class=op >),</span> <span class=op >[](</span><span class=dt >int</span> elem<span class=op >)</span> <span class=op >{</span><span class=cf >return</span> <span class=op >(</span>elem <span class=op >==</span> <span class=dv >3</span><span class=op >)};</span> <span class=op >);</span></span>
<span id=cb61-3 ><a href="#cb61-3" aria-hidden=true  tabindex=-1 ></a>v4<span class=op >.</span>erase<span class=op >(</span>endv4<span class=op >,</span> end<span class=op >(</span>v4<span class=op >));</span> <span class=co >// or even v4.erase(std::remove_if(...));</span></span></code></pre></div>
<ul>
<li>if you use functional style, you can replace <code>vector&lt;int&gt; v -&gt; list&lt;int&gt; v</code>, (you don‚Äôt have [] in lists)
<li>counting all of something
</ul>
<div class=sourceCode  id=cb62 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb62-1 ><a href="#cb62-1" aria-hidden=true  tabindex=-1 ></a><span class=dt >bool</span> allpositive <span class=op >=</span> <span class=bu >std::</span>all_of<span class=op >(</span>begin<span class=op >(</span>v4<span class=op >),</span> end<span class=op >(</span>v4<span class=op >),</span> <span class=op >[](</span><span class=dt >int</span> elem<span class=op >)</span> <span class=op >{</span> <span class=cf >return</span> elem <span class=op >&gt;=</span> <span class=dv >0</span><span class=op >;</span> <span class=op >});</span></span></code></pre></div>
<ul>
<li>ermahgerd <code>sort(v4)</code> finally exists in g++20!!!!
<li><code>g++ -std=c++20 numbers.cpp</code> to get things to work‚Ä¶
<li><code>auto letter = find(begin(v4), end(v4), 'a');</code>
<li>try/catch: put most specific errors first, use <code>std::invalid_argument("foo")</code>, <code>catch (exception&amp; e) { cout &lt;&lt; e.what(); }</code>
<li>do this, not <code>auto x = new X(Stuff); delete x</code>
</ul>
<div class=sourceCode  id=cb63 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb63-1 ><a href="#cb63-1" aria-hidden=true  tabindex=-1 ></a><span class=cf >try</span> <span class=op >{</span></span>
<span id=cb63-2 ><a href="#cb63-2" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >auto</span> x <span class=op >=</span> make_unique<span class=op >&lt;</span>X<span class=op >&gt;(</span>Stuff<span class=op >);</span></span>
<span id=cb63-3 ><a href="#cb63-3" aria-hidden=true  tabindex=-1 ></a>    <span class=co >// risky stuff</span></span>
<span id=cb63-4 ><a href="#cb63-4" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<ul>
<li><code>constexpr</code> is evaluated at compile time
<li>range for statements:
</ul>
<div class=sourceCode  id=cb64 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb64-1 ><a href="#cb64-1" aria-hidden=true  tabindex=-1 ></a><span class=cf >for</span> <span class=op >(</span><span class=kw >auto</span> i <span class=op >:</span> v<span class=op >)</span></span>
<span id=cb64-2 ><a href="#cb64-2" aria-hidden=true  tabindex=-1 ></a><span class=cf >for</span> <span class=op >(</span><span class=kw >auto</span> x <span class=op >:</span> <span class=op >{</span><span class=dv >10</span><span class=op >,</span> <span class=dv >20</span><span class=op >,</span> <span class=dv >30</span><span class=op >})</span></span>
<span id=cb64-3 ><a href="#cb64-3" aria-hidden=true  tabindex=-1 ></a><span class=cf >for</span> <span class=op >(</span><span class=kw >auto</span><span class=op >&amp;</span> x <span class=op >:</span> v<span class=op >)</span> <span class=co >//refers, doesn&#39;t modify</span></span></code></pre></div>
<ul>
<li><code>while (p)</code>, works until pointer is null - UGH
<li><code>x.name</code> accesses the struct <code>x</code> field <code>name</code> through reference and <code>x-&gt;name</code> trough the pointer. Huh?
<li><code>static_assert</code> exists
<li>virtual syntax is <code>= 0</code>, means <code>may be redefined later in a class derived from this one</code>.
</ul>
<div class=sourceCode  id=cb65 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb65-1 ><a href="#cb65-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >class</span> Container <span class=op >{</span></span>
<span id=cb65-2 ><a href="#cb65-2" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >public</span><span class=op >:</span></span>
<span id=cb65-3 ><a href="#cb65-3" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >virtual</span> <span class=dt >double</span><span class=op >&amp;</span> <span class=kw >operator</span><span class=op >[](</span><span class=dt >int</span><span class=op >)</span> <span class=op >=</span> <span class=dv >0</span><span class=op >;</span><span class=co >//pure virtual function</span></span>
<span id=cb65-4 ><a href="#cb65-4" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >virtual</span> <span class=dt >int</span> size<span class=op >()</span> <span class=at >const</span> <span class=op >=</span> <span class=dv >0</span><span class=op >;</span><span class=co >//const member function (¬ß4.2.1)</span></span>
<span id=cb65-5 ><a href="#cb65-5" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >virtual</span>  ÃÉContainer<span class=op >()</span> <span class=op >{}</span> <span class=co >//destructor (¬ß4.2.2)};</span></span>
<span id=cb65-6 ><a href="#cb65-6" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<ul>
<li><code>:public</code> can be read as ‚Äúis a subtype of‚Äù
<li>Essential operations
</ul>
<div class=sourceCode  id=cb66 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb66-1 ><a href="#cb66-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >class</span> X <span class=op >{</span></span>
<span id=cb66-2 ><a href="#cb66-2" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >public</span><span class=op >:</span></span>
<span id=cb66-3 ><a href="#cb66-3" aria-hidden=true  tabindex=-1 ></a>        X<span class=op >(</span>Sometype<span class=op >);</span>                    <span class=co >//ordinar y constructor: create an object</span></span>
<span id=cb66-4 ><a href="#cb66-4" aria-hidden=true  tabindex=-1 ></a>        X<span class=op >();</span>                            <span class=co >//default constructor</span></span>
<span id=cb66-5 ><a href="#cb66-5" aria-hidden=true  tabindex=-1 ></a>        X<span class=op >(</span><span class=at >const</span> X<span class=op >&amp;);</span>                    <span class=co >//copy constr uctor</span></span>
<span id=cb66-6 ><a href="#cb66-6" aria-hidden=true  tabindex=-1 ></a>        X<span class=op >(</span>X<span class=op >&amp;&amp;);</span>                         <span class=co >//move constr uctor</span></span>
<span id=cb66-7 ><a href="#cb66-7" aria-hidden=true  tabindex=-1 ></a>        X<span class=op >&amp;</span> <span class=kw >operator</span><span class=op >=(</span><span class=at >const</span> X<span class=op >&amp;);</span>         <span class=co >//copy assignment: clean up target and copy</span></span>
<span id=cb66-8 ><a href="#cb66-8" aria-hidden=true  tabindex=-1 ></a>        X<span class=op >&amp;</span> <span class=kw >operator</span><span class=op >=(</span>X<span class=op >&amp;&amp;);</span>              <span class=co >//move assignment: clean up target and move</span></span>
<span id=cb66-9 ><a href="#cb66-9" aria-hidden=true  tabindex=-1 ></a>        ÃÉX<span class=op >();</span>                            <span class=co >//destr uctor: clean up</span></span>
<span id=cb66-10 ><a href="#cb66-10" aria-hidden=true  tabindex=-1 ></a>        <span class=co >//...</span></span>
<span id=cb66-11 ><a href="#cb66-11" aria-hidden=true  tabindex=-1 ></a>        <span class=co >//Y(const) //</span></span>
<span id=cb66-12 ><a href="#cb66-12" aria-hidden=true  tabindex=-1 ></a><span class=op >};</span></span></code></pre></div>
<p>pg 53 of Tour of Cpp really says talks about move semantics * soruce of an assignment * an object initializer * as a func arg * as a func return value * as an exception - drop objects at end of scopes == RAII - move/copy and be suppresed with <code>Shape&amp; operator=(Shape&amp;&amp;) = delete;</code> + friends on pg 55 - TEMPLATES!</p>
<div class=sourceCode  id=cb67 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb67-1 ><a href="#cb67-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >template</span> <span class=op >&lt;</span><span class=kw >typename</span> T<span class=op >&gt;</span></span>
<span id=cb67-2 ><a href="#cb67-2" aria-hidden=true  tabindex=-1 ></a><span class=kw >class</span> Vector <span class=op >{</span></span>
<span id=cb67-3 ><a href="#cb67-3" aria-hidden=true  tabindex=-1 ></a><span class=kw >private</span><span class=op >:</span></span>
<span id=cb67-4 ><a href="#cb67-4" aria-hidden=true  tabindex=-1 ></a>    T<span class=op >*</span> elem<span class=op >;</span></span>
<span id=cb67-5 ><a href="#cb67-5" aria-hidden=true  tabindex=-1 ></a>    <span class=dt >int</span> sz<span class=op >;</span></span>
<span id=cb67-6 ><a href="#cb67-6" aria-hidden=true  tabindex=-1 ></a><span class=kw >public</span><span class=op >:</span></span>
<span id=cb67-7 ><a href="#cb67-7" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >explicit</span> Vector<span class=op >(</span><span class=dt >int</span> s<span class=op >);</span>    <span class=co >//constructor, establish invariant, acquire resources</span></span>
<span id=cb67-8 ><a href="#cb67-8" aria-hidden=true  tabindex=-1 ></a>    <span class=op >~</span>Vector<span class=op >()</span> <span class=op >{</span><span class=kw >delete</span><span class=op >[]</span> elem<span class=op >;}</span> <span class=co >//destructor, release resources</span></span>
<span id=cb67-9 ><a href="#cb67-9" aria-hidden=true  tabindex=-1 ></a>    <span class=co >//copy+move ops</span></span>
<span id=cb67-10 ><a href="#cb67-10" aria-hidden=true  tabindex=-1 ></a>    T<span class=op >*</span> <span class=kw >operator</span><span class=op >[](</span><span class=dt >int</span> n<span class=op >);</span></span>
<span id=cb67-11 ><a href="#cb67-11" aria-hidden=true  tabindex=-1 ></a>    <span class=at >const</span> T<span class=op >&amp;</span> <span class=kw >operator</span><span class=op >[](</span><span class=dt >int</span> i<span class=op >)</span> <span class=at >const</span><span class=op >;</span></span>
<span id=cb67-12 ><a href="#cb67-12" aria-hidden=true  tabindex=-1 ></a>    <span class=dt >int</span> size<span class=op >()</span> <span class=at >const</span> <span class=op >{</span><span class=cf >return</span> sz<span class=op >;}</span></span>
<span id=cb67-13 ><a href="#cb67-13" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<p>This is also possible:</p>
<div class=sourceCode  id=cb68 ><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id=cb68-1 ><a href="#cb68-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >template</span> <span class=op >&lt;</span><span class=kw >typename</span> T<span class=op >,</span> <span class=dt >int</span> N<span class=op >&gt;</span></span>
<span id=cb68-2 ><a href="#cb68-2" aria-hidden=true  tabindex=-1 ></a><span class=kw >struct</span> Buffer <span class=op >{</span></span>
<span id=cb68-3 ><a href="#cb68-3" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >using</span> <span class=dt >value_type</span> <span class=op >=</span> T<span class=op >;</span></span>
<span id=cb68-4 ><a href="#cb68-4" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >constexpr</span> <span class=dt >int</span> size<span class=op >()</span> <span class=op >{</span> <span class=cf >return</span> N<span class=op >:</span> <span class=op >}</span></span>
<span id=cb68-5 ><a href="#cb68-5" aria-hidden=true  tabindex=-1 ></a><span class=co >//...</span></span>
<span id=cb68-6 ><a href="#cb68-6" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<ul>
<li>You can create function objects/closures! <code>it(n)</code> pg 64
<li>add <code>override</code> after virtual ops, type your enmus, default value inits structs <code>int value = 5</code>,
</ul>
<ol start=165  type=1 >
<li>Rust tips: Finally found a decent SIMD tutorial for Rust! I learned that ISCP is a C SIMD dialect to get super optimal performance. Instead of their Hello world, we can try doing something like this:
</ol>
<div class=sourceCode  id=cb69 ><pre class="sourceCode rust"><code class="sourceCode rust"><span id=cb69-1 ><a href="#cb69-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >pub</span> <span class=kw >fn</span> dotp(x<span class=op >:</span> <span class=op >&amp;</span>[<span class=dt >f32</span>]<span class=op >,</span> y<span class=op >:</span> <span class=op >&amp;</span>[<span class=dt >f32</span>]<span class=op >,</span> z<span class=op >:</span> <span class=op >&amp;</span><span class=kw >mut</span> [<span class=dt >f32</span>]) <span class=op >{</span></span>
<span id=cb69-2 ><a href="#cb69-2" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >let</span> n <span class=op >=</span> <span class=dv >1024</span><span class=op >;</span> <span class=co >// or let n = x.len();</span></span>
<span id=cb69-3 ><a href="#cb69-3" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >let</span> (x<span class=op >,</span> y<span class=op >,</span> z) <span class=op >=</span> (<span class=op >&amp;</span>x[<span class=op >..</span>n]<span class=op >,</span> <span class=op >&amp;</span>y[<span class=op >..</span>n]<span class=op >,</span> <span class=op >&amp;</span><span class=kw >mut</span> z[<span class=op >..</span>n])<span class=op >;</span></span>
<span id=cb69-4 ><a href="#cb69-4" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >for</span> i <span class=kw >in</span> <span class=dv >0</span><span class=op >..</span>n <span class=op >{</span></span>
<span id=cb69-5 ><a href="#cb69-5" aria-hidden=true  tabindex=-1 ></a>        z[i] <span class=op >=</span> x[i]<span class=op >.</span>mul_add(y[i]<span class=op >,</span> z[i])<span class=op >;</span></span>
<span id=cb69-6 ><a href="#cb69-6" aria-hidden=true  tabindex=-1 ></a>    <span class=op >}</span></span>
<span id=cb69-7 ><a href="#cb69-7" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<p>that exploits the <code>x.len()</code> to pass that info to LLVM for more optims. ### 05/06/2021</p>
<ol start=162  type=1 >
<li><a href="https://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html">Introduction to Undefined Behaviour</a> and a blog post by <a href="https://blog.regehr.org/archives/213">John Regehr</a> - time to grok some of this nonsense.
</ol>
<ul>
<li><code>for(int i = 0; i &lt;= N; i++) {...}</code> if overflow is UB, then the compiler can assume the loop stops in at most <code>N+1</code> iterations (because if <code>N == INT_MAX</code>, the loop may be infinite!)
<li>Oh damn, the first post is by Chris Lattner, author of LLVM o.0
</ul>
<ol start=163  type=1 >
<li><code>@agustinc3301</code> kindly helped me setup Cloudflare analytics on my Franklin.jl blog. It‚Äôs free and quick! You verify your account after signing up and then add the link to your Franklin footer in <code>_layout/foot.html</code> and <code>page_foot.html</code> (I think.). That did it! Now I can see redditors accessing the <code>Julia To Rust</code> post üîé
</ol>
<h3 id=section-32 >04/06/2021</h3>
<ol start=159  type=1 >
<li><code>Jubilee</code> recommends capturing mutation to smaller scopes in Rust instead of the C-ish idiom of mutation everywhere:
</ol>
<div class=sourceCode  id=cb70 ><pre class="sourceCode rust"><code class="sourceCode rust"><span id=cb70-1 ><a href="#cb70-1" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >let</span> <span class=kw >mut</span> i <span class=op >=</span> <span class=dv >0</span><span class=op >;</span></span>
<span id=cb70-2 ><a href="#cb70-2" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >while</span> i <span class=op >&lt;</span> N <span class=op >{</span></span>
<span id=cb70-3 ><a href="#cb70-3" aria-hidden=true  tabindex=-1 ></a>        <span class=kw >let</span> d2s <span class=op >=</span> <span class=pp >f64x2::</span>from_array([</span>
<span id=cb70-4 ><a href="#cb70-4" aria-hidden=true  tabindex=-1 ></a>            (r[i] <span class=op >*</span> r[i])<span class=op >.</span>horizontal_sum()<span class=op >,</span></span>
<span id=cb70-5 ><a href="#cb70-5" aria-hidden=true  tabindex=-1 ></a>            (r[i <span class=op >+</span> <span class=dv >1</span>] <span class=op >*</span> r[i <span class=op >+</span> <span class=dv >1</span>])<span class=op >.</span>horizontal_sum()<span class=op >,</span></span>
<span id=cb70-6 ><a href="#cb70-6" aria-hidden=true  tabindex=-1 ></a>        ])<span class=op >;</span></span>
<span id=cb70-7 ><a href="#cb70-7" aria-hidden=true  tabindex=-1 ></a>        <span class=kw >let</span> dmags <span class=op >=</span> <span class=pp >f64x2::</span>splat(dt) <span class=op >/</span> (d2s <span class=op >*</span> d2s<span class=op >.</span>sqrt())<span class=op >;</span></span>
<span id=cb70-8 ><a href="#cb70-8" aria-hidden=true  tabindex=-1 ></a>        mag[i] <span class=op >=</span> dmags[<span class=dv >0</span>]<span class=op >;</span></span>
<span id=cb70-9 ><a href="#cb70-9" aria-hidden=true  tabindex=-1 ></a>        mag[i <span class=op >+</span> <span class=dv >1</span>] <span class=op >=</span> dmags[<span class=dv >1</span>]<span class=op >;</span></span>
<span id=cb70-10 ><a href="#cb70-10" aria-hidden=true  tabindex=-1 ></a>        i <span class=op >+=</span> <span class=dv >2</span><span class=op >;</span></span>
<span id=cb70-11 ><a href="#cb70-11" aria-hidden=true  tabindex=-1 ></a>    <span class=op >}</span></span></code></pre></div>
<p>Can be converted to</p>
<div class=sourceCode  id=cb71 ><pre class="sourceCode rust"><code class="sourceCode rust"><span id=cb71-1 ><a href="#cb71-1" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >for</span> i <span class=kw >in</span> (<span class=dv >0</span><span class=op >..</span>N)<span class=op >.</span>step_by(<span class=dv >2</span>) <span class=op >{</span></span>
<span id=cb71-2 ><a href="#cb71-2" aria-hidden=true  tabindex=-1 ></a>        <span class=kw >let</span> d2s <span class=op >=</span> <span class=pp >f64x2::</span>from_array([</span>
<span id=cb71-3 ><a href="#cb71-3" aria-hidden=true  tabindex=-1 ></a>            (r[i] <span class=op >*</span> r[i])<span class=op >.</span>horizontal_sum()<span class=op >,</span></span>
<span id=cb71-4 ><a href="#cb71-4" aria-hidden=true  tabindex=-1 ></a>            (r[i <span class=op >+</span> <span class=dv >1</span>] <span class=op >*</span> r[i <span class=op >+</span> <span class=dv >1</span>])<span class=op >.</span>horizontal_sum()<span class=op >,</span></span>
<span id=cb71-5 ><a href="#cb71-5" aria-hidden=true  tabindex=-1 ></a>        ])<span class=op >;</span></span>
<span id=cb71-6 ><a href="#cb71-6" aria-hidden=true  tabindex=-1 ></a>        <span class=kw >let</span> dmags <span class=op >=</span> <span class=pp >f64x2::</span>splat(dt) <span class=op >/</span> (d2s <span class=op >*</span> d2s<span class=op >.</span>sqrt())<span class=op >;</span></span>
<span id=cb71-7 ><a href="#cb71-7" aria-hidden=true  tabindex=-1 ></a>        mag[i] <span class=op >=</span> dmags[<span class=dv >0</span>]<span class=op >;</span></span>
<span id=cb71-8 ><a href="#cb71-8" aria-hidden=true  tabindex=-1 ></a>        mag[i <span class=op >+</span> <span class=dv >1</span>] <span class=op >=</span> dmags[<span class=dv >1</span>]<span class=op >;</span></span>
<span id=cb71-9 ><a href="#cb71-9" aria-hidden=true  tabindex=-1 ></a>    <span class=op >}</span></span></code></pre></div>
<ol start=160  type=1 >
<li>To run <code>cargo watch</code> on a non-standard file, use <code>cargo watch -c -x "run --examples dot_product"</code>. Credit to <code>Lokathor</code>.
<li>Finally got the code working for the <code>dot_product.rs</code>! in the end, it wasn‚Äôt so scary:
</ol>
<div class=sourceCode  id=cb72 ><pre class="sourceCode rust"><code class="sourceCode rust"><span id=cb72-1 ><a href="#cb72-1" aria-hidden=true  tabindex=-1 ></a><span class=at >#![</span>feature<span class=at >(</span>array_chunks<span class=at >)]</span> <span class=co >// gotta have this</span></span>
<span id=cb72-2 ><a href="#cb72-2" aria-hidden=true  tabindex=-1 ></a><span class=kw >fn</span> dot(a<span class=op >:</span> <span class=op >&amp;</span>[<span class=dt >f32</span>]<span class=op >,</span> b<span class=op >:</span> <span class=op >&amp;</span>[<span class=dt >f32</span>]) <span class=op >-&gt;</span> <span class=dt >f32</span> <span class=op >{</span></span>
<span id=cb72-3 ><a href="#cb72-3" aria-hidden=true  tabindex=-1 ></a>    a<span class=op >.</span><span class=pp >array_chunks::</span><span class=op >&lt;</span><span class=dv >4</span><span class=op >&gt;</span>() <span class=co >// el paso de la muerte</span></span>
<span id=cb72-4 ><a href="#cb72-4" aria-hidden=true  tabindex=-1 ></a>    <span class=op >.</span>map(<span class=op >|&amp;</span>a<span class=op >|</span> <span class=pp >f32x::</span>from_array(a))</span>
<span id=cb72-5 ><a href="#cb72-5" aria-hidden=true  tabindex=-1 ></a>    <span class=op >.</span>zip(b<span class=op >.</span><span class=pp >array_chunks::</span><span class=op >&lt;</span><span class=dv >4</span><span class=op >&gt;</span>()<span class=op >.</span>map(<span class=op >|&amp;</span>b<span class=op >|</span> <span class=pp >f32x4::</span>from_array(b))) <span class=co >// so aside form some ugly conversions all is peachy</span></span>
<span id=cb72-6 ><a href="#cb72-6" aria-hidden=true  tabindex=-1 ></a>    <span class=op >.</span>map(<span class=op >|</span>(a<span class=op >,</span>b)<span class=op >|</span> (a <span class=op >*</span> b)<span class=op >.</span>horizontal_sum())</span>
<span id=cb72-7 ><a href="#cb72-7" aria-hidden=true  tabindex=-1 ></a>    <span class=op >.</span>sum()</span>
<span id=cb72-8 ><a href="#cb72-8" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<h3 id=section-33 >03/06/2021</h3>
<ol start=155  type=1 >
<li>Rust syntax for updating structs with <code>..other_struct</code> is very neat.
<li><code>if let Some(word) = ... {}</code>
<li><code>while let Some(Some(word)) = ... {}</code>
<li><code>cargo watch -c</code> is very useful for seeing how you‚Äôre code is going! Credit to <code>Lokathor</code> for the <code>-c</code> flag.
</ol>
<h3 id=section-34 >31/05/2021</h3>
<ol start=152  type=1 >
<li><code>make -C debug</code> julia builds are much faster to build because you are not optimizing anymore - hat tip to Jameson Nash for that.
<li>LLVM trap is what calls unreachable - tells the runtime that this should never happen. Basically checking that codegen didn‚Äôt screw up.
<li><code>git add -u</code>
</ol>
<h3 id=section-35 >30/05/2021</h3>
<ol start=151  type=1 >
<li>Finally got the hang of the Rust <code>dbg!</code> macro:
</ol>
<div class=sourceCode  id=cb73 ><pre class="sourceCode rust"><code class="sourceCode rust"><span id=cb73-1 ><a href="#cb73-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >let</span> a <span class=op >=</span> <span class=dv >2</span><span class=op >;</span></span>
<span id=cb73-2 ><a href="#cb73-2" aria-hidden=true  tabindex=-1 ></a><span class=kw >let</span> b <span class=op >=</span> <span class=pp >dbg!</span>(a <span class=op >*</span> <span class=dv >2</span>) <span class=op >+</span> <span class=dv >1</span><span class=op >;</span></span>
<span id=cb73-3 ><a href="#cb73-3" aria-hidden=true  tabindex=-1 ></a><span class=co >//      ^-- prints: [src/main.rs:2] a * 2 = 4</span></span>
<span id=cb73-4 ><a href="#cb73-4" aria-hidden=true  tabindex=-1 ></a><span class=pp >assert_eq!</span>(b<span class=op >,</span> <span class=dv >5</span>)<span class=op >;</span></span></code></pre></div>
<p>Very useful for the competitive problems debugging!</p>
<h3 id=section-36 >27/05/2021</h3>
<ol start=145  type=1 >
<li>Finally got around to the <code>nucleotide</code> in Rust exercism. My solution was a bit C-ish, this is neater: (Credits to <code>azymohliad</code>, but with no <code>Err</code>)
</ol>
<div class=sourceCode  id=cb74 ><pre class="sourceCode rust"><code class="sourceCode rust"><span id=cb74-1 ><a href="#cb74-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >fn</span> count(c<span class=op >:</span><span class=dt >char</span><span class=op >,</span> dna<span class=op >:</span> <span class=op >&amp;</span><span class=dt >str</span>) <span class=op >-&gt;</span> <span class=dt >usize</span> <span class=op >{</span></span>
<span id=cb74-2 ><a href="#cb74-2" aria-hidden=true  tabindex=-1 ></a>    dna<span class=op >.</span>chars()<span class=op >.</span>filter(<span class=op >|&amp;</span>x<span class=op >|</span> x <span class=op >==</span> c)<span class=op >.</span>count()</span>
<span id=cb74-3 ><a href="#cb74-3" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span>
<span id=cb74-4 ><a href="#cb74-4" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb74-5 ><a href="#cb74-5" aria-hidden=true  tabindex=-1 ></a><span class=kw >fn</span> nucleotide_counts(dna<span class=op >:</span> <span class=op >&amp;</span><span class=dt >str</span>) <span class=op >-&gt;</span> HashMap<span class=op >&lt;</span><span class=dt >char</span><span class=op >,</span> <span class=dt >usize</span><span class=op >&gt;</span> <span class=op >{</span></span>
<span id=cb74-6 ><a href="#cb74-6" aria-hidden=true  tabindex=-1 ></a>    <span class=st >&quot;ACGT&quot;</span><span class=op >.</span>chars()<span class=op >.</span>map(<span class=op >|</span>c<span class=op >|</span> (c<span class=op >,</span> count(c<span class=op >,</span> dna)))<span class=op >.</span>collect()</span>
<span id=cb74-7 ><a href="#cb74-7" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<p>Another clever initialization trick by <code>jtmueller</code>:</p>
<div class=sourceCode  id=cb75 ><pre class="sourceCode rust"><code class="sourceCode rust"><span id=cb75-1 ><a href="#cb75-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >let</span> <span class=kw >mut</span> counts<span class=op >:</span> HashMap<span class=op >&lt;</span><span class=dt >char</span><span class=op >,</span> <span class=dt >usize</span><span class=op >&gt;</span> <span class=op >=</span> [<span class=ch >&#39;A&#39;</span><span class=op >,</span> <span class=ch >&#39;C&#39;</span><span class=op >,</span> <span class=ch >&#39;T&#39;</span><span class=op >,</span> <span class=ch >&#39;G&#39;</span>]<span class=op >.</span>iter()<span class=op >.</span>map(<span class=op >|</span>n<span class=op >|</span> (<span class=op >*</span>n<span class=op >,</span> <span class=dv >0</span>))<span class=op >.</span>collect()<span class=op >;</span></span></code></pre></div>
<p>Probs worth using <code>HashMap::with_capacity(4)</code> since I know there‚Äôs only <code>ACTG</code> as keys.</p>
<ol start=147  type=1 >
<li><p>Rust: <code>use enum::*;</code>, and then you don‚Äôt need to <code>enum::foo</code> all over your match arms!</p>
<li><p>I learned about the <code>slice.windows(2)</code> function in the <code>sublist</code> exercise, <a href="https://doc.rust-lang.org/std/primitive.slice.html#method.windows">link here</a></p>
</ol>
<div class=sourceCode  id=cb76 ><pre class="sourceCode rust"><code class="sourceCode rust"><span id=cb76-1 ><a href="#cb76-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >let</span> slice <span class=op >=</span> [<span class=ch >&#39;r&#39;</span><span class=op >,</span> <span class=ch >&#39;u&#39;</span><span class=op >,</span> <span class=ch >&#39;s&#39;</span><span class=op >,</span> <span class=ch >&#39;t&#39;</span>]<span class=op >;</span></span>
<span id=cb76-2 ><a href="#cb76-2" aria-hidden=true  tabindex=-1 ></a><span class=kw >let</span> <span class=kw >mut</span> iter <span class=op >=</span> slice<span class=op >.</span>windows(<span class=dv >2</span>)<span class=op >;</span></span>
<span id=cb76-3 ><a href="#cb76-3" aria-hidden=true  tabindex=-1 ></a><span class=pp >assert_eq!</span>(iter<span class=op >.</span>next()<span class=op >.</span>unwrap()<span class=op >,</span> <span class=op >&amp;</span>[<span class=ch >&#39;r&#39;</span><span class=op >,</span> <span class=ch >&#39;u&#39;</span>])<span class=op >;</span></span>
<span id=cb76-4 ><a href="#cb76-4" aria-hidden=true  tabindex=-1 ></a><span class=pp >assert_eq!</span>(iter<span class=op >.</span>next()<span class=op >.</span>unwrap()<span class=op >,</span> <span class=op >&amp;</span>[<span class=ch >&#39;u&#39;</span><span class=op >,</span> <span class=ch >&#39;s&#39;</span>])<span class=op >;</span></span>
<span id=cb76-5 ><a href="#cb76-5" aria-hidden=true  tabindex=-1 ></a><span class=pp >assert_eq!</span>(iter<span class=op >.</span>next()<span class=op >.</span>unwrap()<span class=op >,</span> <span class=op >&amp;</span>[<span class=ch >&#39;s&#39;</span><span class=op >,</span> <span class=ch >&#39;t&#39;</span>])<span class=op >;</span></span>
<span id=cb76-6 ><a href="#cb76-6" aria-hidden=true  tabindex=-1 ></a><span class=pp >assert!</span>(iter<span class=op >.</span>next()<span class=op >.</span>is_none())<span class=op >;</span></span></code></pre></div>
<ol start=149  type=1 >
<li><p>Difference between <code>show</code> and <code>print</code>: <code>print</code> uses quotes around the string, <code>show</code> doesn‚Äôt, and this</p>
<li><p>Rust: <code>map.entry(letter).or_insert(0)) += 1</code></p>
</ol>
<h3 id=section-37 >26/05/2021</h3>
<ol start=144  type=1 >
<li>FINALLY GOT THE ASSEMBLY HELLO WORLD TO WORK!
</ol>
<ul>
<li>I had to disable the <code>stdfaxh.h</code> whatever
<li>This was the final command:
</ul>
<div class=sourceCode  id=cb77 ><pre class="sourceCode bash"><code class="sourceCode bash"><span id=cb77-1 ><a href="#cb77-1" aria-hidden=true  tabindex=-1 ></a><span class=ex >$</span> nasm <span class=at >-g</span> <span class=at >-f</span> elf64 hello.asm</span>
<span id=cb77-2 ><a href="#cb77-2" aria-hidden=true  tabindex=-1 ></a><span class=ex >$</span> g++ hello.cpp hello.o</span>
<span id=cb77-3 ><a href="#cb77-3" aria-hidden=true  tabindex=-1 ></a><span class=ex >$</span> ./a.out</span></code></pre></div>
<ul>
<li>and the assembly file was:
</ul>
<div class=sourceCode  id=cb78 ><pre class="sourceCode asm"><code class="sourceCode fasm"><span id=cb78-1 ><a href="#cb78-1" aria-hidden=true  tabindex=-1 ></a><span class=co >;-------------------------------------------------</span></span>
<span id=cb78-2 ><a href="#cb78-2" aria-hidden=true  tabindex=-1 ></a><span class=co >;               Ch02_01.asm</span></span>
<span id=cb78-3 ><a href="#cb78-3" aria-hidden=true  tabindex=-1 ></a><span class=co >;-------------------------------------------------</span></span>
<span id=cb78-4 ><a href="#cb78-4" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb78-5 ><a href="#cb78-5" aria-hidden=true  tabindex=-1 ></a><span class=co >; extern &quot;C&quot; int IntegerAddSub_(int a, int b, int c, int d);</span></span>
<span id=cb78-6 ><a href="#cb78-6" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb78-7 ><a href="#cb78-7" aria-hidden=true  tabindex=-1 ></a><span class=co >;        .code</span></span>
<span id=cb78-8 ><a href="#cb78-8" aria-hidden=true  tabindex=-1 ></a><span class=co >;IntegerAddSub_ proc</span></span>
<span id=cb78-9 ><a href="#cb78-9" aria-hidden=true  tabindex=-1 ></a>    global IntegerAddSub_         </span>
<span id=cb78-10 ><a href="#cb78-10" aria-hidden=true  tabindex=-1 ></a>    <span class=bu >section</span> <span class=op >.</span>text</span>
<span id=cb78-11 ><a href="#cb78-11" aria-hidden=true  tabindex=-1 ></a><span class=co >; Calculate a + b + c - d</span></span>
<span id=cb78-12 ><a href="#cb78-12" aria-hidden=true  tabindex=-1 ></a><span class=fu >IntegerAddSub_:</span></span>
<span id=cb78-13 ><a href="#cb78-13" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >mov</span> <span class=kw >eax</span><span class=op >,</span><span class=kw >ecx</span>                         <span class=co >;eax = a</span></span>
<span id=cb78-14 ><a href="#cb78-14" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >add</span> <span class=kw >eax</span><span class=op >,</span><span class=kw >edx</span>                         <span class=co >;eax = a + b</span></span>
<span id=cb78-15 ><a href="#cb78-15" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >add</span> <span class=kw >eax</span><span class=op >,</span>r8d                         <span class=co >;eax = a + b + c</span></span>
<span id=cb78-16 ><a href="#cb78-16" aria-hidden=true  tabindex=-1 ></a>        <span class=bu >sub</span> <span class=kw >eax</span><span class=op >,</span>r9d                         <span class=co >;eax = a + b + c - d</span></span>
<span id=cb78-17 ><a href="#cb78-17" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb78-18 ><a href="#cb78-18" aria-hidden=true  tabindex=-1 ></a>        <span class=cf >ret</span>                                 <span class=co >;return result to caller</span></span>
<span id=cb78-19 ><a href="#cb78-19" aria-hidden=true  tabindex=-1 ></a><span class=co >;IntegerAddSub_ endp</span></span>
<span id=cb78-20 ><a href="#cb78-20" aria-hidden=true  tabindex=-1 ></a><span class=co >;        end</span></span></code></pre></div>
<ul>
<li>So I just had to add the <code>global IntegerAddSub_</code>, <code>section .text</code> below that, the name of the function as a section, and the last <code>ret</code> to follow <code>nasm</code> conventions.
<li>if using extern variables, use <code>extern g_val</code>, and then <code>default rel</code>
</ul>
<h3 id=section-38 >24/05/2021</h3>
<ol start=138  type=1 >
<li><p>Made a 3D print of dispatch with my sister. It was an awesome birthday.</p>
<li><p>Got DoctorDocstrings.jl Poster and Rubin.jl Lightning talk accepted to JuliaCon! Now to work on those asap‚Ä¶</p>
<li><p>Got the Kusswurm <code>Modern x86 Assembly Language Programming</code> and Min-Yih Hsu <code>LLVM Techniques</code> books in the mail now‚Ä¶</p>
<li><p>Should write down the Next steps for MMTK - a written down goal is usually an easier one.</p>
<li><p>üöÄ üíÉ To setup emojis, we can insert with <code>SPC i e</code>, but the line editor gets a bit funky‚Ä¶?</p>
<li><p>Found this incredibly useful <a href="https://gist.github.com/hjertnes/9e14416e8962ff5f03c6b9871945b165">Doom emacs tips</a>, and <a href="https://gist.github.com/dmsul/8bb08c686b70d5a68da0e2cb81cd857f">this vim guide</a></p>
</ol>
<h3 id=section-39 >21/05/2021</h3>
<ol start=137  type=1 >
<li>Finally remembered to setup <code>mu</code>. Let‚Äôs <a href="https://www.sastibe.de/2021/01/setting-up-emacs-as-mail-client/">see if I can finally do it‚Ä¶</a>
</ol>
<h3 id=section-40 >18/05/2021</h3>
<ol start=135  type=1 >
<li>Vim tricks from Emacs doom! RTFM to change the font to Julia mono!
</ol>
<ul>
<li><code>cc</code> in vim mode will let you change the whole line!
<li><code>C</code> changes to the end of the line!
<li><code>*</code> to highlight all copies of the word under the cursor
<li><code>~</code> to change the case of a letter, <code>[#]~</code> to change # chars after the letter under cursor. <code>g~[m]</code>, <code>gU[m]</code> <code>gu[m]</code> toggle cases with motion <code>[m]</code>
<li><code>&gt;[m]</code> to toggle case with motion <code>[m]</code>, <code>&gt;&gt;</code> to indent this line
<li><code>J</code> to move line beneath to end of this one
<li><code>gq[m]</code> format text between here and <code>[m]</code>, <code>gqq</code> formats current line
<li><em>Marks</em>: <code>ma</code> sets a mark
<li><code>'</code> and <code>''</code> to set a mark and jump back and forth between them
</ul>
<ol start=136  type=1 >
<li>Kevin Bonham is helping me figure out the Emacs tabbing situation:
</ol>
<pre><code>*Me*
Alright, I&#39;m tired of never knowing how to work buffers or tabs or windows inside my doom emacs.
Who&#39;s got a good crash course?
My ideal goal is to:

1. Be able to open multiple buffers and move between them
2. Be able to set groups of tabs with different buffers
3. Be able to &quot;restore&quot; groups of tabs when starting up emacs.

*Kevin Bonham*
I&#39;ve just been figuring this out myself...

1. SPC b b to switch buffers in the same window (assuming you&#39;ve opened them before with SPC . or something.
    SPC w J (note the capital) will move the current buffer into a new window below (can also use H, K, or L) as last arg to do left, up, or right).
    Then do the same thing but lowercase to move focus around to different windows
2. SPC TAB has all of the tab-related things. SPC TAB n does new tab, SPC TAB r renames it, SPC TAB 1 to switch to tab 1 etc.
3. SPC p has all of the &quot;project&quot; related stuff. I haven&#39;t played a lot with these, but they seem to all be linked to a directory, though I think if you have outside files open, they will re-open with the project</code></pre>
<h3 id=section-41 >17/05/2021</h3>
<ol start=134  type=1 >
<li>Wow-BOB-Wow has some nifty Rust tricks:
</ol>
<div class=sourceCode  id=cb80 ><pre class="sourceCode rust"><code class="sourceCode rust"><span id=cb80-1 ><a href="#cb80-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >pub</span> <span class=kw >fn</span> sum_of_multiples(limit<span class=op >:</span> <span class=dt >u32</span><span class=op >,</span> factors <span class=op >&amp;</span>[<span class=dt >u32</span>]) <span class=op >-&gt;</span> <span class=dt >u32</span> <span class=op >{</span></span>
<span id=cb80-2 ><a href="#cb80-2" aria-hidden=true  tabindex=-1 ></a>    (<span class=dv >1</span><span class=op >..</span>limit)<span class=op >.</span>filter(<span class=op >|</span>i<span class=op >|</span> factors<span class=op >.</span>iter()<span class=op >.</span>any(<span class=op >|</span>f<span class=op >|</span> i <span class=op >%</span> f <span class=op >==</span> <span class=dv >0</span>))<span class=op >.</span>sum()</span>
<span id=cb80-3 ><a href="#cb80-3" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<ul>
<li>For <code>perfect-numbers</code> don‚Äôt forget it might be easier to match on
</ul>
<div class=sourceCode  id=cb81 ><pre class="sourceCode rust"><code class="sourceCode rust"><span id=cb81-1 ><a href="#cb81-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >match</span> x<span class=op >.</span>cmp(n) <span class=op >{</span></span>
<span id=cb81-2 ><a href="#cb81-2" aria-hidden=true  tabindex=-1 ></a>    <span class=pp >Ordering::</span>Greater <span class=op >=&gt;</span> <span class=cn >Some</span>(<span class=pp >Classification::</span>Abundant)<span class=op >,</span></span>
<span id=cb81-3 ><a href="#cb81-3" aria-hidden=true  tabindex=-1 ></a>    <span class=op >...</span></span>
<span id=cb81-4 ><a href="#cb81-4" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<h3 id=section-42 >15/05/2021</h3>
<ol start=133  type=1 >
<li>1.7 goodies! You can destructure structs with named tuples!
</ol>
<div class=sourceCode  id=cb82 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb82-1 ><a href="#cb82-1" aria-hidden=true  tabindex=-1 ></a>(<span class=op >;</span> a<span class=op >,</span> b) <span class=op >=</span> x <span class=co ># destructures props `a` and `b` of `x`</span></span></code></pre></div>
<p>Can also be used like:</p>
<div class=sourceCode  id=cb83 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb83-1 ><a href="#cb83-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >struct</span> A</span>
<span id=cb83-2 ><a href="#cb83-2" aria-hidden=true  tabindex=-1 ></a>    x</span>
<span id=cb83-3 ><a href="#cb83-3" aria-hidden=true  tabindex=-1 ></a>    y</span>
<span id=cb83-4 ><a href="#cb83-4" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span>
<span id=cb83-5 ><a href="#cb83-5" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb83-6 ><a href="#cb83-6" aria-hidden=true  tabindex=-1 ></a>foo((<span class=op >;</span> x<span class=op >,</span> y)<span class=op >::</span>A) <span class=op >=</span> x <span class=op >+</span> y <span class=co ># ermahgerddd</span></span></code></pre></div>
<p><code>@test</code> can now be passed as an additional argument <code>skip</code> and <code>broken</code>:</p>
<div class=sourceCode  id=cb84 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb84-1 ><a href="#cb84-1" aria-hidden=true  tabindex=-1 ></a><span class=pp >@test</span> isequal(complex(one(T)) <span class=op >/</span> complex(T(<span class=cn >Inf</span>)<span class=op >,</span> T(<span class=op >-</span><span class=cn >Inf</span>))<span class=op >,</span> complex(zero(T)<span class=op >,</span> zero(T))) broken<span class=op >=</span>(T <span class=op >==</span> <span class=dt >Float64</span>)</span></code></pre></div>
<ul>
<li>You can also now iterate on a <code>RegexMatch</code> to get its captures!
<li><code>Base.@invoke f(arg1::T1, arg2::T2; kwargs...)</code> now resembles the <code>@ccall</code> syntax.
<li>Multidimiensional array syntax!
</ul>
<div class=sourceCode  id=cb85 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb85-1 ><a href="#cb85-1" aria-hidden=true  tabindex=-1 ></a>[ <span class=fl >1</span><span class=op >;</span> <span class=fl >2</span> <span class=op >;;</span> <span class=fl >3</span> <span class=op >;</span> <span class=fl >4</span> <span class=op >;;</span> <span class=fl >5</span> <span class=op >;</span> <span class=fl >6</span> <span class=op >;;;</span> <span class=fl >7</span> <span class=op >;</span> <span class=fl >8</span> <span class=op >;;</span> <span class=fl >9</span> <span class=op >;</span> <span class=fl >10</span> <span class=op >;;</span> <span class=fl >11</span> <span class=op >;</span> <span class=fl >12</span>]</span></code></pre></div>
<h3 id=section-43 >14/05/2021</h3>
<ol start=131  type=1 >
<li><p>When making a PR to BinaryBuilder.jl, search the whole repo to make sure no one has tried building <code>jemalloc</code> before :upside-down: :tada:</p>
<li><p>Julia doesn‚Äôt ship binaries yet, but <a href="https://www.ic.unicamp.br/~ra045840/bolt-cgo19.pdf">BOLT</a> could be worth looking into.</p>
</ol>
<h3 id=section-44 >13/05/2021</h3>
<ol start=129  type=1 >
<li>Micket in the Julia chat has a nice answer for: ‚ÄúHow to do this neater?‚Äù
</ol>
<div class=sourceCode  id=cb86 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb86-1 ><a href="#cb86-1" aria-hidden=true  tabindex=-1 ></a>d <span class=op >=</span> <span class=dt >Dict</span>(<span class=st >&quot;a&quot;</span> <span class=op >=&gt;</span> <span class=fl >2</span><span class=op >,</span> <span class=st >&quot;b&quot;</span> <span class=op >=&gt;</span> <span class=fl >3</span>)</span>
<span id=cb86-2 ><a href="#cb86-2" aria-hidden=true  tabindex=-1 ></a><span class=dt >Dict</span>(zip(keys(d)<span class=op >,</span> map(x <span class=op >-&gt;</span> <span class=fl >2</span>x<span class=op >,</span> values(d))))</span>
<span id=cb86-3 ><a href="#cb86-3" aria-hidden=true  tabindex=-1 ></a><span class=co ># Do this!</span></span>
<span id=cb86-4 ><a href="#cb86-4" aria-hidden=true  tabindex=-1 ></a>map<span class=op >!</span>(x <span class=op >-&gt;</span> <span class=fl >2</span>x<span class=op >,</span> values(d))</span>
<span id=cb86-5 ><a href="#cb86-5" aria-hidden=true  tabindex=-1 ></a><span class=co ># Or this!</span></span>
<span id=cb86-6 ><a href="#cb86-6" aria-hidden=true  tabindex=-1 ></a><span class=dt >Dict</span>( k <span class=op >=&gt;</span> <span class=fl >2</span>v <span class=kw >for</span> (k<span class=op >,</span> v) <span class=kw >in</span> d)</span></code></pre></div>
<ol start=130  type=1 >
<li><code>aur/julia-bin</code> is a good wrapper for Julia on Arch. Thanks Mos√®!
</ol>
<h3 id=section-45 >12/05/2021</h3>
<ol start=128  type=1 >
<li>If you append a julia Markdown bloc with <code>=</code> you get line numbers on HackMD.
</ol>
<div class=sourceCode  id=cb87 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb87-1 ><a href="#cb87-1" aria-hidden=true  tabindex=-1 ></a><span class=fl >3</span> <span class=op >+</span> <span class=fl >3</span></span></code></pre></div>
<h3 id=section-46 >11/05/2021</h3>
<ol start=123  type=1 >
<li>Fortran learnings!
<li>Fortran people <a href="https://developer.nvidia.com/blog/accelerating-fortran-do-concurrent-with-gpus-and-the-nvidia-hpc-sdk/">have nice parallelism</a> concerns.
</ol>
<div class=sourceCode  id=cb88 ><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id=cb88-1 ><a href="#cb88-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >do</span> concurrent(i <span class=kw >=</span> <span class=dv >1</span>:N)</span>
<span id=cb88-2 ><a href="#cb88-2" aria-hidden=true  tabindex=-1 ></a>    i0 <span class=kw >=</span> <span class=bu >max</span>(i <span class=kw >-</span> <span class=dv >1</span>, <span class=dv >1</span>)</span>
<span id=cb88-3 ><a href="#cb88-3" aria-hidden=true  tabindex=-1 ></a>    i1 <span class=kw >=</span> <span class=bu >min</span>(i <span class=kw >+</span> <span class=dv >1</span>, N)</span>
<span id=cb88-4 ><a href="#cb88-4" aria-hidden=true  tabindex=-1 ></a>    b(:, :, <span class=dv >1</span>) <span class=kw >=</span> <span class=fl >0.5</span> <span class=kw >*</span> (a(:, :, i0) <span class=kw >+</span> a(:, i1)) <span class=co >! array assignment</span></span>
<span id=cb88-5 ><a href="#cb88-5" aria-hidden=true  tabindex=-1 ></a><span class=kw >end do</span></span></code></pre></div>
<p>Can already be sent to Tesla GPUs o.O 2. In fortran, <code>functions</code> are <code>pure</code>, <code>subroutines</code> modify their arguments. 3. To make a struct, it probably suffices that</p>
<div class=sourceCode  id=cb89 ><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id=cb89-1 ><a href="#cb89-1" aria-hidden=true  tabindex=-1 ></a><span class=dt >type</span> <span class=dt >::</span> t_point</span>
<span id=cb89-2 ><a href="#cb89-2" aria-hidden=true  tabindex=-1 ></a>    <span class=dt >real</span> <span class=dt >::</span> x</span>
<span id=cb89-3 ><a href="#cb89-3" aria-hidden=true  tabindex=-1 ></a>    <span class=dt >real</span> <span class=dt >::</span> y</span>
<span id=cb89-4 ><a href="#cb89-4" aria-hidden=true  tabindex=-1 ></a><span class=dt >end type</span></span></code></pre></div>
<p>And you access it with</p>
<div class=sourceCode  id=cb90 ><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id=cb90-1 ><a href="#cb90-1" aria-hidden=true  tabindex=-1 ></a><span class=dt >type(t_point)</span> <span class=dt >::</span> mypoint</span>
<span id=cb90-2 ><a href="#cb90-2" aria-hidden=true  tabindex=-1 ></a>mypoint%x <span class=kw >=</span> <span class=fl >1.0</span></span>
<span id=cb90-3 ><a href="#cb90-3" aria-hidden=true  tabindex=-1 ></a>mypoint%y <span class=kw >=</span> <span class=fl >2.0</span></span></code></pre></div>
<ol start=4  type=1 >
<li>You can declare fields in the struct as <code>private, protected, allocatable[dimension], pointer, codimension, contiguous, volatile, asynchronous</code>:
</ol>
<div class=sourceCode  id=cb91 ><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id=cb91-1 ><a href="#cb91-1" aria-hidden=true  tabindex=-1 ></a><span class=dt >type</span> <span class=dt >::</span> t_example</span>
<span id=cb91-2 ><a href="#cb91-2" aria-hidden=true  tabindex=-1 ></a>    <span class=dt >integer</span>, <span class=dt >private::</span> i <span class=kw >=</span> <span class=dv >0</span> <span class=co >! hites it from use outside of the t_example scope. Default init is with i = 0</span></span>
<span id=cb91-3 ><a href="#cb91-3" aria-hidden=true  tabindex=-1 ></a>    <span class=dt >integer</span>, protected <span class=dt >::</span> i <span class=co >! allowed access, but not definition outside of the scope</span></span>
<span id=cb91-4 ><a href="#cb91-4" aria-hidden=true  tabindex=-1 ></a>    <span class=dt >real</span>, <span class=dt >allocatable</span>, <span class=dt >dimension(:)</span> <span class=dt >::</span> x</span>
<span id=cb91-5 ><a href="#cb91-5" aria-hidden=true  tabindex=-1 ></a><span class=dt >end type</span></span></code></pre></div>
<ol start=5  type=1 >
<li>You can <code>contains</code> <em>type-bound procedures</em>
</ol>
<div class=sourceCode  id=cb92 ><pre class="sourceCode fortran"><code class="sourceCode fortranfixed"><span id=cb92-1 ><a href="#cb92-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >module</span> m_shapes</span>
<span id=cb92-2 ><a href="#cb92-2" aria-hidden=true  tabindex=-1 ></a><span class=kw >implicit</span> <span class=kw >none</span></span>
<span id=cb92-3 ><a href="#cb92-3" aria-hidden=true  tabindex=-1 ></a><span class=dt >private</span></span>
<span id=cb92-4 ><a href="#cb92-4" aria-hidden=true  tabindex=-1 ></a><span class=dt >public</span> t_square</span>
<span id=cb92-5 ><a href="#cb92-5" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb92-6 ><a href="#cb92-6" aria-hidden=true  tabindex=-1 ></a><span class=dt >type</span> <span class=dt >::</span> t_square</span>
<span id=cb92-7 ><a href="#cb92-7" aria-hidden=true  tabindex=-1 ></a>    <span class=dt >real</span> <span class=dt >::</span> side</span>
<span id=cb92-8 ><a href="#cb92-8" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >contains</span></span>
<span id=cb92-9 ><a href="#cb92-9" aria-hidden=true  tabindex=-1 ></a>        <span class=kw >procedure</span> <span class=dt >::</span> area</span>
<span id=cb92-10 ><a href="#cb92-10" aria-hidden=true  tabindex=-1 ></a><span class=dt >end type</span></span>
<span id=cb92-11 ><a href="#cb92-11" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb92-12 ><a href="#cb92-12" aria-hidden=true  tabindex=-1 ></a><span class=co >contains</span></span>
<span id=cb92-13 ><a href="#cb92-13" aria-hidden=true  tabindex=-1 ></a>    <span class=dt >real</span> <span class=kw >function</span> area(self</span>
<span id=cb92-14 ><a href="#cb92-14" aria-hidden=true  tabindex=-1 ></a>    class(t_square), <span class=dt >intent(in)</span> <span class=dt >::</span> self</span>
<span id=cb92-15 ><a href="#cb92-15" aria-hidden=true  tabindex=-1 ></a>    res <span class=kw >=</span> self%side<span class=kw >**</span><span class=dv >2</span></span>
<span id=cb92-16 ><a href="#cb92-16" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >end function</span></span>
<span id=cb92-17 ><a href="#cb92-17" aria-hidden=true  tabindex=-1 ></a><span class=kw >end module</span> m_shapes</span></code></pre></div>
<ol start=124  type=1 >
<li>Peter Deffebach kindly helped me golf a really cool, <a href="https://twitter.com/miguelraz_/status/1392161937467731970">but simple task</a>:
</ol>
<div class=sourceCode  id=cb93 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb93-1 ><a href="#cb93-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >using</span> CSV<span class=op >,</span> Glob</span>
<span id=cb93-2 ><a href="#cb93-2" aria-hidden=true  tabindex=-1 ></a>fs <span class=op >=</span> CSV.File.(readdir(glob<span class=st >&quot;*.csv&quot;</span>))</span></code></pre></div>
<p>Done! You‚Äôve read all the files <code>fs</code> that are CSVs!</p>
<pre class=julia-repl ><code>julia&gt; using CSV, DataFrames, Glob;
julia&gt; files = readdir(glob&quot;*.csv&quot;);
julia&gt; reduce(vcat, CSV.read(file, DataFrame) for file in files)</code></pre>
<ol start=125  type=1 >
<li>Jacob Zelko has kindly <a href="">shared some tools for dev flow</a>:
<li>vim FloatTerm instead of vim-slime, don‚Äôt need to open a pane that way.
<li><code>:MarkDownPreview</code> with <code>iamcoo/markdown-preview.nvim</code>.
</ol>
<h3 id=section-47 >10/05/2021</h3>
<ol start=121  type=1 >
<li>Tim Besard and Valentin Churavy kindly helped me out on the Julia users GPU call (available on the julialang.org calendar). They noted a couple of good starting considerations:
<li>Try and have a function that maps to every single element in the GPU.
<li>Implementing a simple moving average is a type of convolution - there‚Äôs good tutorials on optimizing that <a href="http://alexminnaar.com/2019/07/12/implementing-convolutions-in-cuda.html">here</a> and <a href="https://developer.nvidia.com/blog/cuda-pro-tip-write-flexible-kernels-grid-stride-loops/">here</a>.
</ol>
<h3 id=section-48 >09/05/2021</h3>
<ol start=120  type=1 >
<li><code>git log -p -- path/to/file</code> will show you the commits you did to a file. Amazing!
</ol>
<h3 id=section-49 >07/05/2021</h3>
<ol start=117  type=1 >
<li>To write the Unicode Character <code>U+000A</code>, (Hat tip to Mason Protter), try this:
</ol>
<div class=sourceCode  id=cb95 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb95-1 ><a href="#cb95-1" aria-hidden=true  tabindex=-1 ></a><span class=dt >Char</span>(<span class=bn >0x000A</span>) <span class=op >|&gt;</span> clipbaord</span></code></pre></div>
<p>Thanks to Dave MacMaho, we can also do</p>
<div class=sourceCode  id=cb96 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb96-1 ><a href="#cb96-1" aria-hidden=true  tabindex=-1 ></a><span class=ch >&#39;\U1f638&#39;</span></span></code></pre></div>
<p>and get the Cat emoji :D</p>
<ol start=118  type=1 >
<li>Huh, forgot to add this nice pice of <code>@ccall</code> goodness from the <code>primecount_jll</code> stuff:
</ol>
<pre class=julia-repl ><code>julia&gt; myprimecount(x) = @ccall libprimecount.primecount_pi(x::Clonglong)::Clonglong
myprimecount (generic function with 1 method)

julia&gt; @time myprimecount(1e8)
  0.001004 seconds
5761455

julia&gt; @time myprimecount(1e14)
  0.149201 seconds
3204941750802</code></pre>
<ol start=119  type=1 >
<li>We‚Äôre dunking on the Fortran gang because they‚Äôre 8x slower on a <code>sin</code> <a href="https://fortran-lang.discourse.group/t/simple-summation-8x-slower-than-in-julia/1171/48">benchmark</a> :D I‚Äôm glad I pulled out Steven Johnsons flags to cross compile a C lib to use it with <code>@ccall</code>:
</ol>
<div class=sourceCode  id=cb98 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb98-1 ><a href="#cb98-1" aria-hidden=true  tabindex=-1 ></a>shell<span class=op >&gt;</span> ls</span>
<span id=cb98-2 ><a href="#cb98-2" aria-hidden=true  tabindex=-1 ></a>cordic.c  cordic.h  cordic.html  cordic.sh</span>
<span id=cb98-3 ><a href="#cb98-3" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb98-4 ><a href="#cb98-4" aria-hidden=true  tabindex=-1 ></a>shell<span class=op >&gt;</span> gcc <span class=op >-</span>fPIC <span class=op >-</span>O3 <span class=op >-</span>xc <span class=op >-</span>shared <span class=op >-</span>o libcordic.so cordic.c</span>
<span id=cb98-5 ><a href="#cb98-5" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb98-6 ><a href="#cb98-6" aria-hidden=true  tabindex=-1 ></a>shell<span class=op >&gt;</span> ls</span>
<span id=cb98-7 ><a href="#cb98-7" aria-hidden=true  tabindex=-1 ></a>cordic.c  cordic.h  cordic.html  cordic.sh  libcordic.so</span></code></pre></div>
<p>I pulled that from their announcement of hte Julia <a href="https://julialang.org/blog/2017/01/moredots/">broadcasting features</a> and the annex notebook <a href="https://julialang.org/assets/blog/moredots/More-Dots.ipynb">here</a>.</p>
<p>And here is how to call it:</p>
<pre class=julia-repl ><code>julia&gt; function cordic_sine(a)

          cos = Ref{Float64}(0.0)
          sin = Ref{Float64}(0.0)

          # Ref: Excellent work by John Burkardt
          # https://people.sc.fsu.edu/~jburkardt/c_src/cordic/cordic.c
          # void cossin_cordic ( double beta, int n, double *c, double *s )
          ccall((:cossin_cordic, &quot;/home/mason/cordic/libcordic.so&quot;), Cvoid, (Float64, Cint, Ref{Float64}, Ref{Float64}), a, 40, cos, sin)

          return sin[]

       end
cordic_sine (generic function with 1 method)</code></pre>
<p>Basically, don‚Äôt forget it‚Äôs the ABSOLUTE PATH!</p>
<h3 id=section-50 >06/05/2021</h3>
<ol start=116  type=1 >
<li>Simeon Schaub pulled some fancy destructuring:
</ol>
<div class=sourceCode  id=cb100 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb100-1 ><a href="#cb100-1" aria-hidden=true  tabindex=-1 ></a>x <span class=op >=</span> [<span class=fl >1</span><span class=op >,</span> <span class=fl >2</span><span class=op >,</span> <span class=fl >3</span>]</span>
<span id=cb100-2 ><a href="#cb100-2" aria-hidden=true  tabindex=-1 ></a>x[<span class=fl >3</span>]<span class=op >,</span> x[<span class=fl >1</span><span class=op >:</span><span class=fl >2</span>]<span class=op >...</span> <span class=op >=</span> x</span>
<span id=cb100-3 ><a href="#cb100-3" aria-hidden=true  tabindex=-1 ></a><span class=pp >@test</span> x <span class=op >==</span> [<span class=fl >2</span><span class=op >,</span> <span class=fl >3</span><span class=op >,</span> <span class=fl >1</span>]</span></code></pre></div>
<h3 id=section-51 >05/05/2021</h3>
<ol start=115  type=1 >
<li><p>WE GOT JEFF TO STREAM SMALL STRING OPTIMIZATION! Small lessons:</p>
<li><p>Big wieldy codebase? Work on one small, small change at a time. Cross bridges as you come to them.</p>
<li><p>Majority of strings don‚Äôt need more than 128 bytes, so a single byte of addressing</p>
<li><p>Jeff uses <code>ack</code> for grepping the codebase</p>
<li><p>Before trying to compile, review your changes with a <code>git diff</code></p>
<li><p>When getting a segmentation fault after making your changes and running <code>make</code>, run a debug build to figure out what went wrong with <code>make debug -j4</code></p>
<li><p><code>gdb /usr/bin/julia-debug</code> starts gdb, then <code>cd base/; r --output-ji x compile.ji</code> or something like that.</p>
<li><p>If you change header files you have to rebuild everything</p>
<li><p>Bonus: There‚Äôs a docker image to start Julia Int32.</p>
<li><p>Multithread the <code>compiler.ji</code> step: multithread the code generator, break up into more code units‚Ä¶</p>
<li><p>set a breakpoint on <code>jl_throw</code> to see where <code>gdb</code> goes wrong. then <code>r -J ../usr/lib/julia/corecompiler.ji --output-ji x sysimg.jl</code></p>
<li><p>rr magic: <code>rr record ../usr/bin/julia-debug -J ../usr/lib/julia/corecompiler.ji --output-ji x sysimg.jl</code>, then <code>rr replay</code>. <code>b jl_exceptionf</code> and then <code>rc</code> to ‚Äúreverse continue‚Äù so that you can step backwards from what happened.</p>
<li><p>When an assertion fires, and you are in <code>gdb</code>, the location of the assertion in the source code is in frame 4, so, to jump to it you just start <code>gdb</code> and then <code>f 4</code>.(Usually just using <code>d bt</code> to look at the backtrace and figure out from there where to go.</p>
<li><p>You can call lisp (to reindent your emacs!) within the <code>gc.c</code> file!</p>
<li><p>Hah, I clicked the moment of <a href="https://clips.twitch.tv/ExcitedSparklyTofuTheThing-I5DsaBoyOXcZ2KMw">triump!</a></p>
<li><p><code>../julia runtests.jl strings</code> to run the string test suite.</p>
<li><p>Remembered about <code>ArgParse.jl</code>. Noice:</p>
</ol>
<div class=sourceCode  id=cb101 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb101-1 ><a href="#cb101-1" aria-hidden=true  tabindex=-1 ></a>s <span class=op >=</span> ArgParseSettings()</span>
<span id=cb101-2 ><a href="#cb101-2" aria-hidden=true  tabindex=-1 ></a><span class=pp >@add_arg_table</span><span class=op >!</span> s <span class=kw >begin</span></span>
<span id=cb101-3 ><a href="#cb101-3" aria-hidden=true  tabindex=-1 ></a>    <span class=st >&quot;--opt1&quot;</span></span>
<span id=cb101-4 ><a href="#cb101-4" aria-hidden=true  tabindex=-1 ></a>        help <span class=op >=</span> <span class=st >&quot;an option with an argument&quot;</span></span>
<span id=cb101-5 ><a href="#cb101-5" aria-hidden=true  tabindex=-1 ></a>    <span class=st >&quot;--opt2&quot;</span><span class=op >,</span> <span class=st >&quot;-o&quot;</span></span>
<span id=cb101-6 ><a href="#cb101-6" aria-hidden=true  tabindex=-1 ></a>        help <span class=op >=</span> <span class=st >&quot;another option with an argument&quot;</span></span>
<span id=cb101-7 ><a href="#cb101-7" aria-hidden=true  tabindex=-1 ></a>        arg_type <span class=op >=</span> <span class=dt >Int</span></span>
<span id=cb101-8 ><a href="#cb101-8" aria-hidden=true  tabindex=-1 ></a>        default <span class=op >=</span> <span class=fl >0</span></span>
<span id=cb101-9 ><a href="#cb101-9" aria-hidden=true  tabindex=-1 ></a>    <span class=st >&quot;--flag1&quot;</span></span>
<span id=cb101-10 ><a href="#cb101-10" aria-hidden=true  tabindex=-1 ></a>        help <span class=op >=</span> <span class=st >&quot;an option without argument, i.e. a flag&quot;</span></span>
<span id=cb101-11 ><a href="#cb101-11" aria-hidden=true  tabindex=-1 ></a>        action <span class=op >=</span> <span class=op >:</span>store_true</span>
<span id=cb101-12 ><a href="#cb101-12" aria-hidden=true  tabindex=-1 ></a>    <span class=st >&quot;arg1&quot;</span></span>
<span id=cb101-13 ><a href="#cb101-13" aria-hidden=true  tabindex=-1 ></a>        help <span class=op >=</span> <span class=st >&quot;a positional argument&quot;</span></span>
<span id=cb101-14 ><a href="#cb101-14" aria-hidden=true  tabindex=-1 ></a>        required <span class=op >=</span> <span class=ex >true</span></span>
<span id=cb101-15 ><a href="#cb101-15" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<h3 id=section-52 >05/04/2021</h3>
<ol start=114  type=1 >
<li>Don‚Äôt forget to turn off <code>cpuscaling</code> when running your benchmarks! Hat tip to <a href="https://twitter.com/skamille/status/1389731461893349380">Camille Fournier</a> for schooling a bunch of us on this one!
</ol>
<p><a href="https://nixcp.com/disable-cpu-frecuency-scaling/">From this link:</a> we can do:</p>
<div class=sourceCode  id=cb102 ><pre class="sourceCode bash"><code class="sourceCode bash"><span id=cb102-1 ><a href="#cb102-1" aria-hidden=true  tabindex=-1 ></a><span class=fu >grep</span> <span class=at >-E</span> <span class=st >&#39;^model name|^cpu MHz&#39;</span> /proc/cpuinfo</span></code></pre></div>
<p>To figure out if the number on the left is lower than the number on the right. That‚Äôs costing speed! if you install <code>cpupowerutils(Centos/Debian)/ cpufrequtils (ubuntu / Debian)</code> you can do:</p>
<div class=sourceCode  id=cb103 ><pre class="sourceCode bash"><code class="sourceCode bash"><span id=cb103-1 ><a href="#cb103-1" aria-hidden=true  tabindex=-1 ></a><span class=ex >cpupower</span> frequency-set <span class=at >-g</span> performance</span></code></pre></div>
<h3 id=section-53 >29/04/2021</h3>
<ol start=113  type=1 >
<li>Added a new recipe for <code>simdjson</code>. remember to add <code>supported_platforms(; experimental = true)</code> to try and run thigns on the new Mac M1 and <code>julia_compat = 1.6</code> to get the <code>cpuid</code> feature detection. As always, Mos√® helped tons. He rocks.
</ol>
<h3 id=section-54 >28/04/2021</h3>
<ol start=112  type=1 >
<li>Como deshacer tu <a href="https://midu.dev/como-deshacer-el-ultimo-commit-git/">ultimo git commit</a>
</ol>
<div class=sourceCode  id=cb104 ><pre class="sourceCode bash"><code class="sourceCode bash"><span id=cb104-1 ><a href="#cb104-1" aria-hidden=true  tabindex=-1 ></a><span class=fu >git</span> reset <span class=at >--soft</span> HEAD~1</span>
<span id=cb104-2 ><a href="#cb104-2" aria-hidden=true  tabindex=-1 ></a><span class=fu >git</span> reset <span class=at >--hard</span> HEAD~1</span>
<span id=cb104-3 ><a href="#cb104-3" aria-hidden=true  tabindex=-1 ></a><span class=fu >git</span> commit <span class=at >--ammend</span> <span class=at >-m</span> <span class=st >&quot;este es el mensaje correcto&quot;</span></span>
<span id=cb104-4 ><a href="#cb104-4" aria-hidden=true  tabindex=-1 ></a><span class=fu >git</span> add f.txt</span>
<span id=cb104-5 ><a href="#cb104-5" aria-hidden=true  tabindex=-1 ></a><span class=fu >git</span> commit <span class=at >--ammend</span> <span class=at >-m</span> <span class=st >&quot;mensaje del commit&quot;</span></span>
<span id=cb104-6 ><a href="#cb104-6" aria-hidden=true  tabindex=-1 ></a><span class=co ># Si esta pushed...</span></span>
<span id=cb104-7 ><a href="#cb104-7" aria-hidden=true  tabindex=-1 ></a><span class=fu >git</span> revert 74a...</span></code></pre></div>
<h3 id=section-55 >27/04/2021</h3>
<ol start=109  type=1 >
<li><p><code>launch=false</code> config for <code>CUDA.jl</code> helps set <code>peakflops</code>. Current NVIDIA 860M sets clocks in about 5.6e11.</p>
<li><p>MichaelHatherly‚Äôs <code>InteractiveErrors.jl</code> is amazing. I should add it to a growing list of REPL tools.</p>
<li><p><code>cd -</code> jumps you back to the last dir. Also found <a href="https://lib.rs/command-line-utilities">command line libs in Rust</a>:</p>
</ol>
<ul>
<li>exa, bat, git-tui, git-delta, hunter, and bandwhich
<li><code>grex</code>, <code>navi</code>, and <code>typeracer</code>: use more often!
</ul>
<h3 id=section-56 >22/04/2021</h3>
<ol start=107  type=1 >
<li>Finally reinstalled <code>CUDA.jl</code> stuff. Some good pointers:
</ol>
<ul>
<li>install the <code>linuxXXX-headers</code> and <code>linuxXXX-nvidia</code> to get compat stuff, then <code>sudo pacman -Sy cuda</code> to get all the goodies or <code>CUDA_full_jll</code>. Big thanks to Time Besard and the <code>#gpu</code> gang for the setup.
<li>It‚Äôs important to know the full memory model. Yupei Qi was very kind to recommend the <a href="https://www.nvidia.com/en-us/gtc/on-demand/">GTC On Demand videos</a> and this <a href="https://www.microway.com/download/whitepaper/NVIDIA_Maxwell_GM204_Architecture_Whitepaper.pdf">Architecture whitepaper</a>
<li>This is a good script to figure out the ideal launch config via the occupancy api (üé© to Valentin Churavy )
</ul>
<pre class=julia-repl ><code>julia&gt; using CUDA
julia&gt; function mykernel()
         nothing
       end
mykernel (generic function with 1 method)
julia&gt; myconfig(kernel) = (@show kernel; (threads=1, blocks=1))
myconfig (generic function with 1 method)
julia&gt; @cuda config=myconfig mykernel()</code></pre>
<ul>
<li>It is <strong>critical</strong> to use the <code>nsys</code> profiler to figure out the full occupancy and the SMs in your systems. Ignore the CUDA cores, those are more marketing.<code>nsys launch julia</code> is very useful for getting this setup.
</ul>
<ol start=108  type=1 >
<li>Put up StagedFilters.jl on Discord. With <code>LoopVectorization.jl</code>, we get up to 300x performance increase on some systems vs SciPy. I should make a release as I go forward
</ol>
<ul>
<li>Roadmap: Add a GPU method, add calculating the derivatives in a single pass
</ul>
<h3 id=section-57 >20/04/2021</h3>
<ol start=105  type=1 >
<li><p>Ooops - turns out I didn‚Äôt use a copy of <code>main</code> branch for the tutorials so someone has to update by hadn a bunch of stuff :((((</p>
<li><p><code>BinaryBuilder.supported_platforms(exlclude = Sys.islinux)</code> - where have you been all this time?</p>
</ol>
<h3 id=section-58 >18/04/2021</h3>
<ol start=104  type=1 >
<li>Great day! Wrote the DataFrames.jl tutorials in Spanish, like 13 notebooks in a day. Vim skills paid off big time!
</ol>
<h3 id=section-59 >14/04/2021</h3>
<ol start=102  type=1 >
<li>Almost clinching the BB recipe for <code>racket</code>. This will help build Herbie! In BinaryBuilder.jl, Mos√® recommends, instead of
</ol>
<div class=sourceCode  id=cb106 ><pre class="sourceCode bash"><code class="sourceCode bash"><span id=cb106-1 ><a href="#cb106-1" aria-hidden=true  tabindex=-1 ></a><span class=fu >cp</span> racket/bin/<span class=pp >*</span> <span class=va >${prefix}</span>/</span>
<span id=cb106-2 ><a href="#cb106-2" aria-hidden=true  tabindex=-1 ></a><span class=co ># try doing</span></span>
<span id=cb106-3 ><a href="#cb106-3" aria-hidden=true  tabindex=-1 ></a><span class=fu >cp</span> <span class=at >-r</span> racket/bin <span class=va >${prefix}</span>/.</span></code></pre></div>
<ol start=103  type=1 >
<li>Possible TODO? Stefan posted on <a href="https://discourse.julialang.org/t/julia-is-eight-times-slower-than-go-on-numerical-scheme/59383/29?u=miguelraz">Discourse</a>: &gt; There‚Äôs an old issue to <a href="https://github.com/JuliaLang/julia/issues/964">allow type annotations on global variables</a>. <strong>This would be a great intro compiler project</strong> ‚Äî not trivial by any means, but relatively straightforward. The right approach would need to be discussed with the compiler team, but I suspect the it would be to associate a type with each global binding and automatically insert a type check at each global assignment and teach the compiler that it can assume that the type of each global access has the associated type. An untyped global would then have type Any, so all globals would work the same way. Some subtleties for usability: you‚Äôll want to at least allow redeclaring the same global with the same type so that code can be re-included interactively; you could also allow the type annotation to be made more restrictive since any code that‚Äôs already been generated with that assumption will still be correct; to be really fancy, one could add ‚Äúback edges‚Äù from global binding types to methods that use those globals and increase the world age / invalidate those methods, which would allow arbitrary re-declaration of type globals at the cost of recompiling any methods that accessed the global.
</ol>
<h3 id=section-60 >13/04/2021</h3>
<ol start=100  type=1 >
<li><p>Submitted GSoC app. Godspeed. Go go Rubin.jl!</p>
<li><p>In BinaryBuilder.jl, <code>cd ${prefix}/</code> is where all compilation targets are placed. Also, RTFM! Specifically platform hijinks.</p>
</ol>
<h3 id=section-61 >11/04/2021</h3>
<ol start=98  type=1 >
<li><p>We got invited to give a conference talk at Alpine2021 because of a <a href="https://twitter.com/miguelraz_/status/1381041713725153283">tweet</a> I sent to Alpine‚Äôs main dev, Ariadne Conill. Now to coordinate a cool talk/proposal with Mos√® and Elliot and show off cool Julia stuff.</p>
<li><p>FINALLY got Lean4 working on VSCode. Still don‚Äôt know how to use <code>nix</code> but oh well. Halfway through the manual, and this example was neat to grok:</p>
</ol>
<pre class=lean ><code>def add1Times3FilterEven (xs : List Nat) :=
    -- this
    --   List.filter (. % 2 == 0) (List.map (. * 3) (List.map (. + 1) xs))
    -- becomes this
    --   xs |&gt; List.map (. + 1) |&gt; List.map (. * 3) |&gt; List.filter (. % 2 == 0)
    -- becomes THIS!
    xs |&gt;.map (. + 1) |&gt;.map (. * 3) |&gt;.filter (. % 2 == 0)</code></pre>
<p>In the same note: <code>x |&gt; f</code> in Lean is the same as <code>f &lt;| a</code>, which in Haskell means <code>f $ a</code>. Damn, that‚Äôs some crappy ascii in Haskell :/</p>
<h3 id=section-62 >08/04/2021</h3>
<ol start=97  type=1 >
<li>Spawning a <code>run(...)</code> can take 2x more allocations from one system to another!
</ol>
<pre class=julia-repl ><code>julia&gt; using primecount_jll

julia&gt; @time run(`$(primecount()) 1e14`); # can be 2x allocations in other systems!
3204941750802
  0.150116 seconds (468 allocations: 33.891 KiB)</code></pre>
<ol start=92  type=1 >
<li><p>Woke up to the <code>primecount_jll</code> post getting tons of love, awesome! Hat tip to Stefan Karpsinski and Carsten Bauer for alley-ooping this.</p>
<li><p>Need to remember the <code>@doc</code> macro exists to document code not necessarily next to a function declaration - need to add a dispatch to DoctorDocstrings.jl for this case.</p>
<li><p>Ah right, forgot the <code>make -j${proc}</code> flag for a parallel BBuilder recipe, thanks to Mos√® for <a href="https://github.com/JuliaPackaging/Yggdrasil/pull/2779/files">catching that again</a></p>
<li><p>Mos√® points out <a href="https://dev.azure.com/JuliaPackaging/Yggdrasil/_build/results?buildId=9980&amp;view=results">that it‚Äôs not too hard to look at the warning logs</a> emmitted from the PR - that‚Äôs how he was ble to spot that <code>CompilerSupportLibraries</code> was missing, and some other warnings needed to be addressed.</p>
<li><p>How to easily create a function that updates its own internal state? Use a closure! <a href="https://discourse.julialang.org/t/in-julia-how-to-create-a-function-that-saves-its-own-internal-state/58457/4?u=miguelraz">Like this</a></p>
</ol>
<pre class=julia-repl ><code>julia&gt; f(state=0) = ()-&gt;state+=1
f (generic function with 2 methods)

julia&gt; foo = f()
#7 (generic function with 1 method)

julia&gt; foo()
1

julia&gt; foo()
2

julia&gt; foo()
3

julia&gt; foo.state
Core.Box(3)

julia&gt; foo.state.contents
3</code></pre>
<h3 id=section-63 >05/04/2021</h3>
<ol start=86  type=1 >
<li><p>Chris Elrod with the amazing hint that <code>@code_native</code> has a <code>syntax=:intel</code> or <code>syntax=:att</code> flag!</p>
<li><p>Nice idea during the vacation: need to get</p>
</ol>
<ul>
<li>list of all the conditions passed to the integrator and find a way to shove them into the type system.
<li>just ignore the commented rules, they don‚Äôt pass those cases anyways :/
<li>find the first comment symbol ‚Äú/;‚Äù, (Only 8 are excluded), and slurp with regex the lhs := rhs /; assumptions
<li>make sure to separate the assumptions so that the weird list syntax doesn‚Äôt creep in.
</ul>
<ol start=88  type=1 >
<li><p><a href="https://github.com/akavel/up">up</a> Ultimate Plumber is absolutely amazing at ripgreppin‚Äô files and seeing results in real time. Someone rewrite it in Rust already!</p>
<li><p>Hmmm - what about just simply checking if there is a <code>With[...]</code>, and doing straight string replacement?</p>
<li><p>Don‚Äôt forget about using <code>Traceur.jl</code>!, just drop a <code>@trace foo(3)</code> and keep going.</p>
</ol>
<p>My workflow goes like this:</p>
<ul>
<li><code>cat</code> a file into up: <code>cat file.txt | up</code>
<li>setup pipes for grepping and counting <code>rg "foo" | rg --invert-match "bar" | wc</code>
</ul>
<ol start=91  type=1 >
<li>I made a <a href="https://discourse.julialang.org/t/number-of-primes-below-a-given-number/58709/21?u=miguelraz">cool tutorial</a> on making a BinaryBuilder.jl recipe for <code>primecount</code> a bleeding edge algorithm library for counting primes in in C/C++.
</ol>
<h3 id=section-64 >31/03/2021</h3>
<ol start=85  type=1 >
<li>Made public advances on Rubin.jl today. Turns out you can call (Within Mathematica) <code>FullForm[Hold[...]]</code> and that will give you the S-expression for the whole thing.
</ol>
<p>Now to parse that into Julia full fledged.</p>
<h3 id=section-65 >26/03/2021</h3>
<ol start=81  type=1 >
<li><p>Apply a <code>SymbolicUtils.Rewriters.If(cond, rw)</code> to get the ‚Äúfacts‚Äù of our intrules.</p>
<li><p>Somebody can export every single DiffEq method to Fortran with some cleverness and <code>FortranTarget()</code> shenanigans in Symbolics.jl hmmmmm</p>
<li><p><code>@less @which @edit @functionloc</code> all work the same!</p>
<li><p>Finally got to forwarding a GitHub fork to a new changes! Here‚Äôs how:</p>
</ol>
<pre><code>git fetch upstream
git checkout master
git rebase upstream/master
git push -f origin master</code></pre>
<p>Kindly <a href="https://gist.github.com/ravibhure/a7e0918ff4937c9ea1c456698dcd58aa">taken from here</a>.</p>
<h3 id=section-66 >25/03/2021</h3>
<ol start=78  type=1 >
<li>Instead of <code>Base.OneTo(n)</code>, use <code>axes(A, i)</code> (Thanks Mason!), like so:
</ol>
<div class=sourceCode  id=cb111 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb111-1 ><a href="#cb111-1" aria-hidden=true  tabindex=-1 ></a>julia<span class=op >&gt;</span> A <span class=op >=</span> [rand() <span class=kw >for</span> i <span class=kw >in</span> <span class=fl >1</span><span class=op >:</span><span class=fl >1000</span><span class=op >,</span> j <span class=kw >in</span> <span class=fl >1</span><span class=op >:</span><span class=fl >1000</span>]<span class=op >;</span>julia<span class=op >&gt;</span> <span class=kw >function</span> do_add4<span class=op >!</span>(A)</span>
<span id=cb111-2 ><a href="#cb111-2" aria-hidden=true  tabindex=-1 ></a>           n <span class=op >=</span> sizeof(A)[<span class=fl >1</span>]</span>
<span id=cb111-3 ><a href="#cb111-3" aria-hidden=true  tabindex=-1 ></a>           <span class=kw >for</span> j <span class=op >=</span> <span class=bu >Base</span>.<span class=dt >OneTo</span>(n)</span>
<span id=cb111-4 ><a href="#cb111-4" aria-hidden=true  tabindex=-1 ></a>               <span class=kw >for</span> i <span class=op >=</span> <span class=bu >Base</span>.<span class=dt >OneTo</span>(n)</span>
<span id=cb111-5 ><a href="#cb111-5" aria-hidden=true  tabindex=-1 ></a>                   <span class=pp >@inbounds</span> A[i<span class=op >,</span>j] <span class=op >+=</span> <span class=fl >1.0</span></span>
<span id=cb111-6 ><a href="#cb111-6" aria-hidden=true  tabindex=-1 ></a>               <span class=kw >end</span></span>
<span id=cb111-7 ><a href="#cb111-7" aria-hidden=true  tabindex=-1 ></a>           <span class=kw >end</span></span>
<span id=cb111-8 ><a href="#cb111-8" aria-hidden=true  tabindex=-1 ></a>       <span class=kw >end</span></span></code></pre></div>
<p>Chris Elrod mentions that unless the <code>Base.OneTo</code> isn‚Äôt being fed to an inlined function, it doesn‚Äôt work for much.</p>
<ol start=79  type=1 >
<li><p>Mason also recommends <code>oneunit</code> instead of <code>one</code> as it works with arbitrary number types. BORKED though, disregard.</p>
<li><p>This also works:</p>
</ol>
<div class=sourceCode  id=cb112 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb112-1 ><a href="#cb112-1" aria-hidden=true  tabindex=-1 ></a>julia<span class=op >&gt;</span> <span class=kw >using</span> LoopVectorization</span>
<span id=cb112-2 ><a href="#cb112-2" aria-hidden=true  tabindex=-1 ></a>julia<span class=op >&gt;</span> A <span class=op >=</span> <span class=co ># 1000 x 1000 rand float32s</span></span>
<span id=cb112-3 ><a href="#cb112-3" aria-hidden=true  tabindex=-1 ></a>julia<span class=op >&gt;</span> <span class=pp >@avxt</span> A <span class=op >.*</span> <span class=fl >1f0</span> <span class=co ># multithreaded and AVX512 on platforms that support it</span></span></code></pre></div>
<ol start=81  type=1 >
<li>I should start contributing more to LoopVectorization.jl‚Ä¶
</ol>
<h3 id=section-67 >23/03/2021</h3>
<ol start=73  type=1 >
<li><p>Derp - remember, it‚Äôs <code>match(regex, string).captures[index]</code></p>
<li><p><code>FileTrees</code> needed a <code>path(file) |&gt; string</code> instead of a <code>File</code>.</p>
<li><p>This whole thing parses and writes to a JSON3 array within 10 seconds. That rules!</p>
<li><p>To write files into the <code>MyPkg.jl</code> directory when activated Sukera suggests</p>
</ol>
<div class=sourceCode  id=cb113 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb113-1 ><a href="#cb113-1" aria-hidden=true  tabindex=-1 ></a>joinpath(<span class=pp >@__DIR__</span><span class=op >,</span> <span class=st >&quot;my_new_file.json&quot;</span>)</span></code></pre></div>
<ol start=77  type=1 >
<li>HELL YES RUBIN.JL LIVESSSS
</ol>
<h3 id=section-68 >22/03/2021</h3>
<ol start=70  type=1 >
<li><p><code>ArtifactUtils.jl</code> rules! just <code>add_artifact!</code> and you‚Äôre almost good to go.</p>
<li><p>Need to work with a gajillion files in a folder and map the same transform to them lazily? Use FileTrees.jl for all your multithreaded directed needs!</p>
<li><p>Hmmm some of the Rubi rules are ‚Ä¶ commented? Hope I don‚Äôt end up writing a full Mathematica to Julia transpiler‚Ä¶</p>
</ol>
<h3 id=section-69 >17/3/2021</h3>
<p>So yeah, it‚Äôs been a while. Back on the saddle again.</p>
<ol start=68  type=1 >
<li><p><code>Meta.show_sexpr</code> is super cool.</p>
<li><p>This works!</p>
</ol>
<div class=sourceCode  id=cb114 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb114-1 ><a href="#cb114-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >for</span> c <span class=kw >in</span> <span class=dt >IOBuffer</span>(mymultilinestring)</span>
<span id=cb114-2 ><a href="#cb114-2" aria-hidden=true  tabindex=-1 ></a>    foo(c)</span>
<span id=cb114-3 ><a href="#cb114-3" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<ol start=70  type=1 >
<li>Project Euler is coming along nicely. I should start on Rubi and put those freaking AdventOfCodeParsing skills to the test‚Ä¶
</ol>
<h3 id=section-70 >16/12/2020</h3>
<ol start=66  type=1 >
<li><p>Alex Arslan coming in again with the hot tips: If you want to parse a string into an expression (I need it to call the last REPL history line with <code>@edit</code>) you can use <code>Meta.parse("3^2") == :(3 ^ 2)</code>.</p>
<li><p>Whooops. Shipped <code>DoctorDocstrings.jl</code> today. Best way to figure out if you have a bug is to ship it to production. Problem is that the <code>jldoctest</code> expects the output to be <code>display</code>ed just after the REPL input, so I need to paste the code there. I think I can handle it‚Ä¶ <code>display</code> is the function to print to the REPL, btw.</p>
</ol>
<h3 id=section-71 >15/12/2020</h3>
<ol start=65  type=1 >
<li>Boy oh Boy. I started on DoctorDocstrings.jl. It‚Äôs gonna be amazing.
</ol>
<h3 id=section-72 >14/12/2020</h3>
<ol start=62  type=1 >
<li>Retaking Matt Bauman‚Äôs <a href="https://github.com/mbauman/ParallelWorkshop2019/blob/master/040%20Multithreading.jl">Parallel workshop from JuliaCon 2019</a>
</ol>
<ul>
<li>Remember to accumulate into <code>Threads.Atomic{eltype(arr)}(zero(eltype(arr))</code> if updates are scarce.
<li><code>Threads.atomic_add!</code> and friends aka <code>atomic_add!(r, A[i]) == r += A[i]</code>
<li><code>using .Threads</code>
<li>Pattern: Initialize an accumulator, write an inner loop (independent for each loop), reduce the results at the end with another for loop
<li>BUT! Atomics can‚Äôt yet handle complex numbers, or structs.
<li>Pattern: Make an array the size of the threads, <code>@threads for i in eachindex(A); R[threadid()] += A[i]</code> There‚Äôs 3 interesting distinctions for <code>@sync</code> and <code>@async</code>:
</ul>
<div class=sourceCode  id=cb115 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb115-1 ><a href="#cb115-1" aria-hidden=true  tabindex=-1 ></a><span class=pp >@time</span> <span class=kw >for</span> i <span class=kw >in</span> <span class=fl >1</span><span class=op >:</span><span class=fl >10</span> <span class=co ># takes about 10s</span></span>
<span id=cb115-2 ><a href="#cb115-2" aria-hidden=true  tabindex=-1 ></a>    sleep(<span class=fl >1</span>)</span>
<span id=cb115-3 ><a href="#cb115-3" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span>
<span id=cb115-4 ><a href="#cb115-4" aria-hidden=true  tabindex=-1 ></a><span class=pp >@time</span> <span class=kw >for</span> i <span class=kw >in</span> <span class=fl >1</span><span class=op >:</span><span class=fl >10</span> <span class=co ># about 0s</span></span>
<span id=cb115-5 ><a href="#cb115-5" aria-hidden=true  tabindex=-1 ></a>    <span class=pp >@async</span> sleep(<span class=fl >1</span>)</span>
<span id=cb115-6 ><a href="#cb115-6" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span>
<span id=cb115-7 ><a href="#cb115-7" aria-hidden=true  tabindex=-1 ></a><span class=pp >@time</span> <span class=pp >@sync</span> <span class=kw >for</span> i <span class=kw >in</span> <span class=fl >1</span><span class=op >:</span><span class=fl >10</span> <span class=co ># about 1s</span></span>
<span id=cb115-8 ><a href="#cb115-8" aria-hidden=true  tabindex=-1 ></a>    <span class=pp >@async</span> sleep(<span class=fl >1</span>)</span>
<span id=cb115-9 ><a href="#cb115-9" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<p>You can <code>wait</code> for a task to block until it finishes or <code>fetch</code> to initizlize it now.</p>
<ul>
<li><code>using Distributed</code>: You have 8 REPLs started on each computer. You gain finer control on which processor communicates with which.
<li><code>nprocs(), myid(), @everywhere</code>,
<li>useful idiom: <code>for i in workers(); @spawnat i work(...); end</code>
<li>instead of manually partitioning the space and juggling indexes, try using
</ul>
<div class=sourceCode  id=cb116 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb116-1 ><a href="#cb116-1" aria-hidden=true  tabindex=-1 ></a><span class=pp >@distributed</span> (<span class=op >+</span>) <span class=kw >for</span> r <span class=kw >in</span> [(<span class=fl >0</span><span class=op >:</span><span class=fl >9999</span>) .<span class=op >+</span> offset <span class=kw >for</span> offset <span class=kw >in</span> <span class=fl >0</span><span class=op >:</span><span class=fl >10_000</span><span class=op >:</span>r[<span class=kw >end</span>]<span class=op >-</span><span class=fl >1</span>]</span>
<span id=cb116-2 ><a href="#cb116-2" aria-hidden=true  tabindex=-1 ></a>    partial_pi(r)</span>
<span id=cb116-3 ><a href="#cb116-3" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<ul>
<li><code>@distributed</code> has special support for reductions - to save data movement. Good for reductions.
<li><code>@pmap</code> over a reduction like <code>0:999</code> and <code>0:10000:r[end]-1</code> and then change it to <code>0:9999</code> and <code>0:1000000:r[end]-1</code> because you reduce the communication. Especially good for expensive inner loops that return a value. Creates a task per item in iter space.
<li><code>SharedArray</code> will let all threads concurrently access same array! <code>using SharedArrays</code> should Just Work TM. Slower than threads, since you go to disk.
<li>Heads up - <code>SharedArrays</code> must be bits types - because they need to be Mmapped. Threading like behavior replacement on a single machine.
<li>You can initialize an <code>SharedArray</code> with an <code>init</code> function so that it starts up its own data in a sense.
<li><code>@sync @distributed</code> needs to happen to wait for the correct results.
<li><code>DistributedArray</code> Every worker has access to a different portion of the array. Let‚Äôs the data do the work splitting.
<li><code>fetch(@spawnat 2 A.localpart)</code> shows the data the DArray <code>A</code> has on worker 2.
<li>Pluses: Generic arrays, data itself splits the computation.
</ul>
<ol start=63  type=1 >
<li>Got pretty well punked by a <a href="https://twitter.com/DahlitzF/status/1338384990040682498">Python gotcha</a>
</ol>
<pre class=julia-repl ><code>julia&gt; IdDict(true =&gt; &quot;yes&quot;, 1 =&gt; &quot;no&quot;, 1.0 =&gt; &quot;maybe&quot;)
IdDict{Any,String} with 3 entries:
  true =&gt; &quot;yes&quot;
  1.0  =&gt; &quot;maybe&quot;
  1    =&gt; &quot;no&quot;</code></pre>
<p>Vs</p>
<pre class=julia-repl ><code>julia&gt; Dict(true =&gt; &quot;yes&quot;, 1 =&gt; &quot;no&quot;, 1.0 =&gt; &quot;maybe&quot;)
Dict{Real, String} with 1 entry:
  1.0 =&gt; &quot;maybe&quot;</code></pre>
<p>Fortunately, Stefan was able to convince some of use in the Julia Slack that this is a desirable behavior - you should replace the keys of a dict when you do this, otherwise you will be very very unhappy. Here‚Äôs the relevant <a href="https://github.com/JuliaLang/julia/blob/0bedcdabeb21d0d244babb4a88c91ff75a15577f/base/float.jl#L534-L553">implementations</a> in the <code>decompose</code> function in Base.</p>
<p>Quoting Stefan from the Slack:</p>
<pre><code>in 0.3 we didn‚Äôt hash equal keys the same, we considered the type, but it was really bad
worst problem was that the type of a dict changed the behavior
if you had a Dict{Any,String} and you used 1 and 1.0 as keys, they would end up in different slots; if you had a Dict{Float64,String} and you used 1 and 1.0 as keys, they would both end up in the 1.0 slot
the only ways to avoid that  badness were:
1. don‚Äôt auto-convert keys, which would be really annoying and fussy
2. figure out a good way to value-based key hashing efficiently
two major challenges:
1. make it fast for common types like ints and floats and reasonably fast for things like bigints and rationals
2. make it extensible so that people implementing their own numeric types can do so correctly
yes, package authors definitely extend &#39;Base.decompose&#39; to have proper hashing.</code></pre>
<p>NICE - <a href="https://github.com/JuliaLang/julia/pull/38881">turned the confusion into a PR</a></p>
<ol start=64  type=1 >
<li>Very nice solution to the wordcount exercise: with a <code>matchall</code> regex and a <code>foreach</code>.
</ol>
<div class=sourceCode  id=cb120 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb120-1 ><a href="#cb120-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >function</span> wordcount(sentence<span class=op >::</span><span class=dt >AbstractString</span>)</span>
<span id=cb120-2 ><a href="#cb120-2" aria-hidden=true  tabindex=-1 ></a>    words <span class=op >=</span> matchall(<span class=st >r&quot;</span><span class=ch >[</span><span class=st >a-z</span><span class=ch >]</span><span class=sc >+</span><span class=st >&#39;</span><span class=ch >[</span><span class=st >a-z</span><span class=ch >]</span><span class=sc >+</span><span class=ch >|[</span><span class=st >a-z0-9</span><span class=ch >]</span><span class=sc >+</span><span class=st >&quot;</span><span class=op >,</span> lowercase(sentence))</span>
<span id=cb120-3 ><a href="#cb120-3" aria-hidden=true  tabindex=-1 ></a>    counts <span class=op >=</span> <span class=dt >Dict</span>{<span class=dt >AbstractString</span><span class=op >,</span> <span class=dt >Int</span>}()</span>
<span id=cb120-4 ><a href="#cb120-4" aria-hidden=true  tabindex=-1 ></a>    foreach(w <span class=op >-&gt;</span> counts[w] <span class=op >=</span> get(counts<span class=op >,</span> w<span class=op >,</span> <span class=fl >0</span>) <span class=op >+</span> <span class=fl >1</span><span class=op >,</span> words)</span>
<span id=cb120-5 ><a href="#cb120-5" aria-hidden=true  tabindex=-1 ></a>    counts</span>
<span id=cb120-6 ><a href="#cb120-6" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<h3 id=section-73 >11/12/2020</h3>
<ol start=60  type=1 >
<li>Exercism: Circular Buffer. A few informal interfaces define the ability of Julia to give you a lot of methods for free!
</ol>
<ul>
<li><code>append!, empty!, pop!, pushfirst, setindex!, collect, eltype, first, getindex, isempty, iterate, last, length, size</code> are all ‚Äúfree‚Äù if you can properly subtype <code>&lt;: AbstractVector</code>.
<li>I didn‚Äôt need to keep a bunch of tracking vectors - sometimes just 2 Ints to signal where the <code>Head</code> (first writeable element) and <code>tail</code> first removable element are is enough additional info.
<li>
</ul>
<ol start=61  type=1 >
<li>Omicron666 from Discord helps out with the syntax for nested for loops/iterations:
</ol>
<ul>
<li><code>[10*i + j for i+1:M for j in i+1:N] # Do the first variable i, then the second without a comma</code>
</ul>
<h3 id=section-74 >7/12/2020</h3>
<ol start=52  type=1 >
<li><p><code>parse(Int, "01010101", base=2)</code> to get a binary number directly is really nifty.</p>
<li><p>Remember to use the <code>lo, hi = extrema(xs)</code> function! Credit for a really elegant solution to JLLing.</p>
<li><p>Some really good learning about writing Iterators from <a href="https://julialang.org/blog/2018/07/iterators-in-julia-0.7/">Eric Davies from Invenia</a></p>
</ol>
<ul>
<li><code>IterTools.jl</code> is your friend.
<li>You need 2 <code>iterate</code> methods. YOu can be clever and use a kwarg, or if you aren‚Äôt sure of the structure of the <code>state</code> arg, use <code>...</code>:
</ul>
<div class=sourceCode  id=cb121 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb121-1 ><a href="#cb121-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >function</span> iterate(it<span class=op >::</span>TakeNth<span class=op >,</span> state<span class=op >...</span>)</span>
<span id=cb121-2 ><a href="#cb121-2" aria-hidden=true  tabindex=-1 ></a>    xs_iter <span class=op >=</span> <span class=cn >nothing</span></span>
<span id=cb121-3 ><a href="#cb121-3" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb121-4 ><a href="#cb121-4" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >for</span> i <span class=op >=</span> <span class=fl >1</span><span class=op >:</span>it.interval</span>
<span id=cb121-5 ><a href="#cb121-5" aria-hidden=true  tabindex=-1 ></a>        xs_iter <span class=op >=</span> <span class=pp >@ifsomething</span> iterate(it.xs<span class=op >,</span> state<span class=op >...</span>)</span>
<span id=cb121-6 ><a href="#cb121-6" aria-hidden=true  tabindex=-1 ></a>        state <span class=op >=</span> <span class=bu >Base</span>.tail(xs_iter)</span>
<span id=cb121-7 ><a href="#cb121-7" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >end</span></span>
<span id=cb121-8 ><a href="#cb121-8" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb121-9 ><a href="#cb121-9" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >return</span> xs_iter</span>
<span id=cb121-10 ><a href="#cb121-10" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<ol start=55  type=1 >
<li>To dump a TLA file into a dot file, use <code>tlc -dump dot file.dot file.tla</code>. Then read it with
</ol>
<ul>
<li>Hmmmmm Strong connected concurrent components in LightGraphs.jl ? <a href="https://github.com/tlaplus/tlaplus/blob/master/general/docs/contributions.md">link here</a>, <a href="https://github.com/vbloemen/hong-ufscc">repo here</a>
</ul>
<ol start=56  type=1 >
<li><a href="https://github.com/kimikage/CodeCosts.jlA">CodeCosts.jl</a> looks REALLLLLY cool for a [JuliaTooling] video soon‚Ä¶
</ol>
<pre class=julia-repl ><code>julia&gt; using CodeCosts

julia&gt; f(x::T) where T = convert(T, max(x * 10.0, x / 3))
f (generic function with 1 method)

julia&gt; @code_costs f(1.0f0)
CodeCostsInfo(
     CodeInfo(
   1 1 ‚îÄ %1  = Base.fpext(Base.Float64, x)::Float64
   4 ‚îÇ   %2  = Base.mul_float(%1, 10.0)::Float64
  20 ‚îÇ   %3  = Base.div_float(x, 3.0f0)::Float32
   1 ‚îÇ   %4  = Base.fpext(Base.Float64, %3)::Float64
   2 ‚îÇ   %5  = Base.lt_float(%2, %4)::Bool
   1 ‚îÇ   %6  = Base.bitcast(Base.Int64, %4)::Int64
   1 ‚îÇ   %7  = Base.slt_int(%6, 0)::Bool
   1 ‚îÇ   %8  = Base.bitcast(Base.Int64, %2)::Int64
   1 ‚îÇ   %9  = Base.slt_int(%8, 0)::Bool
   0 ‚îÇ   %10 = Base.not_int(%7)::Bool
   1 ‚îÇ   %11 = Base.and_int(%9, %10)::Bool
   1 ‚îÇ   %12 = Base.or_int(%5, %11)::Bool
   2 ‚îÇ   %13 = Base.ne_float(%2, %2)::Bool
   1 ‚îÇ   %14 = Base.Math.ifelse(%13, %2, %4)::Float64
   2 ‚îÇ   %15 = Base.ne_float(%4, %4)::Bool
   1 ‚îÇ   %16 = Base.Math.ifelse(%15, %4, %2)::Float64
   1 ‚îÇ   %17 = Base.Math.ifelse(%12, %14, %16)::Float64
   1 ‚îÇ   %18 = Base.fptrunc(Base.Float32, %17)::Float32
   0 ‚îî‚îÄ‚îÄ       return %18
     )
, CodeCostsSummary(
     zero:  2|
    cheap: 12| 111111111111
   middle: 10| 4===2=2=2=
expensive: 20| 20==================
    total: 42| 100 (default threshold)
))</code></pre>
<ol start=57  type=1 >
<li><a href="https://www.youtube.com/watch?v=YBSt1jYwVfU">DP by errichto:</a>
</ol>
<ul>
<li>There‚Äôs identical subproblems (think of the leaves of fibonacci(5))
<li>if it doesn‚Äôt matter how you get to an intermediate state, then the dims of the dynamic program are <code>dp[N]</code>, with N states.
<li>Then think of the transition.
<li>When doing the minimum path sum through an array, take care to a) initialize the edges / boundaries, the first element
<li>build a copy of the initial data, and only update after doing the logic for the max/min logic.
<li>Brain hurts.
</ul>
<ol start=58  type=1 >
<li><a href="https://www.youtube.com/watch?v=1mtvm2ubHCY">Dynamic prog 2 by errichto</a>:
</ol>
<ul>
<li>Combination sum problem.
</ul>
<ol start=59  type=1 >
<li>TLA challenge for AoC2020!
</ol>
<h3 id=section-75 >6/12/2020</h3>
<ol start=51  type=1 >
<li>Advent of Code 7 kicked my butt. HOWEVER! We rocked the parsing with some cool regexes.
</ol>
<ul>
<li>I couldn‚Äôt solve the first one because I am not familiar with the concept of queues. Or stacks.
</ul>
<p>Again, Pablo Zubieta coming in with the fire code:</p>
<div class=sourceCode  id=cb123 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb123-1 ><a href="#cb123-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >function</span> fish(d)</span>
<span id=cb123-2 ><a href="#cb123-2" aria-hidden=true  tabindex=-1 ></a>    <span class=co ># if you only pop and append to the end of vectors, all is good</span></span>
<span id=cb123-3 ><a href="#cb123-3" aria-hidden=true  tabindex=-1 ></a>    queue <span class=op >=</span> [k <span class=kw >for</span> (k<span class=op >,</span> v) <span class=kw >in</span> d <span class=kw >if</span> haskey(v<span class=op >,</span> <span class=st >&quot;shiny gold&quot;</span>)]</span>
<span id=cb123-4 ><a href="#cb123-4" aria-hidden=true  tabindex=-1 ></a>    found <span class=op >=</span> <span class=dt >Set</span>(queue)</span>
<span id=cb123-5 ><a href="#cb123-5" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >while</span> <span class=op >!</span>isempty(queue)</span>
<span id=cb123-6 ><a href="#cb123-6" aria-hidden=true  tabindex=-1 ></a>        bag <span class=op >=</span> pop<span class=op >!</span>(queue)</span>
<span id=cb123-7 ><a href="#cb123-7" aria-hidden=true  tabindex=-1 ></a>        <span class=kw >new</span> <span class=op >=</span> (k <span class=kw >for</span> (k<span class=op >,</span> v) <span class=kw >in</span> d <span class=kw >if</span> haskey(v<span class=op >,</span> bag))</span>
<span id=cb123-8 ><a href="#cb123-8" aria-hidden=true  tabindex=-1 ></a>        union<span class=op >!</span>(found<span class=op >,</span> <span class=kw >new</span>) <span class=co ># This is better than a push!</span></span>
<span id=cb123-9 ><a href="#cb123-9" aria-hidden=true  tabindex=-1 ></a>        <span class=cn >append</span><span class=op >!</span>(queue<span class=op >,</span> <span class=kw >new</span>)</span>
<span id=cb123-10 ><a href="#cb123-10" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >end</span></span>
<span id=cb123-11 ><a href="#cb123-11" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >return</span> length(found)</span>
<span id=cb123-12 ><a href="#cb123-12" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<ul>
<li>So, the idea is I have <code>pop!</code>, <code>push!</code> and a <code>queue</code>.
<li>If you have a vector of <code>Pair</code>, you can sum them with <code>sum(last, pairs)</code>.
<li>For performant regexes <a href="https://www.loggly.com/blog/five-invaluable-techniques-to-improve-regex-performance/">Specificity is king</a>
<li>Teo ShaoWei is using some very concise regexes and a very handy function to return named tuples:
</ul>
<div class=sourceCode  id=cb124 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb124-1 ><a href="#cb124-1" aria-hidden=true  tabindex=-1 ></a><span class=co ># &quot;nop +0&quot;</span></span>
<span id=cb124-2 ><a href="#cb124-2" aria-hidden=true  tabindex=-1 ></a><span class=co ># &quot;acc +3&quot;</span></span>
<span id=cb124-3 ><a href="#cb124-3" aria-hidden=true  tabindex=-1 ></a><span class=co ># &quot;jmp -99&quot; expected inputs</span></span>
<span id=cb124-4 ><a href="#cb124-4" aria-hidden=true  tabindex=-1 ></a><span class=kw >function</span> parse_input_line(line)</span>
<span id=cb124-5 ><a href="#cb124-5" aria-hidden=true  tabindex=-1 ></a>    m <span class=op >=</span> match(<span class=st >r&quot;^</span><span class=ch >(</span><span class=sc >\w</span><span class=st >{3}</span><span class=ch >)</span><span class=st > </span><span class=ch >([</span><span class=st >-+</span><span class=ch >]</span><span class=sc >\d+</span><span class=ch >)</span><span class=st >$&quot;</span><span class=op >,</span> line</span>
<span id=cb124-6 ><a href="#cb124-6" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >return</span> (op <span class=op >=</span> m[<span class=fl >1</span>]<span class=op >,</span> val <span class=op >=</span> parse(<span class=dt >Int</span><span class=op >,</span> m[<span class=fl >2</span>]))</span>
<span id=cb124-7 ><a href="#cb124-7" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<p>From this we consider the following: 1. Consider having a function that parses a line at a time and passes a named tuple to the solver. 2. Don‚Äôt be silly - if you already have code that finds the solution to something in part1‚Ä¶ use it in part2. -_-.</p>
<h3 id=section-76 >5/12/2020</h3>
<ol start=47  type=1 >
<li><p>Advent of Code just keeps on rocking!</p>
<li><p>Exericisms review: checking if something is an isogram (no repeated letters):</p>
</ol>
<div class=sourceCode  id=cb125 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb125-1 ><a href="#cb125-1" aria-hidden=true  tabindex=-1 ></a>isisogram(s) <span class=op >=</span> allunique(i <span class=kw >for</span> i <span class=kw >in</span> lowercase(s) <span class=kw >if</span> isletter(i))</span></code></pre></div>
<ol start=49  type=1 >
<li>When defining your new types, make sure to use <code>promote_rule</code> appropriately. <code>Exercism:Complex Numbers:</code>
</ol>
<ul>
<li><code>promote_rule(T1, T2) = foo(promote_type(T1,T2))</code>
<li>Remember to import <code>Base.abs, Base.exponent, Base.:+ ...</code>
<li>For funsies, try commenting out your <code>zero(x), one(x)</code> implementations and seeing if yoru algebra still works. (Should work regardless!)
<li>You can write <code>import Base: real, imag, conj, +, -, * ...</code> at the top of the file and then do <code>+(x::Complex, y::Complex)</code> without <code>Base.:</code>.
<li>Fooling around with rationals is no fun if you don‚Äôt know the <code>copysign(x, y)</code> function: takes the magnitude of <code>x</code> with the sign of <code>y</code>. Removes a lot of hacky logic.
<li>Note: <code>=&gt; is for pairs, &gt;= is boolean</code> o.0
<li>NOTE: Make sure that the tests are RIGHT. Not checking for a 0 denominator blew up in my face.
<li>If you want to print a custom type, overload <code>show</code> so that it <code>print</code>s what you want
</ul>
<pre><code>  To customize human-readable text output for objects of type T, define
  show(io::IO, ::MIME&quot;text/plain&quot;, ::T) instead. Checking the :compact IOContext
  property of io in such methods is recommended, since some containers show their
  elements by calling this method with :compact =&gt; true.</code></pre>
<ul>
<li><p><code>show(io::IO, x::RationalNumber) = print(io, num(x),"//",den(x))</code> Now onto CustomSet:</p>
<li><p>You can <code>merge(dict1, dict1)</code>.</p>
<li><p>You can get the <code>keytype(d)</code></p>
<li><p>Great tip from Sascha Mann: To define <code>foo/foo!</code> combos, do <code>foo!(x) = ...</code> and then <code>foo(x) = foo!(copy(x))</code></p>
<li><p>When test sets fail eagerly, consider moving them ‚Äúup‚Äù so that another property is tested first.</p>
<li><p>Iteration is <del>hard</del> easier now than before, just figure out how to write the proper</p>
</ul>
<div class=sourceCode  id=cb127 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb127-1 ><a href="#cb127-1" aria-hidden=true  tabindex=-1 ></a>iterate(s<span class=op >::</span>CustomSet) <span class=op >=</span> iterate(s.dict)</span>
<span id=cb127-2 ><a href="#cb127-2" aria-hidden=true  tabindex=-1 ></a>iterate(s<span class=op >::</span>CustomSet<span class=op >,</span> el) <span class=op >=</span> iterate(s.dict<span class=op >,</span> el)</span></code></pre></div>
<ol start=50  type=1 >
<li>Iterators galore! We had massive help from Sascha and Fliksel:
</ol>
<ul>
<li>LESSON: RETURN WHAT YOU WANT THE NEXT STATE TO BE
</ul>
<pre class=julia-repl ><code>julia&gt; function Base.iterate(iter::Fibo, state = (0, (1,1))) # The 0 here will represent the &quot;counter&quot;
       if state[1] &gt; iter.n
           return nothing
       end
       f1, f2 = state[2]
       return f1+f2, (state[1]+1, (f1+f2, f1))
       end</code></pre>
<ol start=51  type=1 >
<li>Note about iterators:
</ol>
<div class=sourceCode  id=cb129 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb129-1 ><a href="#cb129-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >function</span> <span class=bu >Base</span>.iterate(iter<span class=op >::</span>Fibo<span class=op >,</span> state <span class=op >=</span> <span class=op >...</span>)</span>
<span id=cb129-2 ><a href="#cb129-2" aria-hidden=true  tabindex=-1 ></a>                        <span class=co >#  ^</span></span>
<span id=cb129-3 ><a href="#cb129-3" aria-hidden=true  tabindex=-1 ></a>                    <span class=co >#  |</span></span>
<span id=cb129-4 ><a href="#cb129-4" aria-hidden=true  tabindex=-1 ></a>    counter <span class=op >=</span> state[<span class=fl >1</span>] <span class=co ># &lt;- this has to match with newstate</span></span>
<span id=cb129-5 ><a href="#cb129-5" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >if</span> counter <span class=op >&gt;</span> iter.n</span>
<span id=cb129-6 ><a href="#cb129-6" aria-hidden=true  tabindex=-1 ></a>        <span class=kw >return</span> <span class=cn >nothing</span></span>
<span id=cb129-7 ><a href="#cb129-7" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >end</span></span>
<span id=cb129-8 ><a href="#cb129-8" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb129-9 ><a href="#cb129-9" aria-hidden=true  tabindex=-1 ></a>    <span class=co ># Clever calculations here</span></span>
<span id=cb129-10 ><a href="#cb129-10" aria-hidden=true  tabindex=-1 ></a>    newitem <span class=op >=</span> foo(<span class=op >...</span>)</span>
<span id=cb129-11 ><a href="#cb129-11" aria-hidden=true  tabindex=-1 ></a>    newstate <span class=op >=</span> (bar(<span class=op >...</span>)<span class=op >,</span> <span class=op >...</span>)</span>
<span id=cb129-12 ><a href="#cb129-12" aria-hidden=true  tabindex=-1 ></a>    <span class=co ># </span><span class=al >NOTE</span><span class=co >: the tuples must match up!</span></span>
<span id=cb129-13 ><a href="#cb129-13" aria-hidden=true  tabindex=-1 ></a>    <span class=co ># typeof(newstate) == typeof(state)</span></span>
<span id=cb129-14 ><a href="#cb129-14" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >return</span> newitem<span class=op >,</span> newstate</span>
<span id=cb129-15 ><a href="#cb129-15" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb129-16 ><a href="#cb129-16" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<h3 id=section-77 >4/12/2020</h3>
<ol start=42  type=1 >
<li>Pablo Zubieta just absolutely shreked his Advent of Code Day04 problem: here‚Äôs the learnings.
</ol>
<ul>
<li>Parsing to integers and then applying logic can be done within a regex itself.
<li>Just check for the actual cases that need to be satisfied with the characters themselves, no need to lift them into ints.
<li>A good strategy is to separate your cases with <code>|</code> and put a word boundary at the end <code>\b</code>.
<li>It‚Äôs zero allocations!
</ul>
<div class=sourceCode  id=cb130 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb130-1 ><a href="#cb130-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >const</span> input <span class=op >=</span> split(<span class=dt >String</span>(<span class=cn >read</span>(<span class=st >&quot;input&quot;</span>))<span class=op >,</span> <span class=st >r&quot;</span><span class=sc >\n\n</span><span class=st >&quot;</span>)</span>
<span id=cb130-2 ><a href="#cb130-2" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb130-3 ><a href="#cb130-3" aria-hidden=true  tabindex=-1 ></a><span class=kw >const</span> fields1 <span class=op >=</span> (<span class=st >r&quot;byr&quot;</span><span class=op >,</span> <span class=st >r&quot;iyr&quot;</span><span class=op >,</span> <span class=st >r&quot;eyr&quot;</span><span class=op >,</span> <span class=st >r&quot;hgt&quot;</span><span class=op >,</span> <span class=st >r&quot;hcl&quot;</span><span class=op >,</span> <span class=st >r&quot;ecl&quot;</span><span class=op >,</span> <span class=st >r&quot;pid&quot;</span>)</span>
<span id=cb130-4 ><a href="#cb130-4" aria-hidden=true  tabindex=-1 ></a><span class=kw >const</span> fields2 <span class=op >=</span> (</span>
<span id=cb130-5 ><a href="#cb130-5" aria-hidden=true  tabindex=-1 ></a>    <span class=st >r&quot;byr:</span><span class=ch >(</span><span class=st >19</span><span class=ch >[</span><span class=st >2-9</span><span class=ch >][</span><span class=st >0-9</span><span class=ch >]|</span><span class=st >200</span><span class=ch >[</span><span class=st >0-2</span><span class=ch >])</span><span class=sc >\b</span><span class=st >&quot;</span><span class=op >,</span></span>
<span id=cb130-6 ><a href="#cb130-6" aria-hidden=true  tabindex=-1 ></a>    <span class=st >r&quot;iyr:20</span><span class=ch >(</span><span class=st >1</span><span class=ch >[</span><span class=st >0-9</span><span class=ch >]|</span><span class=st >20</span><span class=ch >)</span><span class=sc >\b</span><span class=st >&quot;</span><span class=op >,</span></span>
<span id=cb130-7 ><a href="#cb130-7" aria-hidden=true  tabindex=-1 ></a>    <span class=st >r&quot;eyr:20</span><span class=ch >(</span><span class=st >2</span><span class=ch >[</span><span class=st >0-9</span><span class=ch >]|</span><span class=st >30</span><span class=ch >)</span><span class=sc >\b</span><span class=st >&quot;</span><span class=op >,</span></span>
<span id=cb130-8 ><a href="#cb130-8" aria-hidden=true  tabindex=-1 ></a>    <span class=st >r&quot;hgt:</span><span class=ch >(</span><span class=st >1</span><span class=ch >([</span><span class=st >5-8</span><span class=ch >][</span><span class=st >0-9</span><span class=ch >]|</span><span class=st >9</span><span class=ch >[</span><span class=st >0-3</span><span class=ch >])</span><span class=st >cm</span><span class=ch >|(</span><span class=st >59</span><span class=ch >|</span><span class=st >6</span><span class=ch >[</span><span class=st >0-9</span><span class=ch >]|</span><span class=st >7</span><span class=ch >[</span><span class=st >0-6</span><span class=ch >])</span><span class=st >in</span><span class=ch >)</span><span class=sc >\b</span><span class=st >&quot;</span><span class=op >,</span></span>
<span id=cb130-9 ><a href="#cb130-9" aria-hidden=true  tabindex=-1 ></a>    <span class=st >r&quot;hcl:#</span><span class=ch >[</span><span class=st >0-9a-f</span><span class=ch >]</span><span class=st >{6}</span><span class=sc >\b</span><span class=st >&quot;</span><span class=op >,</span></span>
<span id=cb130-10 ><a href="#cb130-10" aria-hidden=true  tabindex=-1 ></a>    <span class=st >r&quot;ecl:</span><span class=ch >(</span><span class=st >amb</span><span class=ch >|</span><span class=st >blu</span><span class=ch >|</span><span class=st >brn</span><span class=ch >|</span><span class=st >gry</span><span class=ch >|</span><span class=st >grn</span><span class=ch >|</span><span class=st >hzl</span><span class=ch >|</span><span class=st >oth</span><span class=ch >)</span><span class=sc >\b</span><span class=st >&quot;</span><span class=op >,</span></span>
<span id=cb130-11 ><a href="#cb130-11" aria-hidden=true  tabindex=-1 ></a>    <span class=st >r&quot;pid:</span><span class=sc >\d</span><span class=st >{9}</span><span class=sc >\b</span><span class=st >&quot;</span></span>
<span id=cb130-12 ><a href="#cb130-12" aria-hidden=true  tabindex=-1 ></a>)</span>
<span id=cb130-13 ><a href="#cb130-13" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb130-14 ><a href="#cb130-14" aria-hidden=true  tabindex=-1 ></a><span class=co ># Part 1</span></span>
<span id=cb130-15 ><a href="#cb130-15" aria-hidden=true  tabindex=-1 ></a>count(p <span class=op >-&gt;</span> all(t <span class=op >-&gt;</span> contains(p<span class=op >,</span> t)<span class=op >,</span> fields1)<span class=op >,</span> input)</span>
<span id=cb130-16 ><a href="#cb130-16" aria-hidden=true  tabindex=-1 ></a></span>
<span id=cb130-17 ><a href="#cb130-17" aria-hidden=true  tabindex=-1 ></a><span class=co ># Part 2</span></span>
<span id=cb130-18 ><a href="#cb130-18" aria-hidden=true  tabindex=-1 ></a>count(p <span class=op >-&gt;</span> all(t <span class=op >-&gt;</span> contains(p<span class=op >,</span> t)<span class=op >,</span> fields2)<span class=op >,</span> input)</span></code></pre></div>
<ol start=43  type=1 >
<li>Instead of
</ol>
<div class=sourceCode  id=cb131 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb131-1 ><a href="#cb131-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >if</span> <span class=op >!</span>haskey(d<span class=op >,</span> str)</span>
<span id=cb131-2 ><a href="#cb131-2" aria-hidden=true  tabindex=-1 ></a>    d[str] <span class=op >=</span> <span class=fl >1</span></span>
<span id=cb131-3 ><a href="#cb131-3" aria-hidden=true  tabindex=-1 ></a><span class=kw >elseif</span></span>
<span id=cb131-4 ><a href="#cb131-4" aria-hidden=true  tabindex=-1 ></a>    haskey(d<span class=op >,</span> str)</span>
<span id=cb131-5 ><a href="#cb131-5" aria-hidden=true  tabindex=-1 ></a>    d[str] <span class=op >+=</span> <span class=fl >1</span></span>
<span id=cb131-6 ><a href="#cb131-6" aria-hidden=true  tabindex=-1 ></a><span class=kw >else</span></span>
<span id=cb131-7 ><a href="#cb131-7" aria-hidden=true  tabindex=-1 ></a>    <span class=op >...</span></span>
<span id=cb131-8 ><a href="#cb131-8" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<p>You can try</p>
<div class=sourceCode  id=cb132 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb132-1 ><a href="#cb132-1" aria-hidden=true  tabindex=-1 ></a>d[str] <span class=op >=</span> get(d<span class=op >,</span> s<span class=op >,</span> <span class=fl >0</span>) <span class=op >+</span> <span class=fl >1</span></span></code></pre></div>
<ol start=44  type=1 >
<li>Revisiting Exercisms is a good way to hone skills. Instead of
</ol>
<div class=sourceCode  id=cb133 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb133-1 ><a href="#cb133-1" aria-hidden=true  tabindex=-1 ></a>a<span class=op >,</span> b<span class=op >,</span> c <span class=op >=</span> dict[c[<span class=fl >1</span>]]<span class=op >,</span> dict[c[<span class=fl >2</span>]] dict[c[<span class=fl >3</span>]]</span>
<span id=cb133-2 ><a href="#cb133-2" aria-hidden=true  tabindex=-1 ></a><span class=co ># vs</span></span>
<span id=cb133-3 ><a href="#cb133-3" aria-hidden=true  tabindex=-1 ></a>a<span class=op >,</span> b<span class=op >,</span> c <span class=op >=</span> (dict[c[i]] <span class=kw >for</span> i <span class=kw >in</span> <span class=fl >1</span><span class=op >:</span><span class=fl >3</span>)</span></code></pre></div>
<ol start=45  type=1 >
<li><p>Remember to check for type instabilities in the code with <code>@code_warntype</code>.</p>
<li><p>Stacking generators within generators is tricky, but <code>joshua-whittemore</code> has a trick (Exercism-ETL)</p>
</ol>
<div class=sourceCode  id=cb134 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb134-1 ><a href="#cb134-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >function</span> transform(input<span class=op >::</span><span class=dt >Dict</span>)</span>
<span id=cb134-2 ><a href="#cb134-2" aria-hidden=true  tabindex=-1 ></a>    <span class=dt >Dict</span>(</span>
<span id=cb134-3 ><a href="#cb134-3" aria-hidden=true  tabindex=-1 ></a>         lowercase(letter) <span class=op >=&gt;</span> value</span>
<span id=cb134-4 ><a href="#cb134-4" aria-hidden=true  tabindex=-1 ></a>         <span class=kw >for</span> (value<span class=op >,</span> letters) <span class=kw >in</span> input</span>
<span id=cb134-5 ><a href="#cb134-5" aria-hidden=true  tabindex=-1 ></a>         <span class=kw >for</span> letter <span class=kw >in</span> letters</span>
<span id=cb134-6 ><a href="#cb134-6" aria-hidden=true  tabindex=-1 ></a>    )</span>
<span id=cb134-7 ><a href="#cb134-7" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<h3 id=section-78 >2/12/2020</h3>
<ol start=37  type=1 >
<li>Beast of a solution with great help from Colin:
</ol>
<div class=sourceCode  id=cb135 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb135-1 ><a href="#cb135-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >function</span> solutions(str)</span>
<span id=cb135-2 ><a href="#cb135-2" aria-hidden=true  tabindex=-1 ></a>    sol1<span class=op >,</span> sol2 <span class=op >=</span> <span class=fl >0</span><span class=op >,</span> <span class=fl >0</span></span>
<span id=cb135-3 ><a href="#cb135-3" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >for</span> line <span class=kw >in</span> readlines(str)</span>
<span id=cb135-4 ><a href="#cb135-4" aria-hidden=true  tabindex=-1 ></a>        lo<span class=op >,</span> hi<span class=op >,</span> (char<span class=op >,</span>)<span class=op >,</span> pass <span class=op >=</span> match(<span class=st >r&quot;^</span><span class=ch >(</span><span class=sc >\d+</span><span class=ch >)</span><span class=st >-</span><span class=ch >(</span><span class=sc >\d+</span><span class=ch >)</span><span class=st > </span><span class=ch >(</span><span class=sc >\w</span><span class=ch >)</span><span class=st >: </span><span class=ch >(</span><span class=sc >.+</span><span class=ch >)</span><span class=st >$&quot;</span><span class=op >,</span> line).captures</span>
<span id=cb135-5 ><a href="#cb135-5" aria-hidden=true  tabindex=-1 ></a>        lo<span class=op >,</span> hi <span class=op >=</span> parse.(<span class=dt >Int</span><span class=op >,</span> (lo<span class=op >,</span> hi))</span>
<span id=cb135-6 ><a href="#cb135-6" aria-hidden=true  tabindex=-1 ></a>        sol1 <span class=op >+=</span> lo <span class=op >&lt;=</span> count(<span class=op >==</span>(char)<span class=op >,</span> pass) <span class=op >&lt;=</span> hi</span>
<span id=cb135-7 ><a href="#cb135-7" aria-hidden=true  tabindex=-1 ></a>        sol2 <span class=op >+=</span> (pass[lo] <span class=op >==</span> char) ‚äª (pass[hi] <span class=op >==</span> char)</span>
<span id=cb135-8 ><a href="#cb135-8" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >end</span></span>
<span id=cb135-9 ><a href="#cb135-9" aria-hidden=true  tabindex=-1 ></a>    sol1<span class=op >,</span> sol2</span>
<span id=cb135-10 ><a href="#cb135-10" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<p>The <code>match(r"...", line).captures</code> immediately splits and gets the appropriate strings, and <code>(char,)</code> is a tuple decomposition of a container with a single element, (similar to <code>(a,b) = [3 4]</code>).</p>
<ol start=38  type=1 >
<li>Regex has many smart functions
</ol>
<div class=sourceCode  id=cb136 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb136-1 ><a href="#cb136-1" aria-hidden=true  tabindex=-1 ></a><span class=dt >Regex</span>(<span class=st >&quot;[regex]&quot;</span>)</span>
<span id=cb136-2 ><a href="#cb136-2" aria-hidden=true  tabindex=-1 ></a><span class=st >r&quot;</span><span class=ch >[</span><span class=st >regex</span><span class=ch >]</span><span class=st >&quot;</span></span>
<span id=cb136-3 ><a href="#cb136-3" aria-hidden=true  tabindex=-1 ></a>match(needle<span class=op >,</span> haystack)</span>
<span id=cb136-4 ><a href="#cb136-4" aria-hidden=true  tabindex=-1 ></a><span class=op >~~</span>matchall(needle<span class=op >,</span> haystack)<span class=op >~~</span></span>
<span id=cb136-5 ><a href="#cb136-5" aria-hidden=true  tabindex=-1 ></a>eachmatch(needle<span class=op >,</span> haystack)</span>
<span id=cb136-6 ><a href="#cb136-6" aria-hidden=true  tabindex=-1 ></a>ismatch(needle<span class=op >,</span> haystack)</span></code></pre></div>
<ol start=39  type=1 >
<li>If I have <code>str = "Roll On The Floor"</code> and I want to match on each first character to get the acronym, I can use <code>getproperty(m, :match)</code> for that:
</ol>
<div class=sourceCode  id=cb137 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb137-1 ><a href="#cb137-1" aria-hidden=true  tabindex=-1 ></a>r <span class=op >=</span> eachmatch(<span class=st >r&quot;</span><span class=sc >\b</span><span class=ch >[</span><span class=st >a-zA-Z</span><span class=ch >]</span><span class=st >&quot;</span><span class=op >,</span> str)</span>
<span id=cb137-2 ><a href="#cb137-2" aria-hidden=true  tabindex=-1 ></a>join(getproperty(r[i]<span class=op >,</span> <span class=op >:</span>match) <span class=kw >for</span> i <span class=kw >in</span> <span class=fl >1</span><span class=op >:</span>length(r))</span></code></pre></div>
<ol start=40  type=1 >
<li>Count is really nifty:
</ol>
<pre class=julia-repl ><code>julia&gt; xs = &quot;#..##.&quot;
&quot;#..##.&quot;

julia&gt; count(&quot;#&quot;, xs)
3</code></pre>
<p>These ‚Äúcurried‚Äù operators can be found with <code>rg Fix[12]</code>, or <code>help?&gt; Fix1</code></p>
<p>!!! You can implement this for your own methods with <code>Base.Fix2{typeof(func)}</code>: <code>contains(needle) = Base.Fix2(contains, needle)</code></p>
<ol start=41  type=1 >
<li>When dealing with parsing strings by hand, split can sometimes give useless empty strings that muck up the analysis later on. Use the <code>kw</code> <code>keepempty=false</code> to get rid of those spurious results! For an example, check the AdventOfCodeDay04 code.
</ol>
<h3 id=section-79 >1/12/2020</h3>
<ol start=35  type=1 >
<li><p>Advent of code day 01: cool tricks:</p>
<li><p>Advent of code day 02: Cool tricks:</p>
</ol>
<ul>
<li>remember that <code>'a' != "a"</code>. If ASCII <code>"a"[1]</code> works, and in other cases, use <code>only()</code>.
<li>Even better, as <code>@tommyxr</code> points out, just do <code>==(letter)</code>.
</ul>
<h3 id=section-80 >21/11/2020</h3>
<ol start=33  type=1 >
<li>Credit to <code>@Suker</code>: REPL interactivity can be drastically helped (and enhanced with Revise.jl) if you have the following:
</ol>
<ul>
<li>working on a script that may have some big g Global parameter everywhere,
<li>put those in a function <code>main()</code> and put <code>!isinteractive() &amp;&amp; main()</code> at the end of the file
</ul>
<ol start=34  type=1 >
<li>Reading the SciML dev docs:
</ol>
<ul>
<li>To add a new package to the common interface, define the types
</ul>
<div class=sourceCode  id=cb139 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb139-1 ><a href="#cb139-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >abstract type</span> AnalyticAlgorithm <span class=op >&lt;:</span> DiffEqBase.AbstractAnalyticAlgorithm</span></code></pre></div>
<ul>
<li>specify type parameters for concrete algos
</ul>
<div class=sourceCode  id=cb140 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb140-1 ><a href="#cb140-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >struct</span> analytic{Simple} <span class=op >&lt;:</span> AnalyticAlgorithm{Simple} <span class=kw >end</span></span>
<span id=cb140-2 ><a href="#cb140-2" aria-hidden=true  tabindex=-1 ></a>analytic(<span class=op >;</span> simple <span class=op >=</span> <span class=ex >true</span>) <span class=op >=</span> analytic{simple}()</span></code></pre></div>
<ul>
<li>overload <code>__solve</code> from <code>DiffEqBase.jl</code>
</ul>
<h3 id=section-81 >19/11/2020</h3>
<ol start=31  type=1 >
<li>Chris de Graaf suggested instead of using <code>const A = [1]</code>, try using a <code>Ref</code>:
</ol>
<div class=sourceCode  id=cb141 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb141-1 ><a href="#cb141-1" aria-hidden=true  tabindex=-1 ></a><span class=co ># access a ref with []</span></span>
<span id=cb141-2 ><a href="#cb141-2" aria-hidden=true  tabindex=-1 ></a>A <span class=op >=</span> <span class=dt >Ref</span>(<span class=fl >0</span>)</span>
<span id=cb141-3 ><a href="#cb141-3" aria-hidden=true  tabindex=-1 ></a>A[] <span class=op >=</span> <span class=fl >1</span></span>
<span id=cb141-4 ><a href="#cb141-4" aria-hidden=true  tabindex=-1 ></a>A[] <span class=op >==</span> <span class=fl >1</span> <span class=co ># true</span></span></code></pre></div>
<p>Takes a bit more nanoseconds to access than a 1 sized array but is sized <code>()</code>.</p>
<ol start=32  type=1 >
<li>Execution matters more than hoarding ideas. <a href="https://www.youtube.com/watch?v=dSCBCk4xVa0">Decent Talk by John Cormack</a>. Enjoy the insight high, then get down in the mud and try to bust your own idea.
</ol>
<h3 id=section-82 >15/11/2020</h3>
<ol start=26  type=1 >
<li>Al final empec√© el manual en espa√±ol. Parece que <code>Laura Ventosa</code> va a ser buena mancuerna para este proyecto. Qu√© chido. La <a href="https://github.com/miguelraz/julia-es-manual">traduccion del manual esta en este link</a>.
</ol>
<div class=sourceCode  id=cb142 ><pre class="sourceCode bash"><code class="sourceCode bash"><span id=cb142-1 ><a href="#cb142-1" aria-hidden=true  tabindex=-1 ></a><span class=fu >wc</span> src/index.mc src/manual/getting-started.md src/manual/variables.md</span>
<span id=cb142-2 ><a href="#cb142-2" aria-hidden=true  tabindex=-1 ></a>  <span class=ex >109</span>   986  7546 src/index.md</span>
<span id=cb142-3 ><a href="#cb142-3" aria-hidden=true  tabindex=-1 ></a>  <span class=ex >100</span>   731  5084 src/manual/getting-started.md</span>
<span id=cb142-4 ><a href="#cb142-4" aria-hidden=true  tabindex=-1 ></a>  <span class=ex >138</span>   932  6102 src/manual/variables.md</span>
<span id=cb142-5 ><a href="#cb142-5" aria-hidden=true  tabindex=-1 ></a>  <span class=ex >347</span>  2649 18732 total</span></code></pre></div>
<p>CONTEO: 2640</p>
<ol start=27  type=1 >
<li><p>Copy pasting to the system clipboard in Vim is easier with <code>select the text -&gt; "+y</code>. Also <code>t</code> will go to just before a character <code>F</code> will search a char backwards, and <code>}</code> will go to the end of a paragraph.</p>
<li><p>It seems the <code>Savitzky-Golay</code> filter is very - VERY - interesting for a lot of computing people. Really need to get into parallelizing it and figuring out the GPU part.</p>
</ol>
<ul class=task-list >
<li><input type=checkbox  disabled="" />
Investigate why it was not 4x as fast with Float32s as with Float64s.
<li><input type=checkbox  disabled="" />
Check for other applications <a href="https://sites.middlebury.edu/dunham/files/2017/07/MC2-004-Signal-Processing-in-a-Physics-Experiment-2017-July-11-FINAL.pdf">in this cool presentaiton</a>
</ul>
<ol start=29  type=1 >
<li><p>Started on Pochoir.jl. Godspeed.</p>
<li><p>Oh god. SymbolicUtils.jl can revive IntegralTransforms.jl.</p>
</ol>
<h3 id=section-83 >14/11/2020</h3>
<ol start=25  type=1 >
<li>Found an absolutely amazing post about learning Z3 as if it were <a href="https://www.craigstuntz.com/posts/2015-03-05-provable-optimization-with-microsoft-z3.html">Lisp syntactically</a>. Should definitely look into this further. I think some Z3 and TLA+ are more than enough formal methods for a while‚Ä¶ There‚Äôs even an online <a href="https://rise4fun.com/Z3/7VZh">editor that seems useful for prototyping</a>
</ol>
<h3 id=section-84 >13/11/2020</h3>
<ol start=18  type=1 >
<li>Counting neighbours / minesweeping? Ran into this problem on the <a href="https://exercism.io/my/solutions/fae14489bd9b4de1bc5283815f0e66ac">Exercsim</a> earlier today:
</ol>
<div class=sourceCode  id=cb143 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb143-1 ><a href="#cb143-1" aria-hidden=true  tabindex=-1 ></a>sum(arr[i][j] .<span class=op >==</span> <span class=st >&quot;*&quot;</span>) <span class=co >#where j = 1:3</span></span></code></pre></div>
<p>is a no-no. First, we have to remember to compare <code>Char</code>s to <code>Char</code>s, since</p>
<div class=sourceCode  id=cb144 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb144-1 ><a href="#cb144-1" aria-hidden=true  tabindex=-1 ></a><span class=st >&quot;*&quot;</span> <span class=op >==</span> <span class=ch >&#39;*&#39;</span> <span class=co ># false</span></span>
<span id=cb144-2 ><a href="#cb144-2" aria-hidden=true  tabindex=-1 ></a><span class=ch >&#39;*&#39;</span> <span class=op >==</span> <span class=ch >&#39;*&#39;</span> <span class=co ># true</span></span></code></pre></div>
<p>A correct approach looks like:</p>
<div class=sourceCode  id=cb145 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb145-1 ><a href="#cb145-1" aria-hidden=true  tabindex=-1 ></a>sum(arr[i][j] <span class=op >==</span> <span class=ch >&#39;*&#39;</span> <span class=kw >for</span> j <span class=kw >in</span> idxs)</span></code></pre></div>
<p>by use of some spiffy generator syntax.</p>
<ol start=19  type=1 >
<li><p>Maybe time for someone to write a fast <code>neighbours(arr, i, j)</code> function in a package and PR it to LinAlg? Credit to Sascha Mann. Use views to make it fast. Kick it up a notch: make it N-Dimensional, and performant!</p>
<li><p>You can‚Äôt do <code>a = "abc"; a[2] = '3';</code>, or <code>'3' != Char(3)</code>, because STRINGS ARE IMMUTABLE!</p>
<li><p><a href="https://exercism.io/tracks/julia/exercises/minesweeper/solutions/2c776b090173426eb160cea17a85e536#solution-comment-170293"><code>Vyu</code></a> has an amazing solution for summing up neighbours in a Matrix:</p>
</ol>
<div class=sourceCode  id=cb146 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb146-1 ><a href="#cb146-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >function</span> sumAdjacent(array<span class=op >,</span> xy<span class=op >::</span><span class=dt >CartesianIndex</span>{<span class=fl >2</span>})</span>
<span id=cb146-2 ><a href="#cb146-2" aria-hidden=true  tabindex=-1 ></a>    x<span class=op >,</span> y <span class=op >=</span> xy.I</span>
<span id=cb146-3 ><a href="#cb146-3" aria-hidden=true  tabindex=-1 ></a>    lenX<span class=op >,</span> lenY <span class=op >=</span> size(array)</span>
<span id=cb146-4 ><a href="#cb146-4" aria-hidden=true  tabindex=-1 ></a>    v <span class=op >=</span> view(</span>
<span id=cb146-5 ><a href="#cb146-5" aria-hidden=true  tabindex=-1 ></a>        array<span class=op >,</span></span>
<span id=cb146-6 ><a href="#cb146-6" aria-hidden=true  tabindex=-1 ></a>        max(<span class=fl >1</span><span class=op >,</span> x <span class=op >-</span> <span class=fl >1</span>)<span class=op >:</span>min(lenX<span class=op >,</span> x <span class=op >+</span> <span class=fl >1</span>)<span class=op >,</span></span>
<span id=cb146-7 ><a href="#cb146-7" aria-hidden=true  tabindex=-1 ></a>        max(<span class=fl >1</span> <span class=op >,</span>y <span class=op >-</span> <span class=fl >1</span>)<span class=op >:</span>min(lenY<span class=op >,</span> y <span class=op >+</span> <span class=fl >1</span>)</span>
<span id=cb146-8 ><a href="#cb146-8" aria-hidden=true  tabindex=-1 ></a>    )</span>
<span id=cb146-9 ><a href="#cb146-9" aria-hidden=true  tabindex=-1 ></a>    sum(v)</span>
<span id=cb146-10 ><a href="#cb146-10" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<ol start=22  type=1 >
<li><a href="">bovine3dom</a> has a solution for a hypercube minefield:
</ol>
<div class=sourceCode  id=cb147 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb147-1 ><a href="#cb147-1" aria-hidden=true  tabindex=-1 ></a><span class=co ># This function works for hypercube minefields too, which is pretty cool.</span></span>
<span id=cb147-2 ><a href="#cb147-2" aria-hidden=true  tabindex=-1 ></a><span class=co ># If you decide to construct your own hypercube minefield, bear in mind that</span></span>
<span id=cb147-3 ><a href="#cb147-3" aria-hidden=true  tabindex=-1 ></a><span class=co ># the curse of dimensionality means that mines become useless as the number of</span></span>
<span id=cb147-4 ><a href="#cb147-4" aria-hidden=true  tabindex=-1 ></a><span class=co ># dimensions increases to even moderate numbers.</span></span>
<span id=cb147-5 ><a href="#cb147-5" aria-hidden=true  tabindex=-1 ></a><span class=co >#</span></span>
<span id=cb147-6 ><a href="#cb147-6" aria-hidden=true  tabindex=-1 ></a><span class=co ># (A more useful metric for &#39;danger from mines&#39; is the percentage of neighbouring</span></span>
<span id=cb147-7 ><a href="#cb147-7" aria-hidden=true  tabindex=-1 ></a><span class=co ># cells which contain mines).</span></span>
<span id=cb147-8 ><a href="#cb147-8" aria-hidden=true  tabindex=-1 ></a><span class=kw >function</span> flag_mines(matrix<span class=op >::</span><span class=dt >Array</span>)</span>
<span id=cb147-9 ><a href="#cb147-9" aria-hidden=true  tabindex=-1 ></a>    flagged <span class=op >=</span> zeros(<span class=dt >Int</span><span class=op >,</span>size(matrix))</span>
<span id=cb147-10 ><a href="#cb147-10" aria-hidden=true  tabindex=-1 ></a>    <span class=pp >@inbounds</span> <span class=kw >for</span> inds <span class=kw >in</span> <span class=dt >Tuple</span>.(<span class=dt >CartesianIndices</span>(matrix))</span>
<span id=cb147-11 ><a href="#cb147-11" aria-hidden=true  tabindex=-1 ></a>        flagged[inds<span class=op >...</span>] <span class=op >=</span> matrix[inds<span class=op >...</span>] <span class=op >==</span> <span class=fl >1</span> ? <span class=op >-</span><span class=fl >1</span> <span class=op >:</span> sum(window(matrix<span class=op >,</span>inds<span class=op >,</span>ones(<span class=dt >Int</span><span class=op >,</span>length(size(matrix)))))</span>
<span id=cb147-12 ><a href="#cb147-12" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >end</span></span>
<span id=cb147-13 ><a href="#cb147-13" aria-hidden=true  tabindex=-1 ></a>    flagged</span>
<span id=cb147-14 ><a href="#cb147-14" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<ol start=23  type=1 >
<li>The cleanest minefield answer might be <code>OTDE</code>‚Ä¶
</ol>
<div class=sourceCode  id=cb148 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb148-1 ><a href="#cb148-1" aria-hidden=true  tabindex=-1 ></a>annotate(minefield) <span class=op >=</span> [</span>
<span id=cb148-2 ><a href="#cb148-2" aria-hidden=true  tabindex=-1 ></a>    replace(</span>
<span id=cb148-3 ><a href="#cb148-3" aria-hidden=true  tabindex=-1 ></a>        join(</span>
<span id=cb148-4 ><a href="#cb148-4" aria-hidden=true  tabindex=-1 ></a>            w[c] <span class=op >==</span> <span class=ch >&#39;*&#39;</span> ? <span class=ch >&#39;*&#39;</span> <span class=op >:</span></span>
<span id=cb148-5 ><a href="#cb148-5" aria-hidden=true  tabindex=-1 ></a>            count(get(get(minefield<span class=op >,</span> y<span class=op >,</span> <span class=st >&quot;&quot;</span>)<span class=op >,</span> x<span class=op >,</span> <span class=st >&quot;&quot;</span>) <span class=op >==</span> <span class=ch >&#39;*&#39;</span></span>
<span id=cb148-6 ><a href="#cb148-6" aria-hidden=true  tabindex=-1 ></a>            <span class=kw >for</span> x <span class=kw >in</span> (c <span class=op >-</span> <span class=fl >1</span>)<span class=op >:</span>(c <span class=op >+</span> <span class=fl >1</span>)</span>
<span id=cb148-7 ><a href="#cb148-7" aria-hidden=true  tabindex=-1 ></a>                <span class=kw >for</span> y <span class=kw >in</span> (r <span class=op >-</span> <span class=fl >1</span>)<span class=op >:</span>(r <span class=op >+</span> <span class=fl >1</span>)</span>
<span id=cb148-8 ><a href="#cb148-8" aria-hidden=true  tabindex=-1 ></a>                    <span class=kw >if</span> x <span class=op >!=</span> c <span class=op >||</span> y <span class=op >!=</span> r)</span>
<span id=cb148-9 ><a href="#cb148-9" aria-hidden=true  tabindex=-1 ></a>        <span class=kw >for</span> c <span class=kw >in</span> <span class=fl >1</span><span class=op >:</span>length(w))<span class=op >,</span></span>
<span id=cb148-10 ><a href="#cb148-10" aria-hidden=true  tabindex=-1 ></a>    <span class=ch >&#39;0&#39;</span> <span class=op >=&gt;</span> <span class=ch >&#39; &#39;</span>)</span>
<span id=cb148-11 ><a href="#cb148-11" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >for</span> (r<span class=op >,</span> w) <span class=kw >in</span> enumerate(minefield)</span>
<span id=cb148-12 ><a href="#cb148-12" aria-hidden=true  tabindex=-1 ></a>]</span></code></pre></div>
<p>Lessons: - a nested generator can be quite powerful - don‚Äôt be afraind to use dictionary combos with <code>for (r, w) in enumerate(xs)</code> - This looks intimidating as hell. I don‚Äôt think I could recode this in a few months.</p>
<ol start=24  type=1 >
<li>DID NOT KNOW you could iterate a dictionary if you didn‚Äôt care about order:
</ol>
<div class=sourceCode  id=cb149 ><pre class="sourceCode julia"><code class="sourceCode julia"><span id=cb149-1 ><a href="#cb149-1" aria-hidden=true  tabindex=-1 ></a>samples <span class=op >=</span> <span class=dt >Dict</span>(</span>
<span id=cb149-2 ><a href="#cb149-2" aria-hidden=true  tabindex=-1 ></a>    <span class=st >&quot;I&quot;</span> <span class=op >=&gt;</span> <span class=fl >1</span><span class=op >,</span></span>
<span id=cb149-3 ><a href="#cb149-3" aria-hidden=true  tabindex=-1 ></a>    <span class=st >&quot;II&quot;</span> <span class=op >=&gt;</span> <span class=fl >2</span><span class=op >,</span></span>
<span id=cb149-4 ><a href="#cb149-4" aria-hidden=true  tabindex=-1 ></a>    <span class=st >&quot;V&quot;</span> <span class=op >=&gt;</span> <span class=fl >5</span><span class=op >,</span></span>
<span id=cb149-5 ><a href="#cb149-5" aria-hidden=true  tabindex=-1 ></a>    )</span>
<span id=cb149-6 ><a href="#cb149-6" aria-hidden=true  tabindex=-1 ></a><span class=kw >for</span> sample <span class=kw >in</span> samples</span>
<span id=cb149-7 ><a href="#cb149-7" aria-hidden=true  tabindex=-1 ></a>    <span class=pp >@test</span> to_roman(sample[<span class=fl >1</span>]) <span class=op >==</span> sample[<span class=fl >2</span>]</span>
<span id=cb149-8 ><a href="#cb149-8" aria-hidden=true  tabindex=-1 ></a><span class=kw >end</span></span></code></pre></div>
<h3 id=section-85 >12/11/2020</h3>
<ol start=17  type=1 >
<li>Invaluable git trick: if you committed some changes locally, but someone else pushed to master, use the <a href="https://cscheng.info/2017/01/26/git-tip-autostash-with-git-pull-rebase.html">auto-rebase autostash trick</a>:
</ol>
<pre><code>git config --global pull.rebase true
git config --global rebase.atuoStash true</code></pre>
<p>so that you don‚Äôt need to do <code>git pull --rebase --autostash</code> and can just <code>git pull</code>.</p>
<h3 id=section-86 >08/11/2020</h3>
<ol start=10  type=1 >
<li><p>Try and order starter kit / computer parts from newegg.com</p>
<li><p>Before you spend a day trying to scrape / download files, make sure the author did not already kindly include a zipped version of the files :clown_face:</p>
<li><p>I think I found a possible thesis project - SymbolicUtils.jl as a backend for SymbolicTensors.jl. I should message the author and set something up.</p>
<li><p>Ran into rulebasedintegration.org. Downloaded the Mathematica notebooks, found a way to parse and dump them into text with PDFIO.jl.</p>
<li><p>Remembered how to setup an <code>artifact</code> with ArtifactUtils.jl. That thing is useful.</p>
<li><p>Found a killer command from SOverflow on how to recursively copy all files in a tree of folders that match an extension into a target directory:</p>
</ol>
<ul>
<li>whelp I think I lost it. Will fish it back but it was an easy google.
</ul>
<ol start=16  type=1 >
<li>Polytomous recommended <a href=www.taguette.org >‚ÄúTaguette‚Äù</a> for highlighting documents and its open source. Super cool! Should send to Ponzi.
</ol>
<h3 id=section-87 >06/11/2020</h3>
<ol start=9  type=1 >
<li>If you want to make your startup super fast, use <code>PackageCompiler.jl</code>:
</ol>
<pre class=julia-repl ><code>julia&gt; using PackageCompiler
julia&gt; create_sysimage([:Revise, :OhMyREPL, :BenchmarkTools], replace_default = true)</code></pre>
<p>Super charge that combo with the <code>~/.julia/config/startup.jl</code>:</p>
<pre class=julia-repl ><code>julia&gt; try
           using Revise
       catch e
       @warn(e)
       end</code></pre>
<h3 id=section-88 >04/11/2020</h3>
<ol start=7  type=1 >
<li><p>Trump is likely gonna lose the election - crazy times. Been working a bit on scaffolding for LightGraphsIO.jl. Solid integration with Parsers.jl will mean a lot of speed coming up for the LightGraphs.jl ecosystem.</p>
<li><p>In order to not get punked by the output of</p>
</ol>
<pre class=julia-repl ><code>julia&gt; print.(sq(i) for i in 1:10)
14916253649648110010-element Vector{Nothing}:
nothing
nothing
nothing
nothing
nothing
nothing
nothing
nothing
nothing
nothing</code></pre>
<p><code>@pabloferz</code> suggested the <code>foreach</code>, which returns a <code>nothing</code>, and thus doesn‚Äôt print.</p>
<pre class=julia-repl ><code>julia&gt; foreach(x -&gt; println(x^2), 1:3:7)
1
9
49</code></pre>
<h3 id=section-89 >31/10/2020</h3>
<ol start=6  type=1 >
<li>Today I finally got around to rewriting <code>GraphsIO.jl</code>. It suffered from a few ailments:
</ol>
<ul>
<li>Very, very wonky pythonic dispatch
<li>Small performance hits when writing (ie, not using <code>io = IOBuffer()</code>, <code>write(io, s1, s2)</code> instead of the allocating <code>write(io, "$s1$s2")</code>, etc.
<li>Very awkward test scaffolding. Figuring out which functions are being called is just not fun.
<li>Bulky directory structure. I‚Äôll just monorepo it for now and see what sticks.
<li>Poor documentation.
</ul>
<p>I adopted the <code>Blue Style</code> guidelines because they came in with PkgTemplates.jl and screw it, why not try and follow them. Here‚Äôs what I got done today: - Testing scaffolding mostly setup. (Files, how to run the tests, etc.) - Writing graphs in DOT, and I think 3 other formats. - Minor performance improvements.</p>
<p>Tomorrow I should start something fun with the Parsers.jl library for maximum speedups. Wish me luck!</p>
<h3 id=section-90 >29/10/2020</h3>
<ol type=1 >
<li>Closures! Defining a function within a function is a type of closure. They take variables from one scope above them. <code>@masonprotter</code> and <code>@fredrikekre</code> helped me figure out why having this is desirable:
</ol>
<pre class=julia-repl ><code>julia&gt; function f(x, y, z)
           data = compute(x, y, z)

           g() = data^2 # closure over data
           g() # call g here maybe?
           # ...
           g() # maybe again here?
end</code></pre>
<p>Mason says:‚ÄúAlmost all usages of closures can be replaced with ‚Äòtop level‚Äô functions that take extra arguments (one for each captured field), but it‚Äôs syntactically less pleasing and can end up causing you to have a bunch of function names in your namespace you don‚Äôt want.‚Äù Of course <a href="https://discourse.julialang.org/t/closures-section-in-documentation-is-not-clear-enough/18717/13">there‚Äôs a Discourse post on it</a>.</p>
<ol start=2  type=1 >
<li>Wow! <a href="https://docs.julialang.org/en/v1/manual/functions/#Function-composition-and-piping">Function composition and piping</a> lets you do some amazing stuff with <code>\circ&lt;TAB&gt;</code> and friends!
</ol>
<pre class=julia-repl ><code>julia&gt; (sqrt ‚àò +)(3, 6)
3.0
julia&gt; map(first ‚àò reverse ‚àò uppercase, split(&quot;you can compose functions like this&quot;)
6-element Array{Char,1}:
 &#39;U&#39;: ASCII/Unicode U+0055 (category Lu: Letter, uppercase)
 &#39;N&#39;: ASCII/Unicode U+004E (category Lu: Letter, uppercase)
 &#39;E&#39;: ASCII/Unicode U+0045 (category Lu: Letter, uppercase)
...
julia&gt; 1:10 |&gt; sum |&gt; sqrt
7.416...
julia&gt; (sqrt ‚àò sum)(1:10)
7.41...
julia&gt; [ &quot;a&quot;, &quot;list&quot;, &quot;of&quot;, &quot;strings&quot;] .|&gt; [uppercase, reverse, titlecase, length]
4-element Array{Any,1}:
  &quot;A&quot;
  &quot;tsil&quot;
  &quot;Of&quot;
 7
julia&gt; (^2, sqrt, inv).([2,4,4])
[4,2, .25]</code></pre>
<ol start=3  type=1 >
<li>Rust allows for defining anonymous functions!
</ol>
<div class=sourceCode  id=cb157 ><pre class="sourceCode rust"><code class="sourceCode rust"><span id=cb157-1 ><a href="#cb157-1" aria-hidden=true  tabindex=-1 ></a><span class=kw >fn</span> raindrops(n<span class=op >:</span> <span class=dt >u32</span>) <span class=op >-&gt;</span> <span class=dt >String</span> <span class=op >{</span></span>
<span id=cb157-2 ><a href="#cb157-2" aria-hidden=true  tabindex=-1 ></a>    <span class=kw >let</span> is_factor <span class=op >=</span> <span class=op >|</span>f<span class=op >|</span> x <span class=op >%</span> f <span class=op >==</span> <span class=dv >0</span><span class=op >;</span></span>
<span id=cb157-3 ><a href="#cb157-3" aria-hidden=true  tabindex=-1 ></a>    <span class=op >...</span></span>
<span id=cb157-4 ><a href="#cb157-4" aria-hidden=true  tabindex=-1 ></a><span class=op >}</span></span></code></pre></div>
<ol start=4  type=1 >
<li>Rust match is very powerful‚Ä¶ try and setup the anonymous functions in a tuple after the <code>match</code> and then filter by <code>(each, available, case) =&gt; action</code>.
</ol>
<pre class=plaintext ><code>pub fn raindrops(num: i64) -&gt; String {
    let mut raindrop = String::new();

    match (num % 3, num % 5, num % 7) {
        (0, 0, 0) =&gt; raindrop.push_str(&quot;PlingPlangPlong&quot;),
        (0, 0, _) =&gt; raindrop.push_str(&quot;PlingPlang&quot;),
        (0, _, 0) =&gt; raindrop.push_str(&quot;PlingPlong&quot;),
        (_, 0, 0) =&gt; raindrop.push_str(&quot;PlangPlong&quot;),
        (0, _, _) =&gt; raindrop.push_str(&quot;Pling&quot;),
        (_, 0, _) =&gt; raindrop.push_str(&quot;Plang&quot;),
        (_, _, 0) =&gt; raindrop.push_str(&quot;Plong&quot;),
        (_, _, _) =&gt; raindrop = num.to_string()
    }

    return raindrop
}</code></pre>
<ol start=5  type=1 >
<li>This was a good use of match
</ol>
<pre class=plaintext ><code>pub fn square(s: u32) -&gt; u64 {
    match s {
        1...64 =&gt; 1u64.wrapping_shl(s-1),
// This also works
//      1u64 &lt;&lt; (s - 1)
        _ =&gt; panic!(&quot;Square must be between 1 and 64&quot;),
    }
}

pub fn total() -&gt; u64 {
    (1..65).map(square).sum()
// Lol thanks philip98
// u64::max_value
}</code></pre>
<p>Credit to Wow-BOB-Wow.</p>
<h3 id=section-91 >27/10/2020</h3>
<p>Today I got my website setup!</p>