@def title = "GSoC in LLVM 2024"
@def author = "Miguel Raz GuzmÃ¡n Macedo"
@def tags = ["LLVM", "Julia", "LLVM"]
@def rss = "GSoC in LLVM 2024"
@def rss_pubdate = Date(2024, 02, 29)
@def published = "02 29 2024"
@def rss_guid = 9

# I'm trying to get a GSoC 2024 in LLVM

and I will be documenting my work with this ongoing blogpost in reverse chronological order.

---

If you want to see more posts like this, consider chucking a buck or two on my [GitHub sponsors](https://github.com/miguelraz), or, you know, hire me as a grad student.

---

## 7/02/2024 

Alright, did some good catchup on the semester and pushed the [PR forward a bit](https://discourse.llvm.org/t/rfc-add-3-way-comparison-intrinsics/76685/7?u=miguelraz).

I also had an awesome "uniwtting tourist" genius moment by pointing out the return type could be different than what Nikita had thought of.

Today I setup my environment with

```
wget -O - https://apt.llvm.org/llvm-snapshot.gpg.key | sudo apt-key add -
sudo apt-add-repository "deb http://apt.llvm.org/jammy/ llvm-toolchain-jammy-17 main"
sudo apt-get update
sudo apt-get install -y llvm-17 llvm-17-dev llvm-17-tools clang-17
```

so now I can run `opt` shenanigans without awkward path invocations.

## 2/02/2024 

I'm waiting for others to chime in on my latest fix so I will be reading on how to add [unit tests](https://llvm.org/docs/TestingGuide.html).

Cool, that took like 25 minutes and I pushed a commit into the unit test generation framework.

Took me a bit but tried adding using `llvm-lit` and couldn't get the `Examples` folder to run,
so I posted a question in the #beginners channel about it.

## 1/02/2024 

Sweet! I was able to address Nikita's refactoring comments without too much hassle.

I guess the next task is to add it to the Verifier.

-> I read the `llvm/lib/IR/Verifier.cpp` header and grep'd for `smin`. Seems I can add a 

```
Intrinsics::vector_reduce_sthreecmp:
Intrinsics::vector_reduce_uthreecmp:
```

on line 5378 and get away with this. I don't see other places where it's defined.

I think I've hit my potential here. I will go do some tutorials.


## 29/02/2024 

### "hazlo cobarde"

Add the [3 way comparison instruction](https://discourse.llvm.org/t/llvm-add-3-way-comparison-intrinsics/76807/10) `<=>` to LLVM. 

I like this GSoC in particular because

* I will learn a wide swath of LLVM 
* I'll be working with a lot of optimization passes
* I'll get to bring cool perf to C++/Rust and Julia
* I was dared by [the other, more talented Miguel](https://twitter.com/DrawsMiguel/status/1759708211286835309) to actually help improve LLVM

### Task 1: Add to LangRef

[Add a new intrinsic](https://llvm.org/docs/ExtendingLLVM.html) - `Langref`, then `Intrinsics.td`, then maybe the pass verifier.

I've already put up a [sample PR](https://github.com/llvm/llvm-project/pull/83227) and got redirected on what looks like the proper working path for this endeavour.

Oh neat, I've finished. Only took about 1 hour with careful copy pasting. I'm probably blundering the return type being `iM` bits, but someone will correct me.

Now, I need to add an entry of the intrinsic into TableGen.

### Task 2: Add to Intrinsics.td

Whelp, I guess I gotta learn tablegen and then this `Intrinsics.td` file.

Ok, I found [a non-intimidating TableGen overview](https://llvm.org/docs/TableGen/index.html).

Gotta find the optimization wizardry in there after reading for a few minutes.

Alright, took more than a bit of an hour but [I got pushed something for this task](https://github.com/llvm/llvm-project/pull/83227#issuecomment-1972375003).

Pinged Nikita to get some adults to look at my horrible TableGen incantation.

See ya tomorrow.


