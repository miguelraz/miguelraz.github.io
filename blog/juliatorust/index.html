<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <!--<link rel=stylesheet  href="/libs/highlight/github.min.css"> --> <link rel=stylesheet  href="/libs/highlight/styles/atom-one-dark.css"> <script src="libs/clipboard.min.js"></script> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/basic.css"> <link rel=icon  href="/assets/favicon.ico" type="image/x-icon"> <title>Knowing Julia, Learning High Performance Rust</title> <header> <div class=blog-name ><a href="">PathToPerformance</a></div> <nav> <ul> <li><a href="/">Welcome! üëãüèæ</a> <li><a href="/diary/">Diaryüìí</a> <li><a href="/blog/">Blogüí≠</a> <li><a href="/pubs/">Publications üìì /Talksüó£Ô∏è /Videosüé• </a> <li><a href="/teaching/">Teachingüéì/Translationsüó∫Ô∏è</a> <li><a href="/about/">CVüíÉ</a> <script src="/libs/clipboard.js"></script> </ul> <img src="/assets/hamburger.svg" id=menu-icon > </nav> </header> <div class=franklin-content ><ol> <li><p>COST paper</p> </ol> <p>Handy learning materials:</p> <ul> <li><p>Rust book</p> <li><p>Rustlings</p> <li><p>Tour of Rust</p> <li><p>cheat.rs</p> <li><p>Rust by example</p> <li><p>Rust docs</p> <li><p>Exercism</p> <li><p>Advent of Code by Amos</p> </ul> <h3 id=what_does_generic_rustian_code_look_like ><a href="#what_does_generic_rustian_code_look_like" class=header-anchor >What does generic Rustian code look like?</a></h3> <p>We love composability and multiple dispatch - what does that look like in Rust?</p> <ul> <li><p>In Julia land, how do I get generic code? <code>zero&#40;...&#41;</code>, <code>eltype&#40;...&#41;</code>, <code>where T&lt;:Foo</code></p> <li><p>In Rust Land, how do I get generic code? <code>impl&lt;T&gt;</code>, linear types, <code>#&#91;derive&#40;Debug, Eq, PartialOrder, Hash&#41;&#93;</code></p> </ul> <h3 id=rustian_projects_of_interest ><a href="#rustian_projects_of_interest" class=header-anchor >Rustian projects of interest </a></h3> <ol> <li><p>Graph workbench Aaalto <a href="https://parallel-rust-cpp.github.io/">Comparing parallel Rust and C&#43;&#43;</a></p> <li><p>cargo release <a href="https://deterministic.space/high-performance-rust.html">and other tricks</a></p> <li><p>Jeff Zarnett programming for performance course <a href="https://github.com/jzarnett/ece459">repo</a>, with a <a href="https://www.youtube.com/watch?v&#61;BE64OK7l20k&amp;list&#61;PLFCH6yhq9yAHnjKmB9RLA2Qdk3XhphqrN">full youtube playlist</a>,<a href="https://www.youtube.com/watch?v&#61;-MDHdqZvxxs&amp;list&#61;PLFCH6yhq9yAHnjKmB9RLA2Qdk3XhphqrN&amp;index&#61;28">youtube links</a></p> <li><p>Ryan Eberhardt Stanford <a href="https://reberhardt.com/blog/2020/10/05/designing-a-new-class-at-stanford-safety-in-systems-programming.html#lectures">course</a> </p> <li><p>MMtk and GCs </p> <li><p>VScode and Rustanalyzer to just get started</p> <li><p>command line stuff rocks <a href="https://zaiste.net/posts/shell-commands-rust/">Rust CLI</a></p> </ol> <ul> <li><p>rg</p> <li><p>bat</p> <li><p>dust</p> <li><p>typeracer</p> <li><p>taskwarrior</p> <li><p>wool</p> </ul> <ol start=8 > <li><p>Jon Gjengset streams: </p> </ol> <ul> <li><p><a href="https://www.youtube.com/watch?v&#61;rMGWeSjctlY">multicore and atomics</a></p> </ul> <ol start=9 > <li><p><a href="https://github.com/plasma-umass/coz">coz</a></p> <li><p><a href="https://sled.rs/perf#e-prime-and-precise-language">sled&#39;s</a> approach to benchmarking</p> <li><p><a href="https://www.lpalmieri.com/posts/2019-02-23-scientific-computing-a-rust-adventure-part-0-vectors/">Scientific Computing</a> a Rust adventure and Rust ML to production</p> <li><p><a href="https://www.lpalmieri.com/posts/2019-12-01-taking-ml-to-production-with-rust-a-25x-speedup/">Taking ML to production with Rust</a></p> <li><p><a href="https://github.com/ejmahler/RustFFT">Rust FFT</a></p> <li><p><a href="https://github.com/rusty-fast-solvers/rusty-green-kernel">Green function evaluation kernels</a></p> <li><p>egg</p> </ol> <h3 id=papercuts_and_sharp_edges ><a href="#papercuts_and_sharp_edges" class=header-anchor >Papercuts and sharp edges</a></h3> <ol> <li><p>Knowing the Rustian motivations:</p> </ol> <ul> <li><p>Stanford course, Carol Golding&#39;s talk, C&#43;&#43; dangling pointer example.</p> </ul> <ol> <li><p>Install <code>cargo-add</code>, use it to manage crate dependencies.</p> <li><p>For numerics, install <code>ndarray</code> and <code>num_traits</code>. Linear Algebra and numerics where not a primary focus of Rust when starting out as they were with Julia.</p> <li><p>Benchmarking with <code>@btime</code> is painless, <code>criterion</code> is your best Rustian bet.</p> <li><p>Setup your <code>rust-analyzer</code> and <code>error lens</code> plugins on VSCode or IDE asap, you&#39;ll thank me later. Rust-land expects you to be in constant dialogue with the compiler, and making that iteration cycle as ergonomic as possible will yield dividends in the long run.</p> </ol> <h3 id=appreciation_of_rust_things ><a href="#appreciation_of_rust_things" class=header-anchor >Appreciation of Rust things</a></h3> <ol> <li><p>Rust people take uwu-ification very, VERY seriously. <a href="https://github.com/Daniel-Liu-c0deb0t/uwu">The uwu</a> project uses SIMD to uwu-ify strings for <a href="https://twitter.com/twent_weznowor">great artistic value</a></p> <li><p>The Rust foundation and strong community conduct codes.</p> </ol> <p>compiler error messages are.</p> <h3 id=things_i_wish_id_known_earlier ><a href="#things_i_wish_id_known_earlier" class=header-anchor >Things I wish I&#39;d known earlier</a></h3> <ol> <li><p>If you can, avoid the examples with Strings and &amp;str.</p> <li><p>The preferred way of &quot;whipping up an example in the REPL&quot; is to <code>cargo new foo</code>, mucking about and then <code>cargo run --release</code> or using the Rust Playground.</p> <li><p>If you&#39;re using a very expansive test suite, <code>cargo test --test-threads 8</code> and <code>cargo test --quiet</code> are helpful flags.</p> <li><p>For loops are not idiomatic in Rust - writing Fortran-ey code instead of iterators will lead to pain and slower loops. </p> <li><p>Just clone everything when you are starting out to get around most borrow checker shenanigans - worry about allocations later, Rust is fast enough that this is not likely your bottleneck at first.</p> <li><p>The following function</p> </ol> <pre><code class="rust hljs"><span class=hljs-keyword >fn</span> <span class="hljs-title function_">dot</span>(v: &amp;[<span class=hljs-type >i32</span>], w: &amp;[<span class=hljs-type >i32</span>]) <span class=hljs-punctuation >-&gt;</span> <span class=hljs-type >i32</span> {...}</code></pre>
<p>the types of <code>v</code> and <code>w</code> are a <code>slice</code> of <code>Int32</code>s, which are different from <code>Vec&lt;32&gt;</code>. Read the Scientific Computing link above to see a nice table of the differences.</p>
<ol start=6 >
<li><p>Including docs and tests in the same file as your implementation is idiomatic - even the IDEs support clicking on the <code>#&#91;test&#93;</code> line and having that run. Julia has a nice workflow for test driven development out-of-the-box - Rust gives you some of those guarantees by... conversing with the compiler.</p>

<li><p>Polymorphism via macros: <code>#&#91;derive&#40;Debug, Hash, Eq&#41;&#93;</code> </p>

<li><p>Rust has something similar to the concept of <code>type piracy</code>: they&#39;re called the <code>orphan rules</code>, as explained by <a href="https://blog.mgattozzi.dev/orphan-rules/">this Michael Gattozzi</a> post:</p>

</ol>
<blockquote>
<p>Recently at work I managed to hit the Orphan Rules implementing some things for an internal crate. Orphan Rules you say? These are ancient rules passed down from the before times &#40;pre 1.0&#41; that have to do with trait coherence. Mainly, if you and I both implement a trait from another crate on the same type in another crate and we compile the code, which implementation do we use?</p>
</blockquote>
<ol start=9 >
<li><p>Rust is not as centralized with online communication as Julia is around Slack/Zulip/Discourse. Their version of <code>#appreciation</code> channels is to go on twitter and tell <code>@ekuber</code> what a joy the </p>

</ol>
<h3 id=what_rust_can_bring_to_julia ><a href="#what_rust_can_bring_to_julia" class=header-anchor >What Rust can bring to Julia</a></h3>
<ol>
<li><p>A model of governance.</p>

<li><p>Less vulnerable software in the world is a good thing.</p>

</ol>
<ul>
<li><p><a href="https://www.usenix.org/conference/enigma2021/presentation/gaynor">Alex Gaynor talk</a>:</p>

<li><p><a href="https://www.helpnetsecurity.com/2021/01/27/cve-2021-3156/">sudo vulnerabilities</a>: Very bad ? Maybe?</p>

<li>
</ul>
<ol start=3 >
<li><p><a href="https://www.youtube.com/watch?v&#61;rAF8mLI0naQ&amp;t&#61;947s">Error handling</a>: Multiple dispatch may prove very advantageous </p>

</ol>
<h3 id=what_julia_can_bring_to_rust ><a href="#what_julia_can_bring_to_rust" class=header-anchor >What Julia can bring to Rust</a></h3>
<ol>
<li>
</ol>
<div class=page-foot >
  <div class=copyright >
    &copy; Miguel Raz Guzm√°n Macedo. Last modified: May 30, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
    
    
        


	

<script>
(function(){

	// Get the elements.
	// - the 'pre' element.
	// - the 'div' with the 'paste-content' id.

	var pre = document.getElementsByTagName('pre');

	// Add a copy button in the 'pre' element.
	// which only has the className of 'language-'.

	for (var i = 0; i < pre.length; i++) {
		var isLanguage = pre[i].children[0].className.indexOf('language-');

		if ( isLanguage === 0 ) {
			var button           = document.createElement('button');
					button.className = 'copy-button';
					button.textContent = 'Copy';

					pre[i].appendChild(button);
		}
	};

	// Run Clipboard

	var copyCode = new Clipboard('.copy-button', {
		target: function(trigger) {
			return trigger.previousElementSibling;
    }
	});

	// On success:
	// - Change the "Copy" text to "Copied".
	// - Swap it to "Copy" in 2s.
	// - Lead user to the "contenteditable" area with Velocity scroll.

	copyCode.on('success', function(event) {
		event.clearSelection();
		event.trigger.textContent = 'Copied';
		window.setTimeout(function() {
			event.trigger.textContent = 'Copy';
		}, 2000);

	});

	// On error (Safari):
	// - Change the  "Press Ctrl+C to copy"
	// - Swap it to "Copy" in 2s.

	copyCode.on('error', function(event) {
		event.trigger.textContent = 'Press "Ctrl + C" to copy';
		window.setTimeout(function() {
			event.trigger.textContent = 'Copy';
		}, 5000);
	});

})();
</script>